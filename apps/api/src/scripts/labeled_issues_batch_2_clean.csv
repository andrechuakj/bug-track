title,body,url,repository,created_at,updated_at,closed_at,state,labels,predicted_cat
New grpc version caused tiflash connection error,https://github.com/pingcap/tiflash/issues/9159,https://github.com/pingcap/tidb/issues/54159,pingcap/tidb,2024-06-21 09:11:39+00:00,2024-06-24 04:04:21+00:00,2024-06-24 04:04:21+00:00,closed,"['type/bug', 'severity/major']",Data Corruption
Add index with distributed global sort performance is unstable,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

```
go-ycsb run mysql -P /ycsb/workloads/workloada -p mysql.host=xxx.xxx.xxx.xx -p mysql.port=xxxxx -p mysql.db=test -p threadcount=100 -p recordcount=100000000 -p operationcount=50000000 -p workload=core -p fieldcount=10 -p fieldlength=100 -p requestdistribution=uniform
```

```sql
alter table usertable add index test_idx(FIELD0);
```

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

The execution time should be stable.

### 3. What did you see instead (Required)

(drop index statements are omitted)
```
mysql> alter table usertable add index test_idx(FIELD0);
Query OK, 0 rows affected (2 min 27.07 sec)

mysql> alter table usertable add index test_idx(FIELD0);
Query OK, 0 rows affected (3 min 6.07 sec)

mysql> alter table usertable add index test_idx(FIELD0);
Query OK, 0 rows affected (3 min 9.06 sec)

mysql> alter table usertable add index test_idx(FIELD0);
Query OK, 0 rows affected (2 min 36.06 sec)

mysql> alter table usertable add index test_idx(FIELD0);
Query OK, 0 rows affected (2 min 42.08 sec)

mysql> alter table usertable add index test_idx(FIELD0);
Query OK, 0 rows affected (3 min 23.18 sec)

mysql> alter table usertable add index test_idx(FIELD0);
Query OK, 0 rows affected (3 min 24.68 sec)
```

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
6ad9cac6ec",https://github.com/pingcap/tidb/issues/54147,pingcap/tidb,2024-06-20 15:04:37+00:00,2024-10-21 09:33:14+00:00,2024-06-24 13:22:23+00:00,closed,"['type/bug', 'severity/major', 'component/ddl', 'affects-7.5', 'affects-8.1']",Performance Degradation
br restore hangs sometimes,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
- run br restore, sometime br restore hangs

### 2. What did you expect to see? (Required)
br restore not hang 

### 3. What did you see instead (Required)
br restore hangs

### 4. What is your TiDB version? (Required)
[root@br-0 /]# /br -V
Release Version: v8.2.0-alpha
Git Commit Hash: 26d10965804dcfc24c69720cbef7b8ecfb025068
Git Branch: heads/refs/tags/v8.2.0-alpha
Go Version: go1.21.10
UTC Build Time: 2024-06-17 11:39:33
Race Enabled: false",https://github.com/pingcap/tidb/issues/54140,pingcap/tidb,2024-06-20 11:15:39+00:00,2024-08-12 09:31:32+00:00,2024-08-12 09:31:32+00:00,closed,"['type/bug', 'severity/moderate', 'component/br']",Infinite Loop / Hang
incremental backup: scan too many ddl history jobs makes backup failed.,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
1. start an incremental backup on a cluster that executes 200k ddls. 
<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)
1. backup succeed
### 3. What did you see instead (Required)
2. backup failed due to too many scan operations on history ddl jobs.
### 4. What is your TiDB version? (Required)
master
<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/54139,pingcap/tidb,2024-06-20 10:12:20+00:00,2024-06-24 12:08:52+00:00,2024-06-24 12:08:52+00:00,closed,"['type/bug', 'severity/minor', 'component/br', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1']",Data Corruption
flaky test TestParallelFlashbackTable,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

```
    db_change_failpoints_test.go:160: 
        	Error Trace:	pkg/ddl/db_change_failpoints_test.go:160
        	            				pkg/ddl/db_change_test.go:1414
        	            				pkg/ddl/db_change_failpoints_test.go:169
        	Error:      	Received unexpected error:
        	            	[schema:1050]Table 't_flashback2' already exists
        	            	github.com/pingcap/errors.AddStack
        	            		external/com_github_pingcap_errors/errors.go:178
        	            	github.com/pingcap/errors.Trace
        	            		external/com_github_pingcap_errors/juju_adaptor.go:15
        	            	github.com/pingcap/tidb/pkg/ddl.(*ddl).DoDDLJob
        	            		pkg/ddl/ddl.go:1323
        	            	github.com/pingcap/tidb/pkg/ddl.(*ddl).RecoverTable
        	            		pkg/ddl/ddl_api.go:3252
        	            	github.com/pingcap/tidb/pkg/executor.(*DDLExec).executeFlashbackTable
        	            		pkg/executor/ddl.go:595
        	            	github.com/pingcap/tidb/pkg/executor.(*DDLExec).Next
        	            		pkg/executor/ddl.go:179
        	            	github.com/pingcap/tidb/pkg/executor/internal/exec.Next
        	            		pkg/executor/internal/exec/executor.go:410
        	            	github.com/pingcap/tidb/pkg/executor.(*ExecStmt).next
        	            		pkg/executor/adapter.go:1238
        	            	github.com/pingcap/tidb/pkg/executor.(*ExecStmt).handleNoDelayExecutor
        	            		pkg/executor/adapter.go:987
        	            	github.com/pingcap/tidb/pkg/executor.(*ExecStmt).handleNoDelay
        	            		pkg/executor/adapter.go:821
        	            	github.com/pingcap/tidb/pkg/executor.(*ExecStmt).Exec
        	            		pkg/executor/adapter.go:585
        	            	github.com/pingcap/tidb/pkg/session.runStmt
        	            		pkg/session/session.go:2289
        	            	github.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt
        	            		pkg/session/session.go:2150
        	            	github.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecWithContext
        	            		pkg/testkit/testkit.go:383
        	            	github.com/pingcap/tidb/pkg/testkit.(*TestKit).Exec
        	            		pkg/testkit/testkit.go:356
        	            	github.com/pingcap/tidb/pkg/ddl_test.testControlParallelExecSQL.func1
        	            		pkg/ddl/db_change_test.go:1399
        	            	github.com/pingcap/tidb/pkg/util.(*WaitGroupWrapper).Run.func1
        	            		pkg/util/wait_group_wrapper.go:157
        	            	runtime.goexit
        	            		src/runtime/asm_amd64.s:1650
        	Test:       	TestParallelFlashbackTable
```
<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)
master
<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/54134,pingcap/tidb,2024-06-20 08:49:50+00:00,2024-06-21 08:49:27+00:00,2024-06-21 08:49:27+00:00,closed,"['type/bug', 'component/test', 'severity/moderate', 'component/ddl']",Concurrency Issue
unnecessary projection In the query,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

```
create table t1 (c1 int primary key);
insert into t1 (c1) values (575932053), (-258025139);
analyze table t1;
SELECT DISTINCT
  cast(c1 as decimal) as c3,
  cast(c1 as signed) as c4
FROM t1;
```
<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

```
tidb> explain select distinct cast(c1 as decimal), cast(c1 as signed) from t1; select distinct cast(c1 as decimal), cast(c1 as signed) from t1;
+------------------------+---------+-----------+---------------+---------------------------------------------------------------------------------------------------------+
| id                     | estRows | task      | access object | operator info                                                                                           |
+------------------------+---------+-----------+---------------+---------------------------------------------------------------------------------------------------------+
| HashAgg_6              | 2.00    | root      |               | group by:Column#10, Column#11, funcs:firstrow(Column#10)->Column#2, funcs:firstrow(Column#11)->Column#3 |
| └─Projection_12        | 2.00    | root      |               | cast(test.t1.c1, decimal(10,0) BINARY)->Column#10, cast(test.t1.c1, bigint(22) BINARY)->Column#11       |
|   └─TableReader_11     | 2.00    | root      |               | data:TableFullScan_10                                                                                   |
|     └─TableFullScan_10 | 2.00    | cop[tikv] | table:t1      | keep order:false                                                                                        |
+------------------------+---------+-----------+---------------+---------------------------------------------------------------------------------------------------------+
4 rows in set (0.01 sec)

+--------------------+-------------------+
| cast(c as decimal) | cast(c as signed) |
+--------------------+-------------------+
|         -258025139 |        -258025139 |
|          575932053 |         575932053 |
+--------------------+-------------------+
2 rows in set (0.00 sec)
```

### 3. What did you see instead (Required)

```
tidb> explain select distinct cast(c1 as decimal), cast(c1 as signed) from t1; select distinct cast(c1 as decimal), cast(c1 as signed) from t1;
+----------------------------+---------+-----------+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| id                         | estRows | task      | access object | operator info                                                                                                                                                                                    |
+----------------------------+---------+-----------+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| HashAgg_6                  | 1.60    | root      |               | group by:Column#13, Column#14, funcs:firstrow(Column#11)->Column#3, funcs:firstrow(Column#12)->Column#4                                                                                          |
| └─Projection_12            | 2.00    | root      |               | cast(test.t1.c1, decimal(10,0) BINARY)->Column#11, cast(test.t1.c1, bigint(22) BINARY)->Column#12, cast(test.t1.c1, decimal(10,0) BINARY)->Column#13, cast(test.t1.c1, bigint(22) BINARY)->Column#14 |
|   └─TableReader_11         | 2.00    | root      |               | data:TableFullScan_10                                                                                                                                                                            |
|     └─TableFullScan_10     | 2.00    | cop[tikv] | table:t1      | keep order:false, stats:pseudo                                                                                                                                                                   |
+----------------------------+---------+-----------+---------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
4 rows in set (0.01 sec)

+--------------------+-------------------+
| cast(c as decimal) | cast(c as signed) |
+--------------------+-------------------+
|         -258025139 |        -258025139 |
|          575932053 |         575932053 |
+--------------------+-------------------+
2 rows in set (0.00 sec)
```
### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/54123,pingcap/tidb,2024-06-19 15:12:04+00:00,2024-06-27 02:39:49+00:00,2024-06-24 16:40:22+00:00,closed,"['type/bug', 'sig/planner', 'severity/moderate', 'affects-8.1']",Performance Degradation
Abnormal logs cause disk space to run out,"1.TiDB version: 6.5.9

 2 .tidb,pd,tikv on the same machine。tikv outputs a large amount of logs in a short period of time, running out of disk space.

3.tikv-2024-06-12T17-49-17.979.log  tikv-2024-06-12T17-50-54.548.log
tikv-2024-06-12T17-49-26.130.log  tikv-2024-06-12T17-51-02.419.log
tikv-2024-06-12T17-49-33.843.log  tikv-2024-06-12T17-51-10.428.log
tikv-2024-06-12T17-49-42.356.log  tikv-2024-06-12T17-51-18.304.log
tikv-2024-06-12T17-49-49.948.log  tikv-2024-06-12T17-51-25.927.log
tikv-2024-06-12T17-49-58.346.log  tikv-2024-06-12T17-51-35.388.log
tikv-2024-06-12T17-50-06.672.log  tikv-2024-06-12T17-51-43.484.log
tikv-2024-06-12T17-50-14.749.log  tikv-2024-06-12T17-51-51.812.log
tikv-2024-06-12T17-50-22.525.log  tikv-2024-06-12T17-51-59.826.log
tikv-2024-06-12T17-50-30.078.log  tikv-2024-06-14T18-49-55.991.log
tikv-2024-06-12T17-50-38.458.log  tikv.log


[2024/06/12 17:51:59.827 +08:00] [WARN] [pd.rs:1707] [""failed to update 
max timestamp for region 15101: Pd(Other(\""[components/pd_client/src/tso
.rs:97]: TimestampRequest channel is closed\""))""]
[2024/06/12 17:51:59.827 +08:00] [WARN] [pd.rs:1707] [""failed to update 
max timestamp for region 15101: Pd(Other(\""[components/pd_client/src/tso
.rs:97]: TimestampRequest channel is closed\""))""]
[2024/06/12 17:51:59.827 +08:00] [WARN] [pd.rs:1707] [""failed to update 
max timestamp for region 15101: Pd(Other(\""[components/pd_client/src/tso
.rs:97]: TimestampRequest channel is closed\""))""]
[2024/06/12 17:51:59.827 +08:00] [WARN] [pd.rs:1707] [""failed to update 
max timestamp for region 15101: Pd(Other(\""[components/pd_client/src/tso
.rs:97]: TimestampRequest channel is closed\""))""]
[2024/06/12 17:51:59.827 +08:00] [WARN] [pd.rs:1707] [""failed to update 
max timestamp for region 15101: Pd(Other(\""[components/pd_client/src/tso
.rs:97]: TimestampRequest channel is closed\""))""]
[2024/06/12 17:51:59.827 +08:00] [WARN] [pd.rs:1707] [""failed to update 
max timestamp for region 15101: Pd(Other(\""[components/pd_client/src/tso
.rs:97]: TimestampRequest channel is closed\""))""]
[2024/06/12 17:51:59.827 +08:00] [WARN] [pd.rs:1707] [""failed to update 
max timestamp for region 15101: Pd(Other(\""[components/pd_client/src/tso
.rs:97]: TimestampRequest channel is closed\""))""]
[2024/06/12 17:51:59.827 +08:00] [WARN] [pd.rs:1707] [""failed to update 
max timestamp for region 15101: Pd(Other(\""[components/pd_client/src/tso
.rs:97]: TimestampRequest channel is closed\""))""]

4.What causes this problem to occur? Thanks for your help.",https://github.com/pingcap/tidb/issues/54112,pingcap/tidb,2024-06-19 10:20:11+00:00,2024-11-07 07:55:25+00:00,2024-11-07 07:55:25+00:00,closed,"['type/bug', 'component/tikv', 'severity/major', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1', 'affects-8.5']",Memory Leak / Resource Exhaustion
db / table with name `*` will interfere with DDL job dependency calculation,"https://github.com/pingcap/tidb/blob/51ccce23eb5d2406eb59d508e438a6bb82ac0ffd/pkg/ddl/ddl_api.go#L226-L227

https://github.com/pingcap/tidb/blob/51ccce23eb5d2406eb59d508e438a6bb82ac0ffd/pkg/parser/model/ddl.go#L596-L597

I just hope user will not create such database / table",https://github.com/pingcap/tidb/issues/54103,pingcap/tidb,2024-06-19 07:27:59+00:00,2024-06-21 06:10:35+00:00,,open,"['type/bug', 'severity/minor', 'component/ddl']",Constraint Violation
error message of `SET @@global.tidb_cloud_storage_uri` is not clear,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

```
mysql> SET @@global.tidb_cloud_storage_uri = 's3://test/test/?provider=test';
```

### 2. What did you expect to see? (Required)

detailed error message, like the one in log

```
[2024/06/18 20:57:10.111 +08:00] [INFO] [conn.go:1162] [""command dispatched failed""] [conn=2097154] [session_alias=] [connInfo=""id:2097154, addr:127.0.0.1:64090 status:10, collation:utf8mb4_general_ci, user:root""] [command=Query] [status=""inTxn:0, autocommit:1""] [sql=""SET @@global.tidb_cloud_storage_uri = 's3://test/test/?provider=test'""] [txn_mode=PESSIMISTIC] [timestamp=0] [err=""[BR:ExternalStorage:ErrStorageInvalidPermission]external storage permission\ncheck permission ListObjects failed due to NoCredentialProviders: no valid providers in chain\ncaused by: EnvAccessKeyNotFound: failed to find credentials in the environment.\nSharedCredsLoad: failed to load profile, .\nEC2RoleRequestError: no EC2 instance role found\ncaused by: RequestError: send request failed\ncaused by: Get \""http://169.254.169.254/latest/meta-data/iam/security-credentials/\"": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
```

### 3. What did you see instead (Required)

```
mysql> SET @@global.tidb_cloud_storage_uri = 's3://test/test/?provider=test';
ERROR 1105 (HY000): external storage permission
```

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/54096,pingcap/tidb,2024-06-18 12:59:34+00:00,2024-06-21 05:16:19+00:00,2024-06-21 05:16:19+00:00,closed,"['type/bug', 'severity/moderate', 'affects-8.1']",Incorrect Query Result
TestInfoBuiltin failed after enabling infoschema cache V2,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
set DefTiDBSchemaCacheSize to 10 from 0
Run TestInfoBuiltin many times.
<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)
Always passed.
### 3. What did you see instead (Required)
May fail.
``` 
[2024/06/18 19:55:52.646 +08:00] [INFO] [ddl.go:1317] [""DDL job is finished""] [category=ddl] [jobID=105]
[2024/06/18 19:55:52.646 +08:00] [INFO] [callback.go:140] [""performing DDL change, must reload""] [category=ddl]
    result.go:49: 
        	Error Trace:	/Users/bba/pc/tidb/pkg/testkit/result.go:49
        	            				/Users/bba/pc/tidb/pkg/expression/integration_test/integration_test.go:220
        	Error:      	Not equal: 
        	            	expected: ""[3]\n""
        	            	actual  : ""[60001]\n""
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,2 +1,2 @@
        	            	-[3]
        	            	+[60001]
        	            	 
        	Test:       	TestInfoBuiltin
        	Messages:   	sql:select last_insert_id();, args:[]
```
### 4. What is your TiDB version? (Required)
master
<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/54094,pingcap/tidb,2024-06-18 12:02:16+00:00,2024-06-27 05:30:48+00:00,2024-06-27 05:30:48+00:00,closed,"['type/bug', 'component/test', 'severity/moderate', 'feature/developing', 'component/ddl']",Transaction Anomaly
The efficiency of auto analyze is low with auto_analyze_priority_queue and infoSchemaV2 open in million tables scenario,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
tidb_schema_cache_size 2GB
create 100k schemas and about 15 tables each of schema. 1.5 million tables totally
insert data for above tables
It takes about 10 minutes to execute a single analyze task on average when auto_analyze_priority_queue and infoSchemaV2 open. While 20 analyze tasks are executed per minute when auto_analyze_priority_queue or infoSchemaV2 close.
Currently, the automatic statistics collection task priority queue feature retrieves all table information each time it performs an `analyze`, selecting one from them to execute. If some tables are not in the `infoschema` cache, this process is quite time-consuming.
![image](https://github.com/pingcap/tidb/assets/7677963/4c66130e-f136-4a01-89c8-07bf5ac9462d)

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
Release Version: v8.2.0-alpha
Edition: Community
Git Commit Hash: 6cf8776242fbfe0b922488357867ca5244e7b8fa
Git Branch: heads/refs/tags/v8.2.0-alpha
UTC Build Time: 2024-06-13 11:49:48
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv",https://github.com/pingcap/tidb/issues/54086,pingcap/tidb,2024-06-18 07:52:33+00:00,2024-11-12 04:21:50+00:00,2024-11-12 04:21:50+00:00,closed,"['type/bug', 'sig/planner', 'severity/major', 'feature/developing', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1', 'affects-8.5']",Performance Degradation
Console output and log message not accurate when import data with dup records using lightning tidb backend.,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
1. Lightning import some data with few duplicate rows using tidb end, conflict.strategy = 'replace';
```
# cat /tmp/tidb-lightning.toml
[lightning]                                       
level = 'debug'                                   
[mydumper]                                        
filter = ['coms.PK_*']                            
[conflict]                                        
strategy = 'replace'     
```
2, Lighting import finishes 


### 2. What did you expect to see? (Required)
Lightning import should succeed as there are only 5 duplicate rows.
And the info in lightning console output and log should be accurate.

### 3. What did you see instead (Required)
Lightning logs says that ""Detect 5 conflict errors in total, please refer to table `lightning_task_info`.`conflict_view` for more details""
However, the conflict rows will not be recorded for strategy = ""replace"" in TiDB backend per https://docs.pingcap.com/zh/tidb/stable/tidb-lightning-configuration, also validated that there is no records in the tables actually.
```
[2024/06/17 15:04:36.751 +00:00] [INFO] [import.go:578] [""the whole procedure completed""] [takeTime=1h6m44.025684115s] []
[2024/06/17 15:04:36.751 +00:00] [WARN] [errormanager.go:1089] [""Detect 5 conflict errors in total, please refer to table `lightning_task_info`.`conflict_view` for more details""]
[2024/06/17 15:04:36.751 +00:00] [INFO] [main.go:110] [""tidb lightning exit""] [finished=true]
```
![image](https://github.com/pingcap/tidb/assets/7403864/f0e3bf5e-2149-42a2-9fa8-d4224768e247)
![image](https://github.com/pingcap/tidb/assets/7403864/763b1189-6a7f-4f6b-8ac6-d55c7a33a12d)


### 4. What is your TiDB version? (Required)
Release Version: v8.2.0-alpha                            
Git Commit Hash: 26d10965804dcfc24c69720cbef7b8ecfb025068
Git Branch: heads/refs/tags/v8.2.0-alpha                 
Go Version: go1.21.10                                    
UTC Build Time: 2024-06-17 11:41:27                      
Race Enabled: false",https://github.com/pingcap/tidb/issues/54081,pingcap/tidb,2024-06-18 06:34:59+00:00,2024-06-18 11:36:47+00:00,,open,"['type/bug', 'severity/minor', 'component/lightning']",Incorrect Query Result
无法修改慢日志文件路径,"## Bug Report

Please answer these questions before submitting your issue. Thanks!
一、问题描述：

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
二、问题复现：
1、通过tiup cluster edit-config xxx修改慢日志文件名
server_configs:
  tidb:
    log.slow-query-file: /tidb-deploy/tidb-4000/log/testslow.log

2、reload集群：tiup cluster reload xxx

3、查看慢日志路径，对应的值是/tidb-deploy/tidb-4000/log/tidb_slow_query.log，并没有被改成testslow.log
show config where name like '%slow%';

4、如果将/tidb-deploy/deploy/tidb-4000/scripts/run_tidb.sh中slow-log的配置删除掉，然后重启restart集群，可以生成新路径的slowlog；但如果执行reload操作，又会被还原成/tidb-deploy/tidb-4000/log/testslow.log路径

### 2. What did you expect to see? (Required)
期望结果：
希望能正常修改慢日志路径。


### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)
tidb v8.1.0



<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/54078,pingcap/tidb,2024-06-18 06:12:31+00:00,2024-06-24 08:23:58+00:00,2024-06-18 09:31:08+00:00,closed,"['type/bug', 'sig/sql-infra']",Constraint Violation
runtime error: invalid memory address or nil pointer dereference when run query with tidb_opt_enable_hash_join=off,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

[directory_query.zip](https://github.com/user-attachments/files/15880044/directory_query.zip)

With the plan replayer file above

plan replayer load '/tmp/directory_query.zip';

Set tidb_opt_enable_hash_join to off and run query.

```
mysql> set session tidb_opt_enable_hash_join = ""off"";
Query OK, 0 rows affected (0.00 sec)

mysql> explain WITH RECURSIVE ancestors(gid) AS (    SELECT     groupings.parentId   FROM     groupings   WHERE     (       groupings.userId = 8329216799209537       OR groupings.groupId = 8329216799209537     )     AND groupings.parentId IN (       SELECT         groupId       FROM         `groups`       WHERE         `groups`.workspaceid = 4094233125760157         OR `groups`.accountId = '02945107-4221-4317-9276-5e0e9ed7f194'     )     AND groupings.internal_deleted_timestamp IS NULL   UNION   SELECT     groupings.parentId   FROM     groupings     JOIN ancestors ON groupings.groupId = ancestors.gid ),workspaceScopedGroups(gid) AS (   SELECT     groupId   FROM     principalToWorkspace   WHERE     groupId IN (       SELECT         gid       FROM         ancestors     )     AND principalToWorkspace.deleted = false     AND principalToWorkspace.workspaceId = 4094233125760157   UNION   SELECT     groupings.groupId   FROM     groupings     JOIN workspaceScopedGroups ON groupings.parentId = workspaceScopedGroups.gid   WHERE     groupings.groupId IN (       SELECT         gid
    FROM         ancestors     ) ) SELECT   `groups`.groupId AS ""`groups`.groupId"",   `groups`.groupname AS ""`groups`.groupname"",   `groups`.externalId AS ""`groups`.externalId"",   `groups`.creationTime AS ""`groups`.creationTime"",   `groups`.groupuuid AS ""`groups`.groupuuid"",   `groups`.accountId AS ""`groups`.accountId"",   `groups`.syncedBy AS ""`groups`.syncedBy"",   `groups`.sourceIdp AS ""`groups`.sourceIdp"" FROM   `groups` WHERE   `groups`.groupId IN (     SELECT       gid     FROM       workspaceScopedGroups   );
ERROR 1105 (HY000): runtime error: invalid memory address or nil pointer dereference
```

### 2. What did you expect to see? (Required)

With  set session tidb_opt_enable_hash_join = ""on"" , there is no such error

No ERROR 1105 (HY000): runtime error: invalid memory address or nil pointer dereference

I expect tidb_opt_enable_hash_join=off not cause invalid memory address or nil pointer dereference

### 3. What did you see instead (Required)

No ERROR 1105 (HY000): runtime error: invalid memory address or nil pointer dereference

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->

master(8.2+) ,  v7.5.1",https://github.com/pingcap/tidb/issues/54072,pingcap/tidb,2024-06-18 03:41:43+00:00,2024-07-17 07:57:58+00:00,2024-07-17 07:57:58+00:00,closed,"['type/bug', 'sig/planner', 'severity/major', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1', 'impact/panic']",Crash / Segmentation Fault
PR#53537 caused 20-34% performance regression in oltp_read_only and oltp_read_write,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
1. deploy a cluster with 3 tidb and 3 tikv
2. run sysbench oltp_read_only and oltp_read_write with pr #53341 and  #53537

### 2. What did you expect to see? (Required)
No regression.

### 3. What did you see instead (Required)
PR#53537 caused performance regression in oltp_read_only (34%) and oltp_read_write(20%)
![image](https://github.com/pingcap/tidb/assets/84501897/dc28e1f3-2022-4b6f-8e7a-a05c5dd3df1d)

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
#53537",https://github.com/pingcap/tidb/issues/54070,pingcap/tidb,2024-06-18 03:32:40+00:00,2024-06-24 07:59:52+00:00,2024-06-24 07:59:52+00:00,closed,"['type/bug', 'type/performance', 'sig/execution', 'type/regression', 'severity/critical']",Performance Degradation
IndexMergeJoin get different result when using different charset,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

```
create table A
(id int primary key nonclustered auto_increment,
x varchar(32) not null,
y char(5) not null,
z varchar(25) not null,
key idx_sub_tsk(z,x,y)
)

create table B
( y char(5) not null,
z varchar(25) not null,
x varchar(32) not null,
primary key(z, x, y) nonclustered
)

insert into A (y, z, x) values
('CN000', '123', 'RW '),
('CN000', '456', '123');

insert into B values
('CN000', '123', 'RW '),
('CN000', '456', '123');

select /*+ inl_merge_join(a, b) */
a.*
from a join b on a.y=b.y and a.z=b.z and a.x = b.x
where a.y='CN000';
```

### 2. What did you expect to see? (Required)

```
mysql> set names utf8mb4;
Query OK, 0 rows affected (0.00 sec)

mysql> select /*+ inl_merge_join(a, b) */  a.* from b  join a  on a.y=b.y and a.z=b.z and a.x = b.x where a.y = 'cn000';
+----+-----+-------+-----+
| id | x   | y     | z   |
+----+-----+-------+-----+
|  1 | rw  | cn000 | 123 |
|  3 | 123 | cn000 | 456 |
+----+-----+-------+-----+
2 rows in set (0.00 sec)

mysql> set names utf8;
Query OK, 0 rows affected (0.00 sec)

mysql> select /*+ inl_merge_join(a, b) */  a.* from b  join a  on a.y=b.y and a.z=b.z and a.x = b.x where a.y = 'cn000';
+----+----+-------+-----+
| id | x  | y     | z   |
+----+----+-------+-----+
|  1 | rw | cn000 | 123 |
+----+----+-------+-----+
1 row in set (0.00 sec)
```

I expect whether using utf8 or utf8mb4, the query get the same result:

```
mysql> set names utf8;
Query OK, 0 rows affected (0.00 sec)

mysql> select /*+ inl_merge_join(a, b) */  a.* from b  join a  on a.y=b.y and a.z=b.z and a.x = b.x where a.y = 'cn000';
+----+----+-------+-----+
| id | x  | y     | z   |
+----+----+-------+-----+
|  1 | rw | cn000 | 123 |
|  3 | 123 | cn000 | 456 |
+----+----+-------+-----+
1 row in set (0.00 sec)
```

### 3. What did you see instead (Required)

```
mysql> set names utf8;
Query OK, 0 rows affected (0.00 sec)

mysql> select /*+ inl_merge_join(a, b) */  a.* from b  join a  on a.y=b.y and a.z=b.z and a.x = b.x where a.y = 'cn000';
+----+----+-------+-----+
| id | x  | y     | z   |
+----+----+-------+-----+
|  1 | rw | cn000 | 123 |
+----+----+-------+-----+
1 row in set (0.00 sec)
```


### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->

Both v6.5.3 and master(8.2+) get the wrong result, so this is a new bug.",https://github.com/pingcap/tidb/issues/54064,pingcap/tidb,2024-06-17 17:25:26+00:00,2024-07-25 07:48:06+00:00,2024-07-25 07:48:06+00:00,closed,"['type/bug', 'sig/planner', 'severity/major', 'affects-5.4', 'affects-6.1', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1', 'report/customer', 'impact/wrong-result', 'affects-8.2']",Incorrect Query Result
"Cluster update failed with check dist task failed, tidb_enable_dist_task is enabled","## Bug Report
steps to reproduce:
- tidb cluster with version 7.5.0
- tidb_enable_dist_task is set to true
- stop cluster
- `tiup cluster upgrade tidb v8.1.0 --offline`

 ```
  [bootstrap.go:1351] [""check dist task failed, tidb_enable_dist_task is enabled""] [] [stack=""github.com/pingcap/tidb/pkg/session.checkDistTask\n\t/workspace/source/tidb/pkg/session/bootstrap.go:1351\ngithub.com/pingcap/tidb/pkg/session.upgrade\n\t/workspace/source/tidb/pkg/session/bootstrap.go:1386\ngithub.com/pingcap/tidb/pkg/session.runInBootstrapSession\n\t/workspace/source/tidb/pkg/session/session.go:3520\ngithub.com/pingcap/tidb/pkg/session.bootstrapSessionImpl\n\t/workspace/source/tidb/pkg/session/session.go:3297\ngithub.com/pingcap/tidb/pkg/session.BootstrapSession\n\t/workspace/source/tidb/pkg/session/session.go:3261\nmain.createStoreAndDomain\n\t/workspace/source/tidb/cmd/tidb-server/main.go:420\nmain.main\n\t/workspace/source/tidb/cmd/tidb-server/main.go:326\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:267""]
  ```",https://github.com/pingcap/tidb/issues/54061,pingcap/tidb,2024-06-17 12:10:02+00:00,2025-02-05 18:23:53+00:00,2025-02-05 18:23:53+00:00,closed,"['type/bug', 'severity/moderate', 'component/ddl']",Deadlock
index_hash_join hang when query exceed quota,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

source 
[one_case.txt](https://github.com/user-attachments/files/15864154/one_case.txt)

you can query this file some times.
### 2. What did you expect to see? (Required)

get error.

### 3. What did you see instead (Required)

hang

```
goroutine 18447 [select, 1 minutes]:
github.com/pingcap/tidb/pkg/executor.(*IndexNestedLoopHashJoin).getResultFromChannel(0xc003e40e00, {0x67bde40, 0xc0049f9360}, 0xc004a3dc20)
	/workspace/source/tidb/pkg/executor/index_lookup_hash_join.go:284 +0x85
github.com/pingcap/tidb/pkg/executor.(*IndexNestedLoopHashJoin).runInOrder(0xc003e40e00, {0x67bde40, 0xc0049f9360}, 0xc0049f9310)
	/workspace/source/tidb/pkg/executor/index_lookup_hash_join.go:242 +0x7c
github.com/pingcap/tidb/pkg/executor.(*IndexNestedLoopHashJoin).Next(0x67bde08?, {0x67bde08?, 0xc0049c53e0?}, 0x1?)
	/workspace/source/tidb/pkg/executor/index_lookup_hash_join.go:229 +0x92
github.com/pingcap/tidb/pkg/executor/internal/exec.Next({0x67bde08, 0xc0049c53e0}, {0x67e6ac0, 0xc003e40e00}, 0xc0049f9310)
	/workspace/source/tidb/pkg/executor/internal/exec/executor.go:403 +0x2c3
github.com/pingcap/tidb/pkg/executor.(*ExecStmt).next(0xc00f8cfe00, {0x67bde08, 0xc0049c53e0}, {0x67e6ac0, 0xc003e40e00}, 0x50b5dfd?)
	/workspace/source/tidb/pkg/executor/adapter.go:1211 +0x6e
github.com/pingcap/tidb/pkg/executor.(*recordSet).Next(0xc0049d3ec0, {0x67bde08?, 0xc0049c53e0?}, 0xc0049f9310)
	/workspace/source/tidb/pkg/executor/adapter.go:160 +0xbb
github.com/pingcap/tidb/pkg/server/internal/resultset.(*tidbResultSet).Next(0xc002624000?, {0x67bde08?, 0xc0049c53e0?}, 0xc00fa93440?)
	/workspace/source/tidb/pkg/server/internal/resultset/resultset.go:64 +0x25
github.com/pingcap/tidb/pkg/server.(*clientConn).writeChunks(0xc003d82d00, {0x67bde08, 0xc0049c53e0}, {0x67d6638, 0xc0049e4c80}, 0x0, 0x1d1?)
	/workspace/source/tidb/pkg/server/conn.go:2316 +0x18a
github.com/pingcap/tidb/pkg/server.(*clientConn).writeResultSet(0xc003d82d00, {0x67bde08, 0xc0049c53e0}, {0x67d6638, 0xc0049e4c80}, 0xf8?, 0x2, 0xc001c8eb00?)
	/workspace/source/tidb/pkg/server/conn.go:2259 +0x2f0
github.com/pingcap/tidb/pkg/server.(*clientConn).handleStmt(0xc003d82d00, {0x67bde40, 0xc0049d7310}, {0x67d37a8?, 0xc0049af0e0}, {0x0, 0x0, 0x0}, 0x1)
	/workspace/source/tidb/pkg/server/conn.go:2052 +0x52a
github.com/pingcap/tidb/pkg/server.(*clientConn).handleQuery(0xc003d82d00, {0x67bde40, 0xc0049d7310}, {0xc00e41a9b1, 0x46})
	/workspace/source/tidb/pkg/server/conn.go:1774 +0xb4c
github.com/pingcap/tidb/pkg/server.(*clientConn).dispatch(0xc003d82d00, {0x67bde08, 0xc0028b8780}, {0xc00e41a9b0, 0x47, 0x47})
	/workspace/source/tidb/pkg/server/conn.go:1348 +0xf2b
github.com/pingcap/tidb/pkg/server.(*clientConn).Run(0xc003d82d00, {0x67bde08, 0xc0028b8780})
	/workspace/source/tidb/pkg/server/conn.go:1114 +0x545
github.com/pingcap/tidb/pkg/server.(*Server).onConn(0xc00088cc00?, 0xc003d82d00)
	/workspace/source/tidb/pkg/server/server.go:739 +0x89d
created by github.com/pingcap/tidb/pkg/server.(*Server).startNetworkListener in goroutine 17151
	/workspace/source/tidb/pkg/server/server.go:557 +0x78d

goroutine 26756 [chan send, 1 minutes]:
github.com/pingcap/tidb/pkg/executor.(*IndexNestedLoopHashJoin).finishJoinWorkers(0xc003e40e00, {0x58c2120, 0xc00d5d6990})
	/workspace/source/tidb/pkg/executor/index_lookup_hash_join.go:201 +0x12c
github.com/pingcap/tidb/pkg/util.WithRecovery.func1()
	/workspace/source/tidb/pkg/util/misc.go:89 +0x4c
panic({0x58c2120?, 0xc00d5d6990?})
	/usr/local/go/src/runtime/panic.go:914 +0x21f
github.com/pingcap/tidb/pkg/util/memory.(*PanicOnExceed).Action(0xc0049c7dc0, 0xc003c5b4d0)
	/workspace/source/tidb/pkg/util/memory/action.go:173 +0x4b2
github.com/pingcap/tidb/pkg/util/memory.(*Tracker).Consume.func1(0xc003c5b4d8, 0xc0007e41b0?)
	/workspace/source/tidb/pkg/util/memory/tracker.go:437 +0xfc
github.com/pingcap/tidb/pkg/util/memory.(*Tracker).Consume(0x76?, 0x4a)
	/workspace/source/tidb/pkg/util/memory/tracker.go:464 +0x242
github.com/pingcap/tidb/pkg/distsql.indexRangesToKVWithoutSplit(0x7935e06375e0?, {0xc0101075e8, 0x1, 0xc0002c3400?}, 0xc004b7e600?, {0xc00e260c68, 0x1, 0x1d62269?}, 0xc0049fa750, 0xc00fa92ef0)
	/workspace/source/tidb/pkg/distsql/request_builder.go:749 +0x1db
github.com/pingcap/tidb/pkg/distsql.indexRangesToKVRangesForTablesWithInterruptSignal(...)
	/workspace/source/tidb/pkg/distsql/request_builder.go:663
github.com/pingcap/tidb/pkg/distsql.IndexRangesToKVRangesWithInterruptSignal(0xc0049e9260?, 0xc00e41aa00?, 0x46?, {0xc00e260c68?, 0x124?, 0xc0101cd200?}, 0x67a87f0?, 0xc0049c52f0?)
	/workspace/source/tidb/pkg/distsql/request_builder.go:647 +0x4d
github.com/pingcap/tidb/pkg/executor.buildKvRangesForIndexJoin(0xc0101cd8b8?, 0x4e54245?, 0x76, 0x1, {0xc004b7e400, 0x40, 0xc004bba140?}, {0xc00e260c68, 0x1, 0x1}, ...)
	/workspace/source/tidb/pkg/executor/builder.go:4636 +0x2b6
github.com/pingcap/tidb/pkg/executor.(*dataReaderBuilder).buildIndexReaderForIndexJoin(0xc0049d3a40, {0x67bde40, 0xc0049f9360}, 0xc0049f0840, {0xc004b7e400, 0x40, 0x40}, {0xc00e260c68, 0x1, 0x1}, ...)
	/workspace/source/tidb/pkg/executor/builder.go:4384 +0x8a9
github.com/pingcap/tidb/pkg/executor.(*dataReaderBuilder).buildExecutorForIndexJoinInternal(0xc004bba190?, {0x67bde40?, 0xc0049f9360?}, {0x67e16a8?, 0xc0049f0840?}, {0xc004b7e400?, 0x0?, 0x0?}, {0xc00e260c68, 0x1, ...}, ...)
	/workspace/source/tidb/pkg/executor/builder.go:4047 +0x170
github.com/pingcap/tidb/pkg/executor.(*dataReaderBuilder).buildExecutorForIndexJoin(...)
	/workspace/source/tidb/pkg/executor/builder.go:4038
github.com/pingcap/tidb/pkg/executor.(*innerWorker).fetchInnerResults(0xc008fe2240, {0x67bde40, 0xc0049f9360}, 0xc004a5cf80, {0xc004b7e400?, 0x40?, 0x40?})
	/workspace/source/tidb/pkg/executor/index_lookup_join.go:703 +0x205
github.com/pingcap/tidb/pkg/executor.(*indexHashJoinInnerWorker).fetchInnerResults(0xc008fe2240, {0x67bde40, 0xc0049f9360}, 0xc0101cde10?)
	/workspace/source/tidb/pkg/executor/index_lookup_hash_join.go:620 +0x5fgoroutine 26755 [select, 1 minutes]:
github.com/pingcap/tidb/pkg/executor.(*indexHashJoinOuterWorker).pushToChan(...)
	/workspace/source/tidb/pkg/executor/index_lookup_hash_join.go:406
github.com/pingcap/tidb/pkg/executor.(*indexHashJoinOuterWorker).run(0xc0049fc1c0, {0x67bde40, 0xc0049f9360})
	/workspace/source/tidb/pkg/executor/index_lookup_hash_join.go:355 +0x485
github.com/pingcap/tidb/pkg/executor.(*IndexNestedLoopHashJoin).startWorkers.func1()
	/workspace/source/tidb/pkg/executor/index_lookup_hash_join.go:168 +0x29
github.com/pingcap/tidb/pkg/util.WithRecovery(0x67bde08?, 0xc0049316b0?)
	/workspace/source/tidb/pkg/util/misc.go:97 +0x48
created by github.com/pingcap/tidb/pkg/executor.(*IndexNestedLoopHashJoin).startWorkers in goroutine 18447
	/workspace/source/tidb/pkg/executor/index_lookup_hash_join.go:168 +0x2fd

goroutine 26757 [semacquire, 1 minutes]:
sync.runtime_Semacquire(0x2e6e897?)
	/usr/local/go/src/runtime/sema.go:62 +0x25
sync.(*WaitGroup).Wait(0xc003b18fd0?)
	/usr/local/go/src/sync/waitgroup.go:116 +0x48
github.com/pingcap/tidb/pkg/executor.(*IndexNestedLoopHashJoin).wait4JoinWorkers(0xc003e40e00)
	/workspace/source/tidb/pkg/executor/index_lookup_hash_join.go:212 +0x25
created by github.com/pingcap/tidb/pkg/executor.(*IndexNestedLoopHashJoin).startWorkers in goroutine 18447
	/workspace/source/tidb/pkg/executor/index_lookup_hash_join.go:187 +0x5c7
github.com/pingcap/tidb/pkg/executor.(*indexHashJoinInnerWorker).handleTask(0xc008fe2240, {0x67bde40, 0xc0049f9360}, 0xc004a6e7e0, 0xc00aa3d320, {0x67c4fb8?, 0xc00f6001d0?}, 0xc004a3db60)
	/workspace/source/tidb/pkg/executor/index_lookup_hash_join.go:676 +0x36d
github.com/pingcap/tidb/pkg/executor.(*indexHashJoinInnerWorker).run(0xc008fe2240, {0x67bde40, 0xc0049f9360}, 0xc00fa932f0)
	/workspace/source/tidb/pkg/executor/index_lookup_hash_join.go:514 +0x258
github.com/pingcap/tidb/pkg/executor.(*IndexNestedLoopHashJoin).startWorkers.func2()
	/workspace/source/tidb/pkg/executor/index_lookup_hash_join.go:185 +0x4a
github.com/pingcap/tidb/pkg/util.WithRecovery(0x4e48e05?, 0xc0040ab880?)
	/workspace/source/tidb/pkg/util/misc.go:97 +0x48
created by github.com/pingcap/tidb/pkg/executor.(*IndexNestedLoopHashJoin).startWorkers in goroutine 18447
	/workspace/source/tidb/pkg/executor/index_lookup_hash_join.go:185 +0x44f


```

### 4. What is your TiDB version? (Required)
master, v8.1.0
<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/54055,pingcap/tidb,2024-06-17 08:41:22+00:00,2025-01-24 08:28:32+00:00,2024-11-18 11:54:29+00:00,closed,"['type/bug', 'sig/execution', 'severity/major', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1', 'impact/panic', 'affects-8.5']",Infinite Loop / Hang
br restore failed when injection network partition between one of tikv and other pods,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
1、run br restore
2、inject network partition between one of tikv and other pods last for 3mins

### 2. What did you expect to see? (Required)
br restore can success

### 3. What did you see instead (Required)
br restore failed when injection network partition between one of tikv and other pods

`""download file failed""] [files=""{total=1,files=\""[4_44722_1354_b077a553d62445e72046f59e7616693bf929d6284e7895610f0ebea47059ec57_1638173205994_write.sst]\"",totalKVs=410870,totalBytes=88747920,totalSize=40516977}""] [region=""{ID=7888,startKey=7480000000000000FFFA5F728000000001FFE62B060000000000FA,endKey=7480000000000000FFFA5F728000000001FFEC97DA0000000000FA,epoch=\""conf_ver:23 version:845 \"",peers=\""id:7889 store_id:1 ,id:7891 store_id:4 ,id:8040 store_id:8 \""}""] [startKey=7480000000000000FFFA5F728000000001FFE62B060000000000FA] [endKey=7480000000000000FFFA5F728000000001FFEC97DA0000000000FA] [error=""rpc error: code = Unavailable desc = error reading from server: read tcp [10.233.109.46:38220](http://10.233.109.46:38220/)->[10.233.109.55:20160](http://10.233.109.55:20160/): read: connection timed out; rpc error: code = Unavailable desc = connection error: desc = \""transport: error while dialing: dial tcp [10.233.109.55:20160](http://10.233.109.55:20160/): i/o timeout\""; rpc error: code = Unavailable desc = connection error: desc = \""transport: error while dialing: dial tcp [10.233.109.55:20160](http://10.233.109.55:20160/): i/o timeout\""; rpc error: code = Unavailable desc = connection error: desc = \""transport: error while dialing: dial tcp [10.233.109.55:20160](http://10.233.109.55:20160/): i/o timeout\""; rpc error: code = Unavailable desc = connection error: desc = \""transport: error while dialing: dial tcp [10.233.109.55:20160](http://10.233.109.55:20160/): i/o timeout\""; rpc error: code = Unavailable desc = connection error: desc = \""transport: error while dialing: dial tcp [10.233.109.55:20160](http://10.233.109.55:20160/): i/o timeout\""; rpc error: code = Unavailable desc = connection error: desc = \""transport: error while dialing: dial tcp [10.233.109.55:20160](http://10.233.109.55:20160/): i/o timeout\""; rpc error: code = Unavailable desc = connection error: desc = \""transport: error while dialing: dial tcp [10.233.109.55:20160](http://10.233.109.55:20160/): i/o timeout\""""] [stack=""[github.com/pingcap/tidb/br/pkg/restore.(*FileImporter).ImportSSTFiles.func1\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/restore/import.go:523\ngithub.com/pingcap/tidb/br/pkg/utils.WithRetry.func1\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/utils/retry.go:216\ngithub.com/pingcap/tidb/br/pkg/utils.WithRetryV2[...]\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/utils/retry.go:234\ngithub.com/pingcap/tidb/br/pkg/utils.WithRetry\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/utils/retry.go:215\ngithub.com/pingcap/tidb/br/pkg/restore.(*FileImporter).ImportSSTFiles\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/restore/import.go:492\ngithub.com/pingcap/tidb/br/pkg/restore.(*Client).RestoreSSTFiles.func2\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/restore/client.go:1183\ngithub.com/pingcap/tidb/br/pkg/utils.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/utils/worker.go:76\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/go/pkg/mod/golang.org/x/sync@v0.7.0/errgroup/errgroup.go:78](http://github.com/pingcap/tidb/br/pkg/restore.(*FileImporter).ImportSSTFiles.func1/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/restore/import.go:523/ngithub.com/pingcap/tidb/br/pkg/utils.WithRetry.func1/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/utils/retry.go:216/ngithub.com/pingcap/tidb/br/pkg/utils.WithRetryV2[...]/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/utils/retry.go:234/ngithub.com/pingcap/tidb/br/pkg/utils.WithRetry/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/utils/retry.go:215/ngithub.com/pingcap/tidb/br/pkg/restore.(*FileImporter).ImportSSTFiles/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/restore/import.go:492/ngithub.com/pingcap/tidb/br/pkg/restore.(*Client).RestoreSSTFiles.func2/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/restore/client.go:1183/ngithub.com/pingcap/tidb/br/pkg/utils.(*WorkerPool).ApplyOnErrorGroup.func1/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/utils/worker.go:76/ngolang.org/x/sync/errgroup.(*Group).Go.func1/n/t/go/pkg/mod/golang.org/x/sync@v0.7.0/errgroup/errgroup.go:78)""]`

### 4. What is your TiDB version? (Required)
./tidb-server -V
Release Version: v6.5.10
Edition: Community
Git Commit Hash: https://github.com/pingcap/tidb/commit/23062507bab86d03a616c2793607c3f4dd349235
Git Branch: heads/refs/tags/v6.5.10
UTC Build Time: 2024-06-12 08:25:43
GoVersion: go1.19.13
Race Enabled: false
TiKV Min Version: 6.2.0-alpha
Check Table Before Drop: false
Store: unistore
2024-06-13T06:58:24.395+0800",https://github.com/pingcap/tidb/issues/54053,pingcap/tidb,2024-06-17 07:53:05+00:00,2024-06-19 08:56:49+00:00,2024-06-19 08:56:49+00:00,closed,"['type/bug', 'severity/major', 'component/br', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1']",Data Corruption
TiDB consumes lots of resource when create table in million tables scenario and infoSchema V2 for loadSchema,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
3 TiDB instatnce(16c 64GB)
tidb_schema_cache_size 2GB
open fast create table
create 100k schemas and about 15 tables each of schema. 1.5 million tables totally
```
select count(table_name), count(distinct TABLE_schema) from information_schema.tables where TABLE_SCHEMA like ""mt%"" ;
+-------------------+------------------------------+
| count(table_name) | count(distinct TABLE_schema) |
+-------------------+------------------------------+
|           1570000 |                       100000 |
+-------------------+------------------------------+
```
Taking the node 'tidb1' as an example, when the number of tables reaches a certain amount (perhaps around 700,000), continuing to create tables will trigger a ""full load InfoSchema"". Subsequently, the resource consumption of this TiDB instance will continue to increase. Even if we stop the DDL tasks, the CPU and memory usage will continue to maintain a high level.

![image](https://github.com/pingcap/tidb/assets/7677963/4f3e548e-0db0-4fde-8f6a-ea8d31a56484)

![image](https://github.com/pingcap/tidb/assets/7677963/16f4ada4-f103-4a47-a570-212fa50ef211)

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
 Release Version: v8.2.0-alpha
Edition: Community
Git Commit Hash: 6cf8776242fbfe0b922488357867ca5244e7b8fa
Git Branch: heads/refs/tags/v8.2.0-alpha
UTC Build Time: 2024-06-13 11:49:48
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv",https://github.com/pingcap/tidb/issues/54046,pingcap/tidb,2024-06-17 06:43:43+00:00,2024-07-01 06:34:28+00:00,2024-07-01 06:34:27+00:00,closed,"['type/bug', 'severity/minor', 'feature/developing', 'component/ddl']",Memory Leak / Resource Exhaustion
Error 3144 (HY000): Cannot create a JSON value from a string with CHARACTER SET 'binary'.,"## Bug Report
the bug is same as MySQL, [link](https://bugs.mysql.com/bug.php?id=93052)

### 1. Minimal reproduce step (Required)
when use gorm in golang.
```
storage.DB().Model(filter).Where(filter).Where(""JSON_CONTAINS(labels,JSON_OBJECT(?,?))"", ""flag"", true).Find(&list).Error
```
### 2. What did you expect to see? (Required)
The query result is displayed normally

### 3. What did you see instead (Required)
```
Error 3144 (HY000): Cannot create a JSON value from a string with CHARACTER SET 'binary'.
```

If concatenated into an SQL statement, it runs properly.

### 4. What is your TiDB version? (Required)
Release Version: v6.5.0
Edition: Community
Git Commit Hash: 706c3fa3c526cdba5b3e9f066b1a568fb96c56e3
Git Branch: heads/refs/tags/v6.5.0
UTC Build Time: 2022-12-27 03:50:44
GoVersion: go1.19.3
Race Enabled: false
TiKV Min Version: 6.2.0-alpha
Check Table Before Drop: false
Store: tikv

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/54044,pingcap/tidb,2024-06-17 06:30:50+00:00,2025-02-07 05:37:32+00:00,2024-11-20 16:00:44+00:00,closed,"['type/bug', 'sig/sql-infra', 'severity/moderate', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1', 'affects-8.5']",SQL Syntax / Parsing Error
Wrong user in error message when running SET PASSWORD FOR USER without sufficient privileges,"## Bug Report

Imagine having two users:
1. `u1` with `SUPER` privilege
2. `u2` without `SUPER` privilege

When `u2` tries to run `SET PASSWORD FOR u1`, it should return an error saying that `u2` does not have enough privilege. But the current error will say `u1` does not have enough privilege, which doesn't seem correct.

Tested with MySQL 8.3.0 and verified that the behavior is different:
```
➜  ~ mysql -u root
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 10
Server version: 8.3.0 Homebrew

Copyright (c) 2000, 2024, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> create user u1;
Query OK, 0 rows affected (0.01 sec)

mysql> grant super on *.* to u1;
Query OK, 0 rows affected, 1 warning (0.01 sec)

mysql> create user u2;
Query OK, 0 rows affected (0.01 sec)

mysql> grant create user on *.* to u2;
Query OK, 0 rows affected (0.01 sec)
➜  ~ mysql -u u2;
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 11
Server version: 8.3.0 Homebrew

Copyright (c) 2000, 2024, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> set password for 'u1'='pwd';
ERROR 1044 (42000): Access denied for user 'u2'@'%' to database 'mysql'
```

### 1. Minimal reproduce step (Required)

Add a unit test:
```go
func TestSetPwd(t *testing.T) {
	store := testkit.CreateMockStore(t)
	tk := testkit.NewTestKit(t, store)

	// Create user u1 with super privilege.
	tk.MustExec(""create user 'u1'"")
	tk.MustExec(""grant super on *.* to u1"")
	// Create user u2 with create user privilege.
	tk.MustExec(""create user 'u2'"")
	tk.MustExec(""grant create user on *.* to u2"")

	tk2 := testkit.NewTestKit(t, store)
	require.NoError(t, tk2.Session().Auth(&auth.UserIdentity{Username: ""u2"", Hostname: ""localhost""}, nil, nil, nil))
	tk2.MustExec(""set password for 'u1'='randompassword'"")
}
```

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)
Should see this error: `[executor:1044]Access denied for user 'u2'@'%' to database 'mysql'` since `u2` lacks the privileges.

### 3. What did you see instead (Required)
Error: `[executor:1044]Access denied for user 'u1'@'%' to database 'mysql'`

Full trace:
```
Test:           TestSetPwd
                Messages:       sql:set password for 'u1'='randompassword', [], error stack [executor:1044]Access denied for user 'u1'@'%' to database 'mysql'
                                github.com/pingcap/errors.AddStack
                                        /Users/yzhan/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/errors.go:178
                                github.com/pingcap/errors.(*Error).GenWithStackByArgs
                                        /Users/yzhan/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/normalize.go:175
                                github.com/pingcap/tidb/pkg/executor.(*SimpleExec).executeSetPwd
                                        /Users/yzhan/workspace2/tidb/pkg/executor/simple.go:2470
                                github.com/pingcap/tidb/pkg/executor.(*SimpleExec).Next
                                        /Users/yzhan/workspace2/tidb/pkg/executor/simple.go:178
                                github.com/pingcap/tidb/pkg/executor/internal/exec.Next
                                        /Users/yzhan/workspace2/tidb/pkg/executor/internal/exec/executor.go:410
                                github.com/pingcap/tidb/pkg/executor.(*ExecStmt).next
                                        /Users/yzhan/workspace2/tidb/pkg/executor/adapter.go:1238
                                github.com/pingcap/tidb/pkg/executor.(*ExecStmt).handleNoDelayExecutor
                                        /Users/yzhan/workspace2/tidb/pkg/executor/adapter.go:987
                                github.com/pingcap/tidb/pkg/executor.(*ExecStmt).handleNoDelay
                                        /Users/yzhan/workspace2/tidb/pkg/executor/adapter.go:821
                                github.com/pingcap/tidb/pkg/executor.(*ExecStmt).Exec
                                        /Users/yzhan/workspace2/tidb/pkg/executor/adapter.go:585
                                github.com/pingcap/tidb/pkg/session.runStmt
                                        /Users/yzhan/workspace2/tidb/pkg/session/session.go:2285
                                github.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt
                                        /Users/yzhan/workspace2/tidb/pkg/session/session.go:2146
                                github.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecWithContext
                                        /Users/yzhan/workspace2/tidb/pkg/testkit/testkit.go:383
                                github.com/pingcap/tidb/pkg/testkit.(*TestKit).MustExecWithContext
                                        /Users/yzhan/workspace2/tidb/pkg/testkit/testkit.go:155
                                github.com/pingcap/tidb/pkg/testkit.(*TestKit).MustExec
                                        /Users/yzhan/workspace2/tidb/pkg/testkit/testkit.go:150
                                github.com/pingcap/tidb/pkg/extension_test.TestSetPwd
                                        /Users/yzhan/workspace2/tidb/pkg/extension/auth_test.go:683
                                testing.tRunner
                                        /usr/local/go/src/testing/testing.go:1595
                                runtime.goexit
                                        /usr/local/go/src/runtime/asm_arm64.s:1197

```

### 4. What is your TiDB version? (Required)
Latest commit or v8.1.0.
<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/54039,pingcap/tidb,2024-06-16 02:53:00+00:00,2024-07-17 18:25:32+00:00,2024-07-17 18:25:32+00:00,closed,"['type/bug', 'sig/sql-infra', 'severity/moderate']",Privilege Escalation
Updating a column with another column is not compatible with MySQL 8.0,"## Bug Report

When I update a column with another column, I will get old values in TiDB, but I will get new values in MySQL.
It is not compatible with MYSQL 8.0.
Thank for your reply.
Please answer these questions before submitting your issue. Thanks!
### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
```SQL
CREATE TABLE t0 (c0 int, c1 int);
INSERT INTO t0 VALUES (1, 2);
INSERT INTO t0 VALUES (3, 4);
INSERT INTO t0 VALUES (5, 6);
SELECT * FROM t0;
UPDATE t0 SET c1 = 123, c0 = c1;
SELECT * FROM t0;
```
### 2. What did you expect to see? (Required)
In MySQL
```SQL
mysql> SELECT * FROM t0;
+------+------+
| c0   | c1   |
+------+------+
|    1 |    2 |
|    3 |    4 |
|    5 |    6 |
+------+------+
3 rows in set (0.00 sec)

mysql> UPDATE t0 SET c1 = 123, c0 = c1;
Query OK, 3 rows affected (0.02 sec)
Rows matched: 3  Changed: 3  Warnings: 0

mysql> SELECT * FROM t0;
+------+------+
| c0   | c1   |
+------+------+
|  123 |  123 |
|  123 |  123 |
|  123 |  123 |
+------+------+
3 rows in set (0.00 sec)
```
### 3. What did you see instead (Required)
In TiDB
```SQL
mysql> SELECT * FROM t0;
+------+------+
| c0   | c1   |
+------+------+
|    1 |    2 |
|    3 |    4 |
|    5 |    6 |
+------+------+
3 rows in set (0.00 sec)

mysql> UPDATE t0 SET c1 = 123, c0 = c1;
Query OK, 3 rows affected (0.00 sec)
Rows matched: 3  Changed: 3  Warnings: 0

mysql> SELECT * FROM t0;
+------+------+
| c0   | c1   |
+------+------+
|    2 |  123 |
|    4 |  123 |
|    6 |  123 |
+------+------+
3 rows in set (0.00 sec)
```
### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
Release Version: v8.1.0
Edition: Community
Git Commit Hash: 945d07c5d5c7a1ae212f6013adfb187f2de24b23
Git Branch: HEAD
UTC Build Time: 2024-05-21 03:51:57
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv",https://github.com/pingcap/tidb/issues/54038,pingcap/tidb,2024-06-15 08:50:36+00:00,2024-09-04 07:24:42+00:00,,open,"['type/bug', 'sig/transaction', 'severity/moderate', 'compatibility-mysql80']",Transaction Anomaly
tidb_schema_cache_size max support value is wrong,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
```
mysql> set @@global.tidb_schema_cache_size=10737418240;
Query OK, 0 rows affected, 1 warning (0.05 sec)

mysql> show warnings;
+---------+------+-----------------------------------------------------------------+
| Level   | Code | Message                                                         |
+---------+------+-----------------------------------------------------------------+
| Warning | 1292 | Truncated incorrect tidb_schema_cache_size value: '10737418240' |
+---------+------+-----------------------------------------------------------------+
1 row in set (0.07 sec)

mysql> select @@global.tidb_schema_cache_size;
+---------------------------------+
| @@global.tidb_schema_cache_size |
+---------------------------------+
| 2147483647                      |
+---------------------------------+
1 row in set (0.06 sec)

```
### 2. What did you expect to see? (Required)
The Range is [0, 9223372036854775807] based the dock https://docs.pingcap.com/tidb/dev/system-variables#tidb_schema_cache_size-new-in-v800
### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
Release Version: v8.2.0-alpha
Edition: Community
Git Commit Hash: 6cf8776242fbfe0b922488357867ca5244e7b8fa
Git Branch: heads/refs/tags/v8.2.0-alpha
UTC Build Time: 2024-06-13 11:49:48
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv",https://github.com/pingcap/tidb/issues/54034,pingcap/tidb,2024-06-14 11:41:17+00:00,2024-06-26 07:58:24+00:00,2024-06-26 07:58:24+00:00,closed,"['type/bug', 'sig/sql-infra', 'severity/moderate', 'feature/developing']",Constraint Violation
TiDB does not reject connection for mismatched user when using auth_socket plugin,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

1. Create a new user with `auth_socket` plugin:

```mysql
CREATE USER 'u1'@'localhost' IDENTIFIED WITH auth_socket;
```

2. connect TiDB with MySQL client (my current system user is `wangchao`)

```
$ whoami
wangchao

$ mysql --comments -uu1 -S/tmp/tidb-4001.sock
```

### 2. What did you expect to see? (Required)

The connection should be rejected because the current system user and TiDB user are not the same:

```
$ mysql --comments -uu1 -S/tmp/tidb-4001.sock
ERROR 1045 (28000): Access denied for user 'u1'@'localhost' (using password: NO)
```

See [descriptions in MySQL doc](https://dev.mysql.com/doc/refman/8.4/en/socket-pluggable-authentication.html#socket-pluggable-authentication-usage) :

> The socket plugin checks whether the socket user name (the operating system user name) matches the MySQL user name specified by the client program to the server. If the names do not match, the plugin checks whether the socket user name matches the name specified in the authentication_string column of the mysql.user system table row. If a match is found, the plugin permits the connection. 

### 3. What did you see instead (Required)

However, it succeed in TiDB

```
> whoami
wangchao
> mysql --comments -uu1 -S/tmp/tidb-4001.sock
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 2097162
Server version: 8.0.11-TiDB-None TiDB Server (Apache License 2.0) Community Edition, MySQL 8.0 compatible

Copyright (c) 2000, 2024, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> select current_user();
+----------------+
| current_user() |
+----------------+
| u1@localhost   |
+----------------+
1 row in set (0.00 sec)
```

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->

This is introduced by #37052 and seems to affect 6.5 and the subsequent versions",https://github.com/pingcap/tidb/issues/54031,pingcap/tidb,2024-06-14 09:12:42+00:00,2024-06-17 07:28:17+00:00,2024-06-17 07:28:17+00:00,closed,"['type/bug', 'sig/sql-infra', 'severity/major', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1']",Performance Degradation
Using JSON_TYPE on non-JSON values should return an error,"## Bug Report

### 1. Minimal reproduce step (Required)


```sql
CREATE TABLE t1(id INT PRIMARY KEY, d1 DATE, d2 DATETIME, t1 TIME, t2 TIMESTAMP, b1 BIT, b2 BINARY);
INSERT INTO t1 VALUES (1, '2024-06-14', '2024-06-14 09:37:00', '09:37:00', '2024-06-14 09:37:00', b'0', 0x41);
SELECT JSON_TYPE(d1),JSON_TYPE(d2),JSON_TYPE(t1),JSON_TYPE(t2),JSON_TYPE(b1),JSON_TYPE(b2) FROM t1;
```
<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

```
mysql-8.4.0> CREATE TABLE t1(id INT PRIMARY KEY, d1 DATE, d2 DATETIME, t1 TIME, t2 TIMESTAMP, b1 BIT, b2 BINARY);
Query OK, 0 rows affected (0.02 sec)

mysql-8.4.0> INSERT INTO t1 VALUES (1, '2024-06-14', '2024-06-14 09:37:00', '09:37:00', '2024-06-14 09:37:00', b'0', 0x41);
Query OK, 1 row affected (0.01 sec)

mysql-8.4.0> SELECT JSON_TYPE(d1),JSON_TYPE(d2),JSON_TYPE(t1),JSON_TYPE(t2),JSON_TYPE(b1),JSON_TYPE(b2) FROM t1;
ERROR 3146 (22032): Invalid data type for JSON data in argument 1 to function json_type; a JSON string or JSON type is required.
```

### 3. What did you see instead (Required)

```
mysql-8.0.11-TiDB-v8.1.0> CREATE TABLE t1(id INT PRIMARY KEY, d1 DATE, d2 DATETIME, t1 TIME, t2 TIMESTAMP, b1 BIT, b2 BINARY);
Query OK, 0 rows affected (0.11 sec)

mysql-8.0.11-TiDB-v8.1.0> INSERT INTO t1 VALUES (1, '2024-06-14', '2024-06-14 09:37:00', '09:37:00', '2024-06-14 09:37:00', b'0', 0x41);
Query OK, 1 row affected (0.01 sec)

mysql-8.0.11-TiDB-v8.1.0> SELECT JSON_TYPE(d1),JSON_TYPE(d2),JSON_TYPE(t1),JSON_TYPE(t2),JSON_TYPE(b1),JSON_TYPE(b2) FROM t1;
+---------------+---------------+---------------+---------------+------------------+---------------+
| JSON_TYPE(d1) | JSON_TYPE(d2) | JSON_TYPE(t1) | JSON_TYPE(t2) | JSON_TYPE(b1)    | JSON_TYPE(b2) |
+---------------+---------------+---------------+---------------+------------------+---------------+
| DATE          | DATETIME      | TIME          | DATETIME      | UNSIGNED INTEGER | BLOB          |
+---------------+---------------+---------------+---------------+------------------+---------------+
1 row in set (0.00 sec)
```

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->

```
Release Version: v8.1.0
Edition: Community
Git Commit Hash: 945d07c5d5c7a1ae212f6013adfb187f2de24b23
Git Branch: HEAD
UTC Build Time: 2024-05-21 03:51:57
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv
```",https://github.com/pingcap/tidb/issues/54029,pingcap/tidb,2024-06-14 07:43:42+00:00,2024-11-20 16:00:43+00:00,2024-11-20 16:00:43+00:00,closed,"['type/bug', 'component/json', 'sig/sql-infra', 'severity/minor']",Memory Leak / Resource Exhaustion
Differences in JSON type for casting YEAR and binary,"## Bug Report

### 1. Minimal reproduce step (Required)

```sql
SET NAMES utf8mb4 COLLATE utf8mb4_0900_ai_ci;
WITH tbl AS (SELECT 0x41 v) SELECT v,CAST(v AS JSON), JSON_TYPE(CAST(v AS JSON)) FROM tbl;
WITH tbl AS (SELECT CAST('2024' AS year) v) SELECT v,CAST(v AS JSON), JSON_TYPE(CAST(v AS JSON)) FROM tbl;
```

### 2. What did you expect to see? (Required)

MySQL 8.4.0 

```
mysql-8.4.0> WITH tbl AS (SELECT 0x41 v) SELECT v,CAST(v AS JSON), JSON_TYPE(CAST(v AS JSON)) FROM tbl;
+------+----------------------+----------------------------+
| v    | CAST(v AS JSON)      | JSON_TYPE(CAST(v AS JSON)) |
+------+----------------------+----------------------------+
| 0x41 | ""base64:type15:QQ=="" | BLOB                       |
+------+----------------------+----------------------------+
1 row in set (0.00 sec)

mysql-8.4.0> WITH tbl AS (SELECT CAST('2024' AS year) v) SELECT v,CAST(v AS JSON), JSON_TYPE(CAST(v AS JSON)) FROM tbl;
+------+-----------------+----------------------------+
| v    | CAST(v AS JSON) | JSON_TYPE(CAST(v AS JSON)) |
+------+-----------------+----------------------------+
| 2024 | 2024            | UNSIGNED INTEGER           |
+------+-----------------+----------------------------+
1 row in set (0.01 sec)
```

### 3. What did you see instead (Required)

TiDB v8.1.0

```
mysql-8.0.11-TiDB-v8.1.0> WITH tbl AS (SELECT 0x41 v) SELECT v,CAST(v AS JSON), JSON_TYPE(CAST(v AS JSON)) FROM tbl;
+------+-----------------------+----------------------------+
| v    | CAST(v AS JSON)       | JSON_TYPE(CAST(v AS JSON)) |
+------+-----------------------+----------------------------+
| 0x41 | ""base64:type253:QQ=="" | BLOB                       |
+------+-----------------------+----------------------------+
1 row in set (0.01 sec)

mysql-8.0.11-TiDB-v8.1.0> WITH tbl AS (SELECT CAST('2024' AS year) v) SELECT v,CAST(v AS JSON), JSON_TYPE(CAST(v AS JSON)) FROM tbl; 
+------+-----------------+----------------------------+
| v    | CAST(v AS JSON) | JSON_TYPE(CAST(v AS JSON)) |
+------+-----------------+----------------------------+
| 2024 | 2024            | INTEGER                    |
+------+-----------------+----------------------------+
1 row in set (0.00 sec)
```

Note the difference between `type253` and `type15` and `INTEGER` vs `UNSIGNED INTEGER`.

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
```
Release Version: v8.1.0
Edition: Community
Git Commit Hash: 945d07c5d5c7a1ae212f6013adfb187f2de24b23
Git Branch: HEAD
UTC Build Time: 2024-05-21 03:51:57
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv
```",https://github.com/pingcap/tidb/issues/54027,pingcap/tidb,2024-06-14 07:24:23+00:00,2024-06-20 15:00:13+00:00,,open,"['type/bug', 'component/json', 'sig/sql-infra', 'severity/minor']",Data Corruption
TiDB memory leak after meets the `fail to get stats version for this histogram`,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

1. Change the async load stats code:
```diff
diff --git a/pkg/sessionctx/variable/tidb_vars.go b/pkg/sessionctx/variable/tidb_vars.go
index e10aa9c5bbb9f..39153b4433448 100644
--- a/pkg/sessionctx/variable/tidb_vars.go
+++ b/pkg/sessionctx/variable/tidb_vars.go
@@ -1287,7 +1287,7 @@ const (
 	DefTiDBTableCacheLease                         = 3 // 3s
 	DefTiDBPersistAnalyzeOptions                   = true
 	DefTiDBEnableColumnTracking                    = false
-	DefTiDBStatsLoadSyncWait                       = 100
+	DefTiDBStatsLoadSyncWait                       = 0
 	DefTiDBStatsLoadPseudoTimeout                  = true
 	DefSysdateIsNow                                = false
 	DefTiDBEnableMutationChecker                   = false
diff --git a/pkg/statistics/handle/storage/read.go b/pkg/statistics/handle/storage/read.go
index bacf43abef60f..e1f43e8ecdc65 100644
--- a/pkg/statistics/handle/storage/read.go
+++ b/pkg/statistics/handle/storage/read.go
@@ -539,7 +539,7 @@ func loadNeededColumnHistograms(sctx sessionctx.Context, statsCache util.StatsCa
 	if err != nil {
 		return errors.Trace(err)
 	}
-	if len(rows) == 0 {
+	if true {
 		logutil.BgLogger().Error(""fail to get stats version for this histogram"", zap.Int64(""table_id"", col.TableID), zap.Int64(""hist_id"", col.ID))
 		return errors.Trace(fmt.Errorf(""fail to get stats version for this histogram, table_id:%v, hist_id:%v"", col.TableID, col.ID))
 	}
@@ -599,7 +599,7 @@ func loadNeededIndexHistograms(sctx sessionctx.Context, statsCache util.StatsCac
 	if err != nil {
 		return errors.Trace(err)
 	}
-	if len(rows) == 0 {
+	if true {
 		logutil.BgLogger().Error(""fail to get stats version for this histogram"", zap.Int64(""table_id"", idx.TableID), zap.Int64(""hist_id"", idx.ID))
 		return errors.Trace(fmt.Errorf(""fail to get stats version for this histogram, table_id:%v, hist_id:%v"", idx.TableID, idx.ID))
 	}
```
2. Create some tables and analyze those tables
3. Try to issue some select queries to TiDB

### 2. What did you expect to see? (Required)
The memory usage of TiDB does not increase.

### 3. What did you see instead (Required)
![img_v3_02bq_c13de680-8d76-4927-8f90-70d0f55d1e5g](https://github.com/pingcap/tidb/assets/29879298/53050ddf-2eac-4ef2-98b9-620f95f10213)
![img_v3_02bq_3ff29c9b-d5c3-40a1-b8d6-48242f5e8aag](https://github.com/pingcap/tidb/assets/29879298/c6dd8b6d-4f4f-4c88-8e25-2933d8ca0318)
![img_v3_02bq_1278b481-a16b-4a56-ab13-5f86d68d0abg](https://github.com/pingcap/tidb/assets/29879298/8fcfa01a-91e7-4d00-8773-04b85978eb6e)


### 4. What is your TiDB version? (Required)

v7.5.1",https://github.com/pingcap/tidb/issues/54022,pingcap/tidb,2024-06-14 03:54:53+00:00,2024-08-02 11:32:34+00:00,2024-06-20 04:31:06+00:00,closed,"['type/bug', 'sig/planner', 'severity/major', 'affects-7.1', 'affects-7.5', 'report/customer', 'impact/leak']",Data Corruption
test,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/54018,pingcap/tidb,2024-06-14 02:52:46+00:00,2024-06-14 04:21:06+00:00,2024-06-14 04:21:06+00:00,closed,['type/bug'],Crash / Segmentation Fault
br backup failed when kill pd leader or injection network partition between pd leader and pd followers,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
1、run br backup
2、kill pd leader or injection network partition between pd leader and pd followers

### 2. What did you expect to see? (Required)
br backup can success

### 3. What did you see instead (Required)
br backup failed

`(*Group).Go.func1\n\t/go/pkg/mod/golang.org/x/sync@v0.7.0/errgroup/errgroup.go:78\nruntime.goexit\n\t/usr/local/go/src/runtime/asm_amd64.s:1594""] [unit-name=""range start:74800000000000014f5f720000000000000000 end:74800000000000014f5f72ffffffffffffffff00""] [error=""rpc error: code = Canceled desc = context canceled""] [errorVerbose=""rpc error: code = Canceled desc = context canceled\ngithub.com/tikv/pd/client.(*client).respForErr\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20230904040343-947701a32c05/client.go:1942\ngithub.com/tikv/pd/client.(*client).GetAllStores\n\t/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20230904040343-947701a32c05/client.go:1611\ngithub.com/pingcap/tidb/br/pkg/conn/util.GetAllTiKVStores\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/conn/util/util.go:48\ngithub.com/pingcap/tidb/br/pkg/conn.GetAllTiKVStoresWithRetry.func1\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/conn/conn.go:82\ngithub.com/pingcap/tidb/br/pkg/utils.WithRetry.func1\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/utils/retry.go:216\ngithub.com/pingcap/tidb/br/pkg/utils.WithRetryV2[...]\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/utils/retry.go:234\ngithub.com/pingcap/tidb/br/pkg/utils.WithRetry\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/utils/retry.go:215\ngithub.com/pingcap/tidb/br/pkg/conn.GetAllTiKVStoresWithRetry\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/conn/conn.go:79\ngithub.com/pingcap/tidb/br/pkg/backup.(*Client).BackupRange\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/backup/client.go:880\ngithub.com/pingcap/tidb/br/pkg/backup.(*Client).BackupRanges.func2\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/backup/client.go:839\ngithub.com/pingcap/tidb/br/pkg/utils.(*WorkerPool).ApplyOnErrorGroup.func1\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/br/br/pkg/utils/worker.go:76\ngolang.org/x/sync/errgroup.(*Group).Go.func1\n\t/go/pkg/mod/golang.org/x/sync@v0.7.0/errgroup/errgroup.go:78\nruntime.goexit`

![img_v3_02br_cc36bcaf-0606-4c78-8b60-2fd03e3302bg](https://github.com/pingcap/tidb/assets/84712107/d53253d4-677d-48d1-8a48-c1fcb743a066)

### 4. What is your TiDB version? (Required)
./tidb-server -V
 Release Version: v6.5.10
Edition: Community
Git Commit Hash: 23062507bab86d03a616c2793607c3f4dd349235
Git Branch: heads/refs/tags/v6.5.10
UTC Build Time: 2024-06-12 08:25:43
GoVersion: go1.19.13
Race Enabled: false
TiKV Min Version: 6.2.0-alpha
Check Table Before Drop: false
Store: unistore
2024-06-13T06:58:24.395+0800",https://github.com/pingcap/tidb/issues/54017,pingcap/tidb,2024-06-14 02:21:57+00:00,2024-07-24 10:04:48+00:00,2024-06-21 01:49:38+00:00,closed,"['type/bug', 'severity/major', 'component/br', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1']",Deadlock
Invalid TABLESAMPLE: plan not supported,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

```sql
drop table if exists t;
create table t (a decimal(62,2) not null, key idx (a), primary key (a) clustered);
select a from t tablesample regions() order by a;
```

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

No error.

### 3. What did you see instead (Required)

Invalid TABLESAMPLE: plan not supported

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
329a9800c",https://github.com/pingcap/tidb/issues/54015,pingcap/tidb,2024-06-14 01:41:04+00:00,2024-06-14 15:29:45+00:00,2024-06-14 15:29:45+00:00,closed,"['type/bug', 'sig/planner', 'severity/moderate']",SQL Syntax / Parsing Error
TestMergeJoinInDisk test in ut is unstable,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

1. cd tidb
2. make failpoint-enable
3. `go test -timeout 30s -tags intest,deadlock -run ^TestShuffleMergeJoinInDisk$ github.com/pingcap/tidb/pkg/executor/join`
4. repeat step 4

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

no error happens

### 3. What did you see instead (Required)

error happens and there are two different errors

### 4. What is your TiDB version? (Required)

f124165c9be

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/54006,pingcap/tidb,2024-06-13 10:14:32+00:00,2024-07-09 11:45:05+00:00,2024-07-09 11:45:05+00:00,closed,"['type/bug', 'component/test', 'sig/execution', 'severity/moderate']",Concurrency Issue
unexpected memory usage of memory tracker,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
[data.txt](https://github.com/user-attachments/files/15817106/data.txt)
[query.txt](https://github.com/user-attachments/files/15817107/query.txt)
[schema.txt](https://github.com/user-attachments/files/15817108/schema.txt)



``` sql
# mysql -h 10.71.205.177 -uroot -P 4000 --local-infile=1 --comments
source schema.txt
source data.txt
source query.txt
```
After executing this SQL, the heap profile shows that the memory usage related to the tracker is significantly high. This behavior is unexpected.
1. The tracker's memory should not occupy such a large portion.
2. This memory is not being tracked, and therefore it is not included in the total memory usage of a single SQL statement. This can prevent the SQL from being canceled in a timely manner, potentially leading to an Out of Memory risk.

 
<img width=""1692"" alt=""截屏2024-06-13 17 38 43"" src=""https://github.com/pingcap/tidb/assets/9039012/df7cc2b1-958f-457b-9a05-5ae26f8fed38"">


### 2. What did you expect to see? (Required)


### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)
nightly
8d28b23c3c7e40ee475c6d74931e37b728f1b610",https://github.com/pingcap/tidb/issues/54005,pingcap/tidb,2024-06-13 09:42:04+00:00,2024-06-28 05:58:19+00:00,2024-06-26 11:10:23+00:00,closed,"['type/bug', 'sig/execution', 'severity/major', 'affects-5.4', 'affects-6.1', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1', 'affects-8.2']",Memory Leak / Resource Exhaustion
Azure Identity Libraries and Microsoft Authentication Library Elevation of Privilege Vulnerability,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

ref https://github.com/pingcap/tidb/security/dependabot/76
<img width=""1414"" alt=""image"" src=""https://github.com/pingcap/tidb/assets/3427324/b8efa4b9-1431-4151-a334-5f3997b90dc4"">

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53990,pingcap/tidb,2024-06-13 05:56:06+00:00,2024-06-14 02:16:56+00:00,2024-06-14 02:16:56+00:00,closed,"['type/bug', 'sig/sql-infra', 'severity/minor']",Privilege Escalation
Transaction's memory usage is tracked multiple times,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

N/A

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

Precise memory tracking.

### 3. What did you see instead (Required)

Transaction's memory usage is tracked by multiple times:
1. MemDB tracker
2. Stale tracking in executors like https://github.com/pingcap/tidb/blob/7b8c91d5d69a9077e725582bed889f214f7f963d/pkg/executor/replace.go#L190

### 4. What is your TiDB version? (Required)

master

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53984,pingcap/tidb,2024-06-13 04:43:16+00:00,2024-07-02 10:11:58+00:00,2024-07-02 10:11:58+00:00,closed,"['type/bug', 'sig/transaction', 'severity/moderate', 'affects-6.5', 'affects-6.6', 'affects-7.0', 'affects-7.1', 'affects-7.2', 'affects-7.3', 'affects-7.4', 'affects-7.5', 'affects-7.6', 'affects-8.0', 'affects-8.1']",Memory Leak / Resource Exhaustion
`tidb_enable_async_merge_global_stats` cannot work correctly,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

1. Start the TiDB with the following code:
```patch
diff --git a/pkg/statistics/handle/globalstats/global_stats.go b/pkg/statistics/handle/globalstats/global_stats.go
index 78ee277659..9a814ca4ca 100644
--- a/pkg/statistics/handle/globalstats/global_stats.go
+++ b/pkg/statistics/handle/globalstats/global_stats.go
@@ -103,6 +103,7 @@ func MergePartitionStats2GlobalStats(
        histIDs []int64,
 ) (globalStats *GlobalStats, err error) {
        if sc.GetSessionVars().EnableAsyncMergeGlobalStats {
+               logutil.BgLogger().Info(""use async merge global stats"", zap.String(""table"", globalTableInfo.Name.L))
                worker, err := NewAsyncMergePartitionStats2GlobalStats(statsHandle, globalTableInfo, histIDs, is)
                if err != nil {
                        return nil, errors.Trace(err)
@@ -113,6 +114,7 @@ func MergePartitionStats2GlobalStats(
                }
                return worker.Result(), nil
        }
+       logutil.BgLogger().Info(""use blocking merge global stats"", zap.String(""table"", globalTableInfo.Name.L))
        return blockingMergePartitionStats2GlobalStats(sc, statsHandle.GPool(), opts, is, globalTableInfo, isIndex, histIDs, nil, statsHandle)
 }
```
2. Create a database and partitioned table:
```sql
CREATE DATABASE IF NOT EXISTS partition_example;
USE partition_example;
CREATE TABLE example_table (
    id INT NOT NULL,
    name VARCHAR(50),
    PRIMARY KEY (id)
)
PARTITION BY RANGE (id) (
    PARTITION p0 VALUES LESS THAN (2),
    PARTITION p1 VALUES LESS THAN (4),
    PARTITION p2 VALUES LESS THAN (6),
    PARTITION p3 VALUES LESS THAN (8),
    PARTITION p4 VALUES LESS THAN MAXVALUE
);

```
3. Insert 3000 rows:
```ts
import { Client } from ""https://deno.land/x/mysql/mod.ts"";

const client = await new Client().connect({
  hostname: ""127.0.0.1"",
  port: 4000,
  username: ""root"",
  db: ""partition_example"",
  password: """",
});

async function insertData() {
  for (let i = 1; i <= 3000; i++) {
    const name = `Name${i}`;
    await client.execute(`INSERT INTO example_table (id, name) VALUES (?, ?)`, [
      i,
      name,
    ]);
  }
}

await insertData();

await client.close();

console.log(""Inserted 3000 rows into example_table"");
```
4. Check the logs.

### 2. What did you expect to see? (Required)
```log
use async merge global stats
```

### 3. What did you see instead (Required)
```log
[2024/06/12 19:38:12.833 +08:00] [INFO] [save.go:221] [""directly update count""] [category=stats] [tableID=109] [results.Count=2993] [count=2993]
[2024/06/12 19:38:12.960 +08:00] [INFO] [analyze.go:744] [""analyze table `partition_example`.`example_table` has finished""] [partition=p4] [""job info""=""auto analyze table all columns with 256 buckets, 500 topn, 1 samplerate""] [""start time""=2024/06/12 19:38:12.820 +08:00] [""end time""=2024/06/12 19:38:12.958 +08:00] [cost=137.905ms] [""sample rate reason""=""use min(1, 110000/2993) as the sample-rate=1""]
[2024/06/12 19:38:12.963 +08:00] [INFO] [global_stats.go:117] [""use blocking merge global stats""] [table=example_table]
```

### 4. What is your TiDB version? (Required)

v7.5.1 with patch",https://github.com/pingcap/tidb/issues/53972,pingcap/tidb,2024-06-12 11:49:36+00:00,2024-06-18 09:10:29+00:00,2024-06-13 05:19:31+00:00,closed,"['type/bug', 'sig/planner', 'severity/major', 'affects-7.1', 'affects-7.5', 'affects-8.1']",Incorrect Query Result
dml on table contains generated columns report assertion failed error,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
```sql
 drop table if exists test1;
CREATE TABLE test1 (
col1 bigint(20) NOT NULL ,
col2 varchar(36) NOT NULL ,
col3 int(11) DEFAULT NULL ,
col4 varchar(36) NOT NULL ,
col5 varchar(255) DEFAULT NULL ,
modify_time bigint(20) DEFAULT NULL,
create_time bigint(20) DEFAULT NULL,
col6 json DEFAULT NULL ,
col7 json DEFAULT NULL ,
col8 json GENERATED ALWAYS AS (json_merge_patch(ifnull(col6, _utf8mb4""{}""), ifnull(col7, _utf8mb4""{}""))) STORED,
col9 varchar(36) GENERATED ALWAYS AS (left(json_unquote(json_extract(col8, _utf8mb4""$.col9[0]"")), 36)) VIRTUAL,
col10 varchar(30) GENERATED ALWAYS AS (left(json_unquote(json_extract(col8, _utf8mb4""$.col10"")), 30)) VIRTUAL,
KEY dev_idx1 (col4,col1,col10,col3,col5),
KEY dev_idx2 (col3,col1,col9)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin;

INSERT INTO test1 VALUES (-100000000, ""123459789332"", 1, ""123459789332"", ""AAAAA"", 1675871871, 1675760995, '{""col10"": ""CCCCC"", ""col9"": [""ABCDEFG""]}', '{""col10"": ""DDDDD"", ""col9"": [""abcdefg""]}', DEFAULT, DEFAULT, DEFAULT);
INSERT INTO test1 VALUES (-100000000, ""123459789332"", 1, ""123459789332"", ""BBBBB"", 1675908861, 1675908861, '{""col10"": ""CCCCC"", ""col9"": [""ABCDEFG""]}', NULL, DEFAULT, DEFAULT, DEFAULT);
INSERT INTO test1 VALUES (0, ""123459789332"", 1, ""123459789332"", ""AAAAA"", 1675956409, 1675908882, '{""col10"": ""CCCCC"", ""col9"": [""ABCDEFG""]}', '{""col10"": ""DDDDD"",""col9"": [""abcdefg""]}', DEFAULT, DEFAULT, DEFAULT);
INSERT INTO test1 VALUES (-100000000, ""123459789332"", 1, ""123459789332"", ""BBBBB"", 1675871896, 1675871896, '{""col10"": ""CCCCC"",""col9"": [""ABCDEFG""]}', NULL, DEFAULT, DEFAULT, DEFAULT);
INSERT INTO test1 VALUES (-100000000, ""123459789332"", 1, ""123459789332"", ""AAAAA"", 1675908836, 1675871916, '{""col10"": ""CCCCC"",""col9"": [""ABCDEFG""]}', '{""col10"": ""DDDDD"",""col9"": [""abcdefg""]}', DEFAULT, DEFAULT, DEFAULT);
UPDATE test1 SET col7 = '{""col10"":""DDDDD"",""col9"":[""abcdefg""]}' WHERE col2 = ""123459789332"";
UPDATE test1 SET col1 = -100000000 WHERE col4 = ""123459789332"";
DELETE FROM test1 WHERE col1 < 0;
```
<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)
execute delete sql success 
### 3. What did you see instead (Required)
```sql
[18:00:03]TiDB root:test> DELETE FROM test1 WHERE col1 < 0;
(8141, 'assertion failed: key: 74800000000000006e5f698000000000000001013132333435393738ff3933333200000000fb037ffffffffa0a1f00014444444444000000fc038000000000000001014242424242000000fc038000000000000002, assertion: Exist, start_ts: 450412256536559619, existing start ts: 0, existing commit ts: 0')
```
### 4. What is your TiDB version? (Required)
```sql
[18:00:16]TiDB root:test> select tidb_version();
+-----------------------------------------------------------+
| tidb_version()                                            |
+-----------------------------------------------------------+
| Release Version: v8.2.0-alpha-170-g9da001d777             |
| Edition: Community                                        |
| Git Commit Hash: 9da001d7772363a4ae836999150d5af75b2022ee |
| Git Branch: HEAD                                          |
| UTC Build Time: 2024-05-16 03:50:13                       |
| GoVersion: go1.21.6                                       |
| Race Enabled: false                                       |
| Check Table Before Drop: false                            |
| Store: tikv                                               |
+-----------------------------------------------------------+
1 row in set
```
<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53967,pingcap/tidb,2024-06-12 10:02:39+00:00,2024-09-04 11:23:11+00:00,2024-09-04 11:23:11+00:00,closed,"['type/bug', 'severity/major', 'affects-6.5', 'affects-7.1', 'component/ddl', 'affects-7.5', 'affects-8.1', 'report/community']",Assertion Failure
load stats get error: Table '.' doesn't exist,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

When a table does not yet have statistics, use this API to export:
```
curl -s http://x.x.x.x:10080/stats/dump/test/t1 -o /tmp/t1.json
```

Then import statistics by `load stats ' '` (either the current cluster or a new cluster): 
```
load stats '/tmp/t1.json';
```

I get error:
```
mysql> load stats '/tmp/t1.json';
ERROR 1146 (42S02): Table '.' doesn't exist
```

### 2. What did you expect to see? (Required)

SQL  passed.

### 3. What did you see instead (Required)

ERROR 1146 (42S02): Table '.' doesn't exist

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->

```
Release Version: v7.5.1
Edition: Community
Git Commit Hash: 7d16cc79e81bbf573124df3fd9351c26963f3e70
Git Branch: heads/refs/tags/v7.5.1
UTC Build Time: 2024-02-27 14:28:32
GoVersion: go1.21.6
Race Enabled: false
Check Table Before Drop: false
Store: tikv
```",https://github.com/pingcap/tidb/issues/53966,pingcap/tidb,2024-06-12 09:27:57+00:00,2024-12-31 10:18:35+00:00,2024-12-31 10:18:35+00:00,closed,"['type/bug', 'sig/planner', 'component/statistics', 'severity/major', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1', 'affects-8.5']",Incorrect Query Result
unexpected restart of tidb-server,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
No reproduce step

### 2. What did you expect to see? (Required)
No restart


### 3. What did you see instead (Required)
On March 19 and June 3, there were abnormal restarts of a tidb-server on different physical machines within the same user cluster. The business load was normal, and there were no anomalies in the tidb.log file. However, some abnormal information can be seen in the tidb_err.log file. A portion of the tidb_err.log is provided below, with the full file available in the  [attached document](https://github.com/user-attachments/files/15799370/tidb_stderr.log). This cluster uses ARM architecture machines, but out of the hundreds of ARM-based TiDB clusters the user has, only this particular cluster has experienced restarts.

``` log
runtime: traceback stuck. pc=0x3973c50 sp=0x426e7d9fb0
stack: frame={sp:0x426e7d9fb0, fp:0x426e7d9fb0} stack=[0x426e7d6000,0x426e7da000)
0x000000426e7d9eb0:  0x0001000000000001  0x000000419b6fefb0 
0x000000426e7d9ec0:  0x00000042931231b8  0x0000000004c76e60 
0x000000426e7d9ed0:  0x000000419b6fefb0  0x000000410b379f18 
0x000000426e7d9ee0:  0x0000000001d1d0f0 <google.golang.org/grpc/internal/transport.(*loopyWriter).run+0x0000000000000060>  0x00000041d76d6540 
0x000000426e7d9ef0:  0x0000000000000000  0x00000041d76d6720 
0x000000426e7d9f00:  0x0000000000000000  0x0000000000000001 
0x000000426e7d9f10:  0x0000000001d261d4 <google.golang.org/grpc/internal/transport.newHTTP2Client.func3+0x0000000000000064>  0x000000419b6fefa0 
0x000000426e7d9f20:  0x0000000003f7cc01  0x00000042931231b8 
0x000000426e7d9f30:  0x0000000003973c1c <github.com/pingcap/tidb/executor.(*IndexLookUpExecutor).startTableWorker.func1+0x00000000000000bc>  0x010000415dc8ebd0 
0x000000426e7d9f40:  0x0000000000000000  0x0000000000000000 
0x000000426e7d9f50:  0x0000000001d1d330 <google.golang.org/grpc/internal/transport.(*loopyWriter).run.func1+0x0000000000000000>  0x000000426e7d9f40 
0x000000426e7d9f60:  0x000000426e7d9f50  0x0000000000000000 
0x000000426e7d9f70:  0x000000000187de34 <runtime.goexit+0x0000000000000004>  0x000000422bf8ad80 
0x000000426e7d9f80:  0x000000415dc8eb80  0x000000419b6fefa0 
0x000000426e7d9f90:  0x0000000000000000  0x0000004027712000 
0x000000426e7d9fa0:  0x00000041904ec4c0  0x000000402efd8460 
0x000000426e7d9fb0: >0x0000000003973c50 <github.com/pingcap/tidb/executor.(*IndexLookUpExecutor).startTableWorker.func1.1+0x0000000000000000>  0x00000042482f6000 
0x000000426e7d9fc0:  0x000000405ad3afb0  0x0000000000000000 
0x000000426e7d9fd0:  0x0000000000000000  0x0000000000000000 
0x000000426e7d9fe0:  0x0000000000000000  0x0000000000000000 
0x000000426e7d9ff0:  0x0000000000000000  0x0000000000000000 
fatal error: traceback stuck

goroutine 0 [idle]:
runtime.throw({0x453213d?, 0x6ab0800?})
	/usr/local/go/src/runtime/panic.go:1047 +0x40 fp=0x400062c5e0 sp=0x400062c5b0 pc=0x1847df0
runtime.gentraceback(0x71b3f20?, 0x0?, 0x400062c9a8?, 0x40000ccea0, 0x0, 0x400062c9a8, 0x40, 0x0, 0x0?, 0x6)
	/usr/local/go/src/runtime/traceback.go:499 +0xeb4 fp=0x400062c940 sp=0x400062c5e0 pc=0x1870004
runtime.sigprof(0x182eaec, 0x400062cc48?, 0x0?, 0x40000ccea0, 0x4000100c00)
	/usr/local/go/src/runtime/proc.go:4577 +0xe8 fp=0x400062cbb0 sp=0x400062c940 pc=0x1854608
runtime.sighandler(0x1b?, 0x4000100c00?, 0x400062cc98?, 0x40000ccea0?)
	/usr/local/go/src/runtime/signal_unix.go:629 +0x590 fp=0x400062cc60 sp=0x400062cbb0 pc=0x185fb70
runtime.sigtrampgo(0x1b, 0x400062cda0, 0x400062ce20)
	/usr/local/go/src/runtime/signal_unix.go:479 +0x164 fp=0x400062cce0 sp=0x400062cc60 pc=0x185f1e4
runtime.sigtramp()
	/usr/local/go/src/runtime/sys_linux_arm64.s:471 +0x58 fp=0x400062cda0 sp=0x400062cce0 pc=0x187f098
```




### 4. What is your TiDB version? (Required)
v6.5.2",https://github.com/pingcap/tidb/issues/53958,pingcap/tidb,2024-06-12 06:28:48+00:00,2024-12-03 03:56:05+00:00,,open,"['type/bug', 'severity/major', 'sig/diagnosis', 'may-affects-5.4', 'may-affects-6.1', 'affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1', 'report/customer', 'impact/crash', 'affects-8.5']",Crash / Segmentation Fault
The REGION_SIZE in the TIKV_STORE_STATUS table is incorrect,"## Bug Report
![image](https://github.com/pingcap/tidb/assets/81623565/328bf06b-d37d-4302-8d7f-18be59160844)
TIKV_STORE_STATUS 表中显示REGION_SIZE：1107349（MB）, 也就是1107GB, 
而实际磁盘占用为：
![image](https://github.com/pingcap/tidb/assets/81623565/43c6c22a-1b4e-4b64-8df1-3b26611bf13b)
210GB - 71GB(space_placeholder_file) = 130+GB

Grafana显示为140GB
![image](https://github.com/pingcap/tidb/assets/81623565/83192d5d-3b72-41b3-ab22-f09d4dc035ab)

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)
7.5.1

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53957,pingcap/tidb,2024-06-12 06:28:26+00:00,2024-09-04 07:32:44+00:00,,open,"['type/bug', 'component/tikv', 'severity/moderate']",Data Corruption
projection containing virtual columns should be evaluated before the UnionScan(dirty write content),"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
```
CREATE TABLE `gholla_dummy1` (
  `id` varchar(10) NOT NULL,
  `mark` int,
  `deleted_at` datetime(3) NOT NULL DEFAULT '1970-01-01 01:00:01.000',
  `account_id` varchar(10) NOT NULL,
  `metastore_id` varchar(10) NOT NULL,
  `is_deleted` tinyint(1) GENERATED ALWAYS AS ((`deleted_at` > _utf8mb4'1970-01-01 01:00:01.000')) VIRTUAL NOT NULL,
  PRIMARY KEY (`account_id`,`metastore_id`,`id`),
  KEY `isDeleted_accountId_metastoreId` (`is_deleted`,`account_id`,`metastore_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;

CREATE TABLE `gholla_dummy2` (
  `id` varchar(10) NOT NULL,
  `mark` int,
  `deleted_at` datetime(3) NOT NULL DEFAULT '1970-01-01 01:00:01.000',
  `account_id` varchar(10) NOT NULL,
  `metastore_id` varchar(10) NOT NULL,
  `is_deleted` tinyint(1) GENERATED ALWAYS AS ((`deleted_at` > _utf8mb4'1970-01-01 01:00:01.000')) VIRTUAL NOT NULL,
  PRIMARY KEY (`account_id`,`metastore_id`,`id`),
  KEY `isDeleted_accountId_metastoreId` (`is_deleted`,`account_id`,`metastore_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin; 

INSERT INTO gholla_dummy1 (id,mark,deleted_at,account_id,metastore_id) VALUES ('ABC', 1, '1970-01-01 01:00:01.000', 'ABC', 'ABC');

INSERT INTO gholla_dummy2 (id,mark,deleted_at,account_id,metastore_id) VALUES ('ABC', 1, '1970-01-01 01:00:01.000', 'ABC', 'ABC');

start transaction;
update gholla_dummy2 set deleted_at = NOW(), mark=2 where account_id = 'ABC' and metastore_id = 'ABC' and id = 'ABC';
select
  /*+ INL_JOIN(g1, g2) */
  g1.account_id,
  g2.mark
from
  gholla_dummy1 g1 FORCE INDEX(isDeleted_accountId_metastoreId) 
STRAIGHT_JOIN
  gholla_dummy2 g2 FORCE INDEX (PRIMARY)
ON
  g1.account_id = g2.account_id AND
  g1.metastore_id = g2.metastore_id AND
  g1.id = g2.id
WHERE
  g1.account_id = 'ABC' AND
  g1.metastore_id = 'ABC' AND
  g1.is_deleted = FALSE AND
  g2.is_deleted = FALSE;
```

### 2. What did you expect to see? (Required)
No result was returned because we updated `is_deleted` in the transaction.

### 3. What did you see instead (Required)
```
tidb> select
    ->   /*+ INL_JOIN(g1, g2) */
    ->   g1.account_id,
    ->   g2.mark
    -> from
    ->   gholla_dummy1 g1 FORCE INDEX(isDeleted_accountId_metastoreId)
    -> STRAIGHT_JOIN
    ->   gholla_dummy2 g2 FORCE INDEX (PRIMARY)
    -> ON
    ->   g1.account_id = g2.account_id AND
    ->   g1.metastore_id = g2.metastore_id AND
    ->   g1.id = g2.id
    -> WHERE
    ->   g1.account_id = 'ABC' AND
    ->   g1.metastore_id = 'ABC' AND
    ->   g1.is_deleted = FALSE AND
    ->   g2.is_deleted = FALSE;
+------------+------+
| account_id | mark |
+------------+------+
| ABC        |    1 |
+------------+------+
1 row in set (0.01 sec)
```
The update in the transaction was not read.

### 4. What is your TiDB version? (Required)
It exists in all versions of TiDB.",https://github.com/pingcap/tidb/issues/53951,pingcap/tidb,2024-06-11 23:48:15+00:00,2024-06-21 07:10:35+00:00,2024-06-13 18:43:56+00:00,closed,"['type/bug', 'sig/planner', 'severity/critical', 'affects-5.4', 'affects-6.1', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1', 'report/customer', 'impact/wrong-result']",Transaction Anomaly
Bit shift for BLOB type behaves incosistently with MySQL8,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
init db
```sql
create table t2(a blob);
create table t3(a blob);
insert into t2 values(0xC2A0);
insert into t3 values(0xC2);
select * from t2,t3 where t2.a like concat(""%"",t3.a,""%"");
```

Then running:
```sql
select * from t2,t3 where (t2.a >> 4) = t3.a;
select * from t2,t3 where (t2.a >> 8) = t3.a;
```

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)
MySQL8.0.33 shows empty set for each query.
```sql
Empty set (0.01 sec)
Empty set (0.01 sec)
```

### 3. What did you see instead (Required)

TiDB 8.1 shows one row with warning.
```sql
+------+------+
| a    | a    |
+------+------+
|      | �     |
+------+------+
1 row in set, 2 warnings (0.00 sec)
+------+------+
| a    | a    |
+------+------+
|      | �     |
+------+------+
1 row in set, 2 warnings (0.01 sec)
> show warnings;
+---------+------+---------------------------------------+
| Level   | Code | Message                               |
+---------+------+---------------------------------------+
| Warning | 1292 | Truncated incorrect INTEGER value: '' |
| Warning | 1292 | Truncated incorrect DOUBLE value: '�'  |
+---------+------+---------------------------------------+
```

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
```sql
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| tidb_version()
                                               |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Release Version: v8.1.0
Edition: Community
Git Commit Hash: 945d07c5d5c7a1ae212f6013adfb187f2de24b23
Git Branch: HEAD
UTC Build Time: 2024-05-21 03:51:57
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)
```",https://github.com/pingcap/tidb/issues/53943,pingcap/tidb,2024-06-11 11:55:09+00:00,2024-10-21 09:28:44+00:00,,open,"['type/bug', 'sig/execution', 'severity/moderate', 'compatibility-mysql80', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1', 'impact/wrong-result']",Incorrect Query Result
`select for update` can't work with global index,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

```sql
create table t(a int, b int, unique index(b), primary key(a)) partition by hash(a) partitions 5;
insert into t values (1,1),(2,2),(3,3),(4,4),(5,5);
begin;
select * from t use index(b) where b = 2 order by b limit 1 for update;

-- create another session
update t set b = 7 where b = 2;
```

### 2. What did you expect to see? (Required)

update blocked

### 3. What did you see instead (Required)

update success

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53929,pingcap/tidb,2024-06-11 09:02:53+00:00,2024-06-18 09:58:26+00:00,2024-06-18 09:58:25+00:00,closed,"['type/bug', 'sig/sql-infra', 'severity/major', 'component/tablepartition', 'feature/developing']",Concurrency Issue
Char data type expression is not compatible with MYSQL 8.0,"## Bug Report
May I ask why the expression ' 'reports an error, however the expression ! ' ' is right ?
It is not compatible with MYSQL 8.0.
Thank for your reply.
Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
```SQL
CREATE TABLE t0(c0 BLOB , c1 FLOAT UNIQUE );
INSERT INTO t0(c0, c1) VALUES ('abc', 0.123);
INSERT INTO t0(c0, c1) VALUES ('efg', 0.456);

UPDATE t0 SET c0='xyz' WHERE ' ';
UPDATE t0 SET c0='xyz' WHERE !' ';
```
### 2. What did you expect to see? (Required)
In MySQL
```SQL
mysql> UPDATE t0 SET c0='xyz' WHERE ' ';
Query OK, 0 rows affected (0.01 sec)
Rows matched: 0  Changed: 0  Warnings: 0

mysql> UPDATE t0 SET c0='xyz' WHERE !' ';
Query OK, 2 rows affected, 1 warning (0.02 sec)
Rows matched: 2  Changed: 2  Warnings: 1
```
### 3. What did you see instead (Required)
```SQL
mysql> UPDATE t0 SET c0='xyz' WHERE ' ';
ERROR 1292 (22007): Truncated incorrect DOUBLE value: ''
mysql> UPDATE t0 SET c0='xyz' WHERE !' ';
Query OK, 2 rows affected (0.01 sec)
Rows matched: 2  Changed: 2  Warnings: 0
```
### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
Release Version: v8.1.0
Edition: Community
Git Commit Hash: 945d07c5d5c7a1ae212f6013adfb187f2de24b23
Git Branch: HEAD
UTC Build Time: 2024-05-21 03:51:57
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv",https://github.com/pingcap/tidb/issues/53927,pingcap/tidb,2024-06-11 07:58:19+00:00,2024-06-14 07:17:18+00:00,,open,"['type/bug', 'sig/execution', 'severity/moderate', 'compatibility-mysql80']",SQL Syntax / Parsing Error
br backup blocked when injection pdleader network latency,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
1、run br backup
2、inject pdleader network_latency
3、br backup blocked and can not finish

### 2. What did you expect to see? (Required)
br backup can success

### 3. What did you see instead (Required)
br backup blocked

### 4. What is your TiDB version? (Required)
./tidb-server -V
 Release Version: v8.2.0-alpha
Edition: Community
Git Commit Hash: a865c866ebd6027bdecac113b4caf76b44f7151d
Git Branch: heads/refs/tags/v8.2.0-alpha
UTC Build Time: 2024-06-06 11:50:04
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false",https://github.com/pingcap/tidb/issues/53926,pingcap/tidb,2024-06-11 07:54:35+00:00,2024-06-19 10:48:13+00:00,2024-06-17 05:41:47+00:00,closed,"['type/bug', 'severity/critical', 'component/br', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1']",Deadlock
TestPauseCancelAndRerunPartitionTableStmt spend too much time,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

```

panic: test timed out after 5m0s
running tests:
	TestPauseCancelAndRerunPartitionTableStmt (5m0s) 
```


https://tiprow.hawkingrei.com/view/gs/pingcapprow/pr-logs/pull/pingcap_tidb/53897/fast_test_tiprow/1800406545276604416#1:build-log.txt%3A3360
### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53925,pingcap/tidb,2024-06-11 07:51:52+00:00,2024-06-11 08:46:54+00:00,2024-06-11 08:46:54+00:00,closed,['type/bug'],Performance Degradation
Analyze is blocked long time when execute ddl in mounts of tables scenario,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
1. prepare millions tables
2. create table/database and analyze table currently
https://github.com/pingcap/tidb/blame/master/pkg/statistics/handle/util/table_info.go#L47C31-L47C44 will lock long time
![image](https://github.com/pingcap/tidb/assets/7677963/8de55bae-3dcc-4e92-87b5-bf82a3365a2f)

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
Release Version: v8.2.0-alpha
Edition: Community
Git Commit Hash: 9c1a45ab46b0fdc228dd636e3ba00f0c38547272
Git Branch: heads/refs/tags/v8.2.0-alpha
UTC Build Time: 2024-06-04 11:48:16
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv",https://github.com/pingcap/tidb/issues/53915,pingcap/tidb,2024-06-11 03:31:54+00:00,2024-06-27 08:55:50+00:00,2024-06-27 08:55:49+00:00,closed,"['type/bug', 'sig/planner', 'severity/major', 'feature/developing', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1']",Infinite Loop / Hang
admin check failed with “Error 8223 (HY000): data inconsistency in table” after tidb rolling restart during adding index,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
1、tidb_enable_dist_task='on'
2、run sysbench
3、add index for one of table
4、tidb rolling restart
5、admin check index when adding index finish

### 2. What did you expect to see? (Required)
admin check success

### 3. What did you see instead (Required)
admin check failed with “Error 8223 (HY000): data inconsistency in table” after tidb rolling restart during adding index

operator logs：

admin check failed (Error 8223 (HY000): data inconsistency in table: sbtest5, index: index_test_1718052600990, handle: 35905355, index-values:"""" != record-values:""handle: 35905355, values: [KindString 38761834057-51189930219-13436187456-78745883518-32558835324-50564221187-36700127441-77553179797-78566774399-28838186753]"")
operatorLogs:
[2024-06-11 04:50:00] ###### start adding index
ALTER TABLE `sbtest5` ADD INDEX `index_test_1718052600990`(`c`)
[2024-06-11 04:50:00] ###### wait for ddl job finish
[2024-06-11 04:52:31] ###### ddl job finished
select job_id, job_type, state from information_schema.ddl_jobs where query = 'ALTER TABLE `sbtest5` ADD INDEX `index_test_1718052600990`(`c`)'
jobId: 597, job type: add index /* ingest */, state: synced
add index done, it takes: 2m30.304123625s
[2024-06-11 04:52:31] ###### start admin check
admin check index sbtest5 index_test_1718052600990

### 4. What is your TiDB version? (Required)
./tidb-server -V
 Release Version: v8.2.0-alpha
Edition: Community
Git Commit Hash: 5c0d73719b10f98ad198afb90e7a1f21e3ff4c24
Git Branch: heads/refs/tags/v8.2.0-alpha
UTC Build Time: 2024-06-09 11:44:25
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: unistore
2024-06-11T05:26:05.590+0800",https://github.com/pingcap/tidb/issues/53910,pingcap/tidb,2024-06-11 01:37:53+00:00,2024-08-05 04:49:29+00:00,2024-06-26 06:24:07+00:00,closed,"['type/bug', 'severity/critical', 'component/ddl', 'affects-8.2']",Data Corruption
add index blocked after injection network partition between pd leader and all other pods,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
tidb_enable_dist_task='off'
1、run sysbench
2、add index for one of table
3、inject network partition between pd leader and all other pods

tidb logs:
[tidb-0-2024-06-09T22-21-12.334.log.tar.gz](https://github.com/user-attachments/files/15780801/tidb-0-2024-06-09T22-21-12.334.log.tar.gz)
[tidb-1-2024-06-09T22-09-07.701.log.tar.gz](https://github.com/user-attachments/files/15780841/tidb-1-2024-06-09T22-09-07.701.log.tar.gz)


### 2. What did you expect to see? (Required)
add index can success

### 3. What did you see instead (Required)
add index blocked after injection network partition between pd leader and all other pods

operator logs：
the status of ddl job is not synced after 1h0m0s (now: 2024-06-09 12:39:47, jobId: 491, job type: add index /* ingest */, state: running)
operatorLogs:
[2024-06-09 11:39:29] ###### start adding index
ALTER TABLE `sbtest1` ADD INDEX `index_test_1717904369842`(`c`)
[2024-06-09 11:39:29] ###### wait for ddl job finish
[2024-06-09 12:39:47] ###### wait for ddl job finish timeout(1h0m0s)
select job_id, job_type, state from information_schema.ddl_jobs where query = 'ALTER TABLE `sbtest1` ADD INDEX `index_test_1717904369842`(`c`)'
jobId: 491, job type: add index /* ingest */, state: running

### 4. What is your TiDB version? (Required)
./tidb-server -V
 Release Version: v8.2.0-alpha
Edition: Community
Git Commit Hash: d75ff829f2b28df771ce66a96e10fd031d156b5a
Git Branch: heads/refs/tags/v8.2.0-alpha
UTC Build Time: 2024-06-08 11:46:12
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: unistore
2024-06-09T11:28:46.842+0800",https://github.com/pingcap/tidb/issues/53909,pingcap/tidb,2024-06-11 01:07:31+00:00,2024-08-05 04:50:15+00:00,2024-06-26 06:20:53+00:00,closed,"['type/bug', 'severity/major', 'component/ddl', 'affects-8.1', 'affects-8.2']",Deadlock
Inconsistent type conversions in update and select statements,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
<!-- a step by step guide for reproducing the bug. -->
```SQL
--- ini ---
CREATE TABLE t0(c0 TEXT , c1 DECIMAL , c2 BLOB );
INSERT INTO t0 VALUES ('zeGTVmzYyL', -10723, 'zeGTVmzYyL');
INSERT INTO t0(c2, c1, c0) VALUES ('m6MkaimUzq', -10811, 'm6MkaimUzq');
INSERT IGNORE  INTO t0(c0) VALUES ('u3pHrhF5LF');

--- select ---
SELECT * FROM t0 WHERE ((435600036)>=('-'));

--- update ---
UPDATE t0 SET c0='e9pvumJh2h', c1=3268, c2='e9pvumJh2h' WHERE ((435600036)>=('-'));
```

### 2. What did you expect to see? (Required)
In Mariadb
```SQL
mysql> SELECT * FROM t0 WHERE ((435600036)>=('-'));
+------------+--------+------------+
| c0         | c1     | c2         |
+------------+--------+------------+
| zeGTVmzYyL | -10723 | zeGTVmzYyL |
| m6MkaimUzq | -10811 | m6MkaimUzq |
| u3pHrhF5LF |   NULL | NULL       |
+------------+--------+------------+
3 rows in set, 1 warning (0.00 sec)

mysql> UPDATE t0 SET c0='e9pvumJh2h', c1=3268, c2='e9pvumJh2h' WHERE ((435600036)>=('-'));
Query OK, 3 rows affected, 1 warning (0.00 sec)
Rows matched: 3  Changed: 3  Warnings: 1

mysql> SELECT * FROM t0 WHERE ((435600036)>=('-'));
+------------+------+------------+
| c0         | c1   | c2         |
+------------+------+------------+
| e9pvumJh2h | 3268 | e9pvumJh2h |
| e9pvumJh2h | 3268 | e9pvumJh2h |
| e9pvumJh2h | 3268 | e9pvumJh2h |
+------------+------+------------+
3 rows in set, 1 warning (0.00 sec)
```
But in MySQL also error
```SQL
mysql> SELECT * FROM t0 WHERE ((435600036)>=('-'));
+------------+--------+------------+
| c0         | c1     | c2         |
+------------+--------+------------+
| zeGTVmzYyL | -10723 | zeGTVmzYyL |
| m6MkaimUzq | -10811 | m6MkaimUzq |
| u3pHrhF5LF |   NULL | NULL       |
+------------+--------+------------+
3 rows in set, 1 warning (0.00 sec)

mysql> UPDATE t0 SET c0='e9pvumJh2h', c1=3268, c2='e9pvumJh2h' WHERE ((435600036)>=('-'));
ERROR 1292 (22007): Truncated incorrect DOUBLE value: '-'
```
### 3. What did you see instead (Required)
```
mysql> SELECT * FROM t0 WHERE ((435600036)>=('-'));
+------------+--------+------------+
| c0         | c1     | c2         |
+------------+--------+------------+
| zeGTVmzYyL | -10723 | zeGTVmzYyL |
| m6MkaimUzq | -10811 | m6MkaimUzq |
| u3pHrhF5LF |   NULL | NULL       |
+------------+--------+------------+
3 rows in set, 1 warning (0.00 sec)

mysql> UPDATE t0 SET c0='e9pvumJh2h', c1=3268, c2='e9pvumJh2h' WHERE ((435600036)>=('-'));
ERROR 1292 (22007): Truncated incorrect INTEGER value: '-'
```
### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
Release Version: v8.1.0
Edition: Community
Git Commit Hash: 945d07c5d5c7a1ae212f6013adfb187f2de24b23
Git Branch: HEAD
UTC Build Time: 2024-05-21 03:51:57
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv

Looking forward to your reply and Thank you!",https://github.com/pingcap/tidb/issues/53904,pingcap/tidb,2024-06-10 12:49:35+00:00,2024-06-11 05:01:28+00:00,2024-06-11 05:01:27+00:00,closed,"['type/bug', 'sig/execution', 'severity/major', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1', 'impact/inconsistency']",Data Corruption
flaky test TestTiDBTrx,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

```
     result.go:49: 
        	Error Trace:	pkg/testkit/result.go:49
        	            				pkg/infoschema/test/clustertablestest/tables_test.go:1232
        	Error:      	Not equal: 
        	            	expected: ""[LockWaiting]\n[Idle]\n""
        	            	actual  : ""[Idle]\n[LockWaiting]\n""
        	            	
        	            	Diff:
        	            	--- Expected
        	            	+++ Actual
        	            	@@ -1,3 +1,3 @@
        	            	+[Idle]
        	            	 [LockWaiting]
        	            	-[Idle]
        	            	 
        	Test:       	TestTiDBTrx
        	Messages:   	sql:select state from information_schema.tidb_trx as trx  union select state from information_schema.tidb_trx as trx, args:[]
```

https://tiprow.hawkingrei.com/view/gs/pingcapprow/pr-logs/pull/pingcap_tidb/53899/fast_test_tiprow/1799973138344185856#1:build-log.txt%3A2367
### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53901,pingcap/tidb,2024-06-10 01:42:14+00:00,2024-06-12 03:22:30+00:00,2024-06-12 03:22:30+00:00,closed,"['type/bug', 'component/test', 'sig/transaction', 'severity/major']",Transaction Anomaly
Query produces different results after disabling some optimization rules,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
```sql

CREATE TABLE t1(c0 SMALLINT );
CREATE TABLE t4(c0 BIGINT DEFAULT 1383675574 , c2 BLOB(55) ) ;

INSERT IGNORE  INTO t4 VALUES (NULL, '') ON DUPLICATE KEY UPDATE c0=t4.c2;

INSERT IGNORE  INTO t4(c2) VALUES ('MZ');

delete from mysql.opt_rule_blacklist;
 admin reload opt_rule_blacklist;
SELECT t4.c2, t4.c0 FROM  t1 NATURAL RIGHT JOIN t4 WHERE t4.c0;
INSERT INTO mysql.opt_rule_blacklist VALUES(""predicate_push_down""),(""column_prune""),(""projection_eliminate"");
ADMIN reload opt_rule_blacklist;
SELECT t4.c2, t4.c0 FROM  t1 NATURAL RIGHT JOIN t4 WHERE t4.c0;

```

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)
Two queries produce same results.

### 3. What did you see instead (Required)
```sql
MySQL [d0]> delete from mysql.opt_rule_blacklist;
Query OK, 0 rows affected (0.03 sec)

MySQL [d0]>  admin reload opt_rule_blacklist;
Query OK, 0 rows affected (0.03 sec)

MySQL [d0]> SELECT t4.c2, t4.c0 FROM  t1 NATURAL RIGHT JOIN t4 WHERE t4.c0;
+------+------------+
| c2   | c0         |
+------+------------+
| MZ   | 1383675574 |
+------+------------+
1 row in set (0.01 sec)

MySQL [d0]> INSERT INTO mysql.opt_rule_blacklist VALUES(""predicate_push_down""),(""column_prune""),(""projection_eliminate"");
Query OK, 3 rows affected (0.02 sec)
Records: 3  Duplicates: 0  Warnings: 0

MySQL [d0]> ADMIN reload opt_rule_blacklist;
Query OK, 0 rows affected (0.04 sec)

MySQL [d0]> SELECT t4.c2, t4.c0 FROM  t1 NATURAL RIGHT JOIN t4 WHERE t4.c0;
Empty set (0.00 sec)
```

### 4. What is your TiDB version? (Required)
release version 8.0.0",https://github.com/pingcap/tidb/issues/53900,pingcap/tidb,2024-06-09 18:23:59+00:00,2024-11-11 05:50:24+00:00,,open,"['type/bug', 'sig/planner', 'severity/moderate', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1', 'impact/wrong-result']",Incorrect Query Result
TiKV and TiFlash behave differently when using `right` function with negative number and type conversion,"### 1. Minimal reproduce step (Required)
```sql
create table t1 (c1 text, c2 int);
alter table t1 set tiflash replica 1;
insert into t1 (c1,c2) values ('k5tis', -65), ('x', 1), ('jp2hmweyyb', 1);

select /*+ read_from_storage(tiflash[t1]) */ right(c1 , cast(c2 as unsigned)) from t1;
```
### 2. What did you expect to see? (Required)
```
mysql> select /*+ read_from_storage(tikv[t1]) */ right(c1 , cast(c2 as unsigned)) from t1;
+----------------------------------+
| right(c1 , cast(c2 as unsigned)) |
+----------------------------------+
|                                  |
| x                                |
| b                                |
+----------------------------------+
3 rows in set (0.00 sec)

mysql> select right('abcde', cast(-65 as unsigned));
+---------------------------------------+
| right('abcde', cast(-65 as unsigned)) |
+---------------------------------------+
|                                       |
+---------------------------------------+
1 row in set (0.00 sec)
```

### 3. What did you see instead (Required)
```
mysql> select /*+ read_from_storage(tiflash[t1]) */ right(c1 , cast(c2 as unsigned)) from t1;
+----------------------------------+
| right(c1 , cast(c2 as unsigned)) |
+----------------------------------+
| k5tis                            |
| x                                |
| b                                |
+----------------------------------+
3 rows in set (0.01 sec)
```


### 4. What is your TiDB version? (Required)
```
Release Version: v8.2.0-alpha-292-g7629a0d
Edition: Community
Git Commit Hash: 7629a0d68595c4d11c25fc059208f3efd838c2c1
Git Branch: HEAD
UTC Build Time: 2024-06-04 03:27:25
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv
```
topology:

distributed.yaml:
```
global:
  user: ""tidb""
  ssh_port: 22
  deploy_dir: ""/tidb-deploy""
  data_dir: ""/tidb-data""

pd_servers:
  - host: 10.0.2.31

tidb_servers:
  - host: 10.0.2.21

tikv_servers:
  - host: 10.0.2.11
  - host: 10.0.2.12
  - host: 10.0.2.13

monitoring_servers:
  - host: 10.0.2.8

grafana_servers:
  - host: 10.0.2.8

alertmanager_servers:
  - host: 10.0.2.8

tiflash_servers:
  - host: 10.0.2.32
```



### about us
We are the BASS team from the School of Cyber Science and Technology at Beihang University. Our main focus is on system software security, operating systems, and program analysis research, as well as the development of automated program testing frameworks for detecting software defects. Using our self-developed database vulnerability testing tool, we have identified the above-mentioned vulnerabilities in TiDB that may lead to database logic error.",https://github.com/pingcap/tidb/issues/53894,pingcap/tidb,2024-06-08 09:13:46+00:00,2024-10-21 09:30:08+00:00,,open,"['type/bug', 'sig/execution', 'severity/moderate', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1', 'impact/wrong-result']",Incorrect Query Result
TiKV and TiFlash behave differently when performing type conversion,"### 1. Minimal reproduce step (Required)
```sql
create table t1 ( 
c_k int unique ,
primary key(c_k) CLUSTERED);

alter table t1 set tiflash replica 1;

insert into t1 (c_k) values (-3),  (-10), (-1776762042),  (25);

SELECT /*+ read_from_storage(tiflash[t1]) */ c_k as c3, cast(c_k | c_k as char),cast(cast(c_k | c_k as char) as signed) FROM t1;
```

### 2. What did you expect to see? (Required)
```
mysql> SELECT /*+ read_from_storage(tikv[t1])    */ c_k as c3, cast(c_k | c_k as char),cast(cast(c_k | c_k as char) as signed) FROM t1;
+-------------+-------------------------+-----------------------------------------+
| c3          | cast(c_k | c_k as char) | cast(cast(c_k | c_k as char) as signed) |
+-------------+-------------------------+-----------------------------------------+
| -1776762042 | 18446744071932789574    |                             -1776762042 |
|         -10 | 18446744073709551606    |                                     -10 |
|          -3 | 18446744073709551613    |                                      -3 |
|          25 | 25                      |                                      25 |
+-------------+-------------------------+-----------------------------------------+
4 rows in set, 3 warnings (0.01 sec)
mysql> show warnings;
+---------+------+-----------------------------------------------------------------------------------+
| Level   | Code | Message                                                                           |
+---------+------+-----------------------------------------------------------------------------------+
| Warning | 8030 | Cast to signed converted positive out-of-range integer to its negative complement |
| Warning | 8030 | Cast to signed converted positive out-of-range integer to its negative complement |
| Warning | 8030 | Cast to signed converted positive out-of-range integer to its negative complement |
+---------+------+-----------------------------------------------------------------------------------+
3 rows in set (0.01 sec)
```

### 3. What did you see instead (Required)
```
mysql> SELECT /*+ read_from_storage(tiflash[t1]) */ c_k as c3, cast(c_k | c_k as char),cast(cast(c_k | c_k as char) as signed) FROM t1;
+-------------+-------------------------+-----------------------------------------+
| c3          | cast(c_k | c_k as char) | cast(cast(c_k | c_k as char) as signed) |
+-------------+-------------------------+-----------------------------------------+
| -1776762042 | 18446744071932789574    |                     9223372036854775807 |
|         -10 | 18446744073709551606    |                     9223372036854775807 |
|          -3 | 18446744073709551613    |                     9223372036854775807 |
|          25 | 25                      |                                      25 |
+-------------+-------------------------+-----------------------------------------+
4 rows in set (0.00 sec)
```


### 4. What is your TiDB version? (Required)
```
Release Version: v8.2.0-alpha-292-g7629a0d
Edition: Community
Git Commit Hash: 7629a0d68595c4d11c25fc059208f3efd838c2c1
Git Branch: HEAD
UTC Build Time: 2024-06-04 03:27:25
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv
```
topology:

distributed.yaml:
```
global:
  user: ""tidb""
  ssh_port: 22
  deploy_dir: ""/tidb-deploy""
  data_dir: ""/tidb-data""

pd_servers:
  - host: 10.0.2.31

tidb_servers:
  - host: 10.0.2.21

tikv_servers:
  - host: 10.0.2.11
  - host: 10.0.2.12
  - host: 10.0.2.13

monitoring_servers:
  - host: 10.0.2.8

grafana_servers:
  - host: 10.0.2.8

alertmanager_servers:
  - host: 10.0.2.8

tiflash_servers:
  - host: 10.0.2.32
```



### about us
We are the BASS team from the School of Cyber Science and Technology at Beihang University. Our main focus is on system software security, operating systems, and program analysis research, as well as the development of automated program testing frameworks for detecting software defects. Using our self-developed database vulnerability testing tool, we have identified the above-mentioned vulnerabilities in TiDB that may lead to database logic error.",https://github.com/pingcap/tidb/issues/53893,pingcap/tidb,2024-06-08 09:09:07+00:00,2024-06-11 09:09:09+00:00,,open,"['type/bug', 'sig/execution', 'severity/moderate', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1', 'impact/wrong-result']",Incorrect Query Result
TiKV and TiFlash behave differently when performing division.,"### 1. Minimal reproduce step (Required)
```sql
create table t1 ( 
c1 int not null ,
c2 int not null ,
primary key(c1) CLUSTERED);

alter table t1 set tiflash replica 1;

insert into t1 (c1,c2) values (1486109909, -1113200806);

SELECT /*+ read_from_storage(tiflash[t1]) */ c2, c1, cast( (c2 / cast(c1 as signed)) as decimal) as c2 FROM t1;
```

### 2. What did you expect to see? (Required)
```
mysql> SELECT /*+ read_from_storage(tikv[t1]) */ c2, c1, cast( (c2 / cast(c1 as signed)) as decimal) as c2 FROM t1;
+-------------+------------+------+
| c2          | c1         | c2   |
+-------------+------------+------+
| -1113200806 | 1486109909 |   -1 |
+-------------+------------+------+
1 row in set, 1 warning (0.00 sec)

mysql> show warnings;
+---------+------+----------------------------------------------+
| Level   | Code | Message                                      |
+---------+------+----------------------------------------------+
| Warning | 1292 | Truncated incorrect DECIMAL value: '-0.7491' |
+---------+------+----------------------------------------------+
1 row in set (0.00 sec)
```

### 3. What did you see instead (Required)
```
mysql> SELECT /*+ read_from_storage(tiflash[t1]) */ c2, c1, cast( (c2 / cast(c1 as signed)) as decimal) as c2 FROM t1;
+-------------+------------+------+
| c2          | c1         | c2   |
+-------------+------------+------+
| -1113200806 | 1486109909 |    1 |
+-------------+------------+------+
1 row in set (0.10 sec)
```


### 4. What is your TiDB version? (Required)
```
Release Version: v8.2.0-alpha-292-g7629a0d
Edition: Community
Git Commit Hash: 7629a0d68595c4d11c25fc059208f3efd838c2c1
Git Branch: HEAD
UTC Build Time: 2024-06-04 03:27:25
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv
```
topology:

distributed.yaml:
```
global:
  user: ""tidb""
  ssh_port: 22
  deploy_dir: ""/tidb-deploy""
  data_dir: ""/tidb-data""

pd_servers:
  - host: 10.0.2.31

tidb_servers:
  - host: 10.0.2.21

tikv_servers:
  - host: 10.0.2.11
  - host: 10.0.2.12
  - host: 10.0.2.13

monitoring_servers:
  - host: 10.0.2.8

grafana_servers:
  - host: 10.0.2.8

alertmanager_servers:
  - host: 10.0.2.8

tiflash_servers:
  - host: 10.0.2.32
```



### about us
We are the BASS team from the School of Cyber Science and Technology at Beihang University. Our main focus is on system software security, operating systems, and program analysis research, as well as the development of automated program testing frameworks for detecting software defects. Using our self-developed database vulnerability testing tool, we have identified the above-mentioned vulnerabilities in TiDB that may lead to database logic error.",https://github.com/pingcap/tidb/issues/53892,pingcap/tidb,2024-06-08 09:06:05+00:00,2024-09-03 07:20:27+00:00,2024-09-03 07:20:26+00:00,closed,"['type/bug', 'sig/execution', 'severity/major', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1', 'impact/wrong-result']",Incorrect Query Result
`round` function on exact number produces different result from MySQL,"### 1. Minimal reproduce step (Required)
```sql
select round(-717754013, 24);
```

### 2. What did you expect to see? (Required)
In MySQL:
```
mysql> select round(-717754013, 24);
+-----------------------+
| round(-717754013, 24) |
+-----------------------+
|            -717754013 |
+-----------------------+
1 row in set (0.00 sec)
```

### 3. What did you see instead (Required)
But TiDB output `-717754012`. And TiDB produces correct result `-717754013` sometimes.
```
mysql> select round(-717754013, 24);
+-----------------------+
| round(-717754013, 24) |
+-----------------------+
|            -717754012 |
+-----------------------+
1 row in set (0.00 sec)
```


### 4. What is your TiDB version? (Required)
```
Release Version: v8.2.0-alpha-292-g7629a0d
Edition: Community
Git Commit Hash: 7629a0d68595c4d11c25fc059208f3efd838c2c1
Git Branch: HEAD
UTC Build Time: 2024-06-04 03:27:25
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv
```
topology:

distributed.yaml:
```
global:
  user: ""tidb""
  ssh_port: 22
  deploy_dir: ""/tidb-deploy""
  data_dir: ""/tidb-data""

pd_servers:
  - host: 10.0.2.31

tidb_servers:
  - host: 10.0.2.21

tikv_servers:
  - host: 10.0.2.11
  - host: 10.0.2.12
  - host: 10.0.2.13

monitoring_servers:
  - host: 10.0.2.8

grafana_servers:
  - host: 10.0.2.8

alertmanager_servers:
  - host: 10.0.2.8

tiflash_servers:
  - host: 10.0.2.32
```



### about us
We are the BASS team from the School of Cyber Science and Technology at Beihang University. Our main focus is on system software security, operating systems, and program analysis research, as well as the development of automated program testing frameworks for detecting software defects. Using our self-developed database vulnerability testing tool, we have identified the above-mentioned vulnerabilities in TiDB that may lead to database logic error.",https://github.com/pingcap/tidb/issues/53891,pingcap/tidb,2024-06-08 09:01:38+00:00,2024-10-21 09:29:32+00:00,,open,"['type/bug', 'sig/execution', 'severity/moderate', 'compatibility-mysql80', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1', 'impact/wrong-result']",Incorrect Query Result
Param as column alias can't be parsed in group statement,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

```
create table test(id int, col int);
prepare stmt from ""select id, ? as col1 from test where col=? group by id,col1"";
set @a=100, @b=100;
execute stmt using @a,@b;
```
### 2. What did you expect to see? (Required)

No error

### 3. What did you see instead (Required)

ERROR 1105 (HY000): Unknown column '100' in 'group statement'

### 4. What is your TiDB version? (Required)

v8.1.0",https://github.com/pingcap/tidb/issues/53872,pingcap/tidb,2024-06-07 06:24:41+00:00,2024-06-28 09:03:51+00:00,2024-06-26 05:14:53+00:00,closed,"['type/bug', 'sig/planner', 'severity/moderate', 'affects-5.4', 'affects-6.1', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1', 'affects-8.2']",SQL Syntax / Parsing Error
Empty groupOffset in StreamAggExec causes panic,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

create database test;
use test;
source [valid.txt](https://github.com/user-attachments/files/15705116/valid.txt)
source [error.txt](https://github.com/user-attachments/files/15705189/error.txt)


### 2. What did you expect to see? (Required)

no panic

### 3. What did you see instead (Required)

We get panic: `ERROR 1105 (HY000): runtime error: index out of range [0] with length 0`

### 4. What is your TiDB version? (Required)

a865c866ebd6027bdecac113b

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53867,pingcap/tidb,2024-06-07 04:02:09+00:00,2024-08-27 10:27:21+00:00,2024-06-18 09:58:18+00:00,closed,"['type/bug', 'sig/execution', 'severity/major', 'affects-5.4', 'affects-6.1', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1', 'impact/panic']",Crash / Segmentation Fault
Query execution failed after disabling some optimization rules,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
```sql
INSERT INTO mysql.opt_rule_blacklist VALUES(""predicate_push_down""),(""column_prune""),(""partition_processor"");
ADMIN reload opt_rule_blacklist;
CREATE TABLE t0(c0 int)PARTITION BY RANGE(c0) (PARTITION p0 VALUES LESS THAN (1),PARTITION p1 VALUES LESS THAN MAXVALUE);
REPLACE HIGH_PRIORITY INTO t0 VALUES (NULL);
ALTER TABLE t0 ADD PRIMARY KEY(c0);
select t0.c0 from t0 where t0.c0;
```

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)
Query executed successfully.

### 3. What did you see instead (Required)
```sql
MySQL [d0]> select t0.c0 from t0 where t0.c0;
ERROR 1105 (HY000): [components/tidb_query_executors/src/table_scan_executor.rs:425]: Data is corrupted, missing data for NOT NULL column (offset = 0)
```
### 4. What is your TiDB version? (Required)
```sql
Release Version: v8.2.0-alpha-234-gdf64c343dd-dirty
Edition: Community
Git Commit Hash: df64c343ddfc4063891900acf95e2b3640c79f29
Git Branch: master
UTC Build Time: 2024-05-27 08:15:16
GoVersion: go1.21.7
Race Enabled: false
Check Table Before Drop: false
Store: tikv 
```

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53865,pingcap/tidb,2024-06-06 20:32:16+00:00,2024-11-18 11:55:36+00:00,2024-11-18 11:55:36+00:00,closed,"['type/bug', 'sig/sql-infra', 'severity/major']",Data Corruption
Inconsistent results after disabling partition_processor,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
```sql
insert into mysql.opt_rule_blacklist values(""partition_processor"");
admin reload opt_rule_blacklist;

CREATE TABLE t0(c0 BOOL UNSIGNED DEFAULT true UNIQUE )PARTITION BY RANGE(c0) (PARTITION p0 VALUES LESS THAN (0),\nPARTITION p1 VALUES LESS THAN (10),PARTITION p2 VALUES LESS THAN MAXVALUE);
CREATE TABLE t1(c0 BOOL UNSIGNED DEFAULT true UNIQUE );
REPLACE INTO t0(c0) VALUES (NULL);
REPLACE INTO t1(c0) VALUES (NULL);
ALTER TABLE t0 ADD PRIMARY KEY(c0);
ALTER TABLE t1 ADD PRIMARY KEY(c0);
INSERT IGNORE  INTO t0 VALUES (true), (NULL) ON DUPLICATE KEY UPDATE c0=2;
INSERT IGNORE  INTO t1 VALUES (true), (NULL) ON DUPLICATE KEY UPDATE c0=2;

SELECT t0.c0 FROM t0 WHERE DEFAULT(t0.c0);
SELECT t1.c0 FROM t1 WHERE DEFAULT(t1.c0);
```

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)
Two queries produce same results. 
### 3. What did you see instead (Required)
```sql
MySQL [d0]> SELECT t0.c0 FROM t0 WHERE DEFAULT(t0.c0);
+----+
| c0 |
+----+
| NULL |
|  0 |
|  1 |
+----+
3 rows in set (0.00 sec)

MySQL [d0]> SELECT t1.c0 FROM t1 WHERE DEFAULT(t1.c0);
+------+
| c0   |
+------+
| NULL |
| NULL |
|    1 |
+------+
3 rows in set (0.01 sec)

```

### 4. What is your TiDB version? (Required)
Release Version: v8.2.0-alpha-234-gdf64c343dd-dirty
Edition: Community
Git Commit Hash: df64c343ddfc4063891900acf95e2b3640c79f29
Git Branch: master
UTC Build Time: 2024-05-27 08:15:16
GoVersion: go1.21.7
Race Enabled: false
Check Table Before Drop: false
Store: tikv

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53864,pingcap/tidb,2024-06-06 19:00:48+00:00,2024-08-05 07:28:18+00:00,,open,"['type/bug', 'sig/sql-infra', 'severity/minor', 'component/tablepartition']",Incorrect Query Result
DATA RACE in the TestWriteMultiValuedIndex,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)
```
==================
WARNING: DATA RACE
Read at 0x00c002953548 by goroutine 40689:
  reflect.Value.Pointer()
      GOROOT/src/reflect/value.go:2182 +0x1a4
  github.com/pingcap/tidb/pkg/infoschema/internal.sizeOf()
      pkg/infoschema/internal/sizer.go:47 +0x6d3
  github.com/pingcap/tidb/pkg/infoschema/internal.sizeOf()
      pkg/infoschema/internal/sizer.go:64 +0xaa7
  github.com/pingcap/tidb/pkg/infoschema/internal.sizeOf()
      pkg/infoschema/internal/sizer.go:93 +0x604
  github.com/pingcap/tidb/pkg/infoschema/internal.sizeOf()
      pkg/infoschema/internal/sizer.go:141 +0x207
  github.com/pingcap/tidb/pkg/infoschema/internal.sizeOf()
      pkg/infoschema/internal/sizer.go:64 +0xaa7
  github.com/pingcap/tidb/pkg/infoschema/internal.Sizeof()
      pkg/infoschema/internal/sizer.go:28 +0x1b7
  github.com/pingcap/tidb/pkg/infoschema.(*entry[go.shape.struct { github.com/pingcap/tidb/pkg/infoschema.tableID int64; github.com/pingcap/tidb/pkg/infoschema.schemaVersion int64 },go.shape.interface { AddRecord(github.com/pingcap/tidb/pkg/table/context.MutateContext, []github.com/pingcap/tidb/pkg/types.Datum, ...github.com/pingcap/tidb/pkg/table.AddRecordOption) (github.com/pingcap/tidb/pkg/kv.Handle, error); Allocators(github.com/pingcap/tidb/pkg/table/context.AllocatorContext) github.com/pingcap/tidb/pkg/meta/autoid.Allocators; Cols() []*github.com/pingcap/tidb/pkg/table.Column; DeletableCols() []*github.com/pingcap/tidb/pkg/table.Column; FullHiddenColsAndVisibleCols() []*github.com/pingcap/tidb/pkg/table.Column; GetPartitionedTable() github.com/pingcap/tidb/pkg/table.PartitionedTable; HiddenCols() []*github.com/pingcap/tidb/pkg/table.Column; IndexPrefix() github.com/pingcap/tidb/pkg/kv.Key; Indices() []github.com/pingcap/tidb/pkg/table.Index; Meta() *github.com/pingcap/tidb/pkg/parser/model.TableInfo; RecordPrefix() github.com/pingcap/tidb/pkg/kv.Key; RemoveRecord(github.com/pingcap/tidb/pkg/table/context.MutateContext, github.com/pingcap/tidb/pkg/kv.Handle, []github.com/pingcap/tidb/pkg/types.Datum) error; Type() github.com/pingcap/tidb/pkg/table.Type; UpdateRecord(context.Context, github.com/pingcap/tidb/pkg/table/context.MutateContext, github.com/pingcap/tidb/pkg/kv.Handle, []github.com/pingcap/tidb/pkg/types.Datum, []github.com/pingcap/tidb/pkg/types.Datum, []bool) error; VisibleCols() []*github.com/pingcap/tidb/pkg/table.Column; WritableCols() []*github.com/pingcap/tidb/pkg/table.Column }]).Size()
      pkg/infoschema/sieve.go:36 +0x67
  github.com/pingcap/tidb/pkg/infoschema.(*Sieve[go.shape.struct { github.com/pingcap/tidb/pkg/infoschema.tableID int64; github.com/pingcap/tidb/pkg/infoschema.schemaVersion int64 },go.shape.interface { AddRecord(github.com/pingcap/tidb/pkg/table/context.MutateContext, []github.com/pingcap/tidb/pkg/types.Datum, ...github.com/pingcap/tidb/pkg/table.AddRecordOption) (github.com/pingcap/tidb/pkg/kv.Handle, error); Allocators(github.com/pingcap/tidb/pkg/table/context.AllocatorContext) github.com/pingcap/tidb/pkg/meta/autoid.Allocators; Cols() []*github.com/pingcap/tidb/pkg/table.Column; DeletableCols() []*github.com/pingcap/tidb/pkg/table.Column; FullHiddenColsAndVisibleCols() []*github.com/pingcap/tidb/pkg/table.Column; GetPartitionedTable() github.com/pingcap/tidb/pkg/table.PartitionedTable; HiddenCols() []*github.com/pingcap/tidb/pkg/table.Column; IndexPrefix() github.com/pingcap/tidb/pkg/kv.Key; Indices() []github.com/pingcap/tidb/pkg/table.Index; Meta() *github.com/pingcap/tidb/pkg/parser/model.TableInfo; RecordPrefix() github.com/pingcap/tidb/pkg/kv.Key; RemoveRecord(github.com/pingcap/tidb/pkg/table/context.MutateContext, github.com/pingcap/tidb/pkg/kv.Handle, []github.com/pingcap/tidb/pkg/types.Datum) error; Type() github.com/pingcap/tidb/pkg/table.Type; UpdateRecord(context.Context, github.com/pingcap/tidb/pkg/table/context.MutateContext, github.com/pingcap/tidb/pkg/kv.Handle, []github.com/pingcap/tidb/pkg/types.Datum, []github.com/pingcap/tidb/pkg/types.Datum, []bool) error; VisibleCols() []*github.com/pingcap/tidb/pkg/table.Column; WritableCols() []*github.com/pingcap/tidb/pkg/table.Column }]).Set()
      pkg/infoschema/sieve.go:102 +0x3bd
  github.com/pingcap/tidb/pkg/infoschema.(*infoschemaV2).TableByName()
      pkg/infoschema/infoschema_v2.go:445 +0x764
  github.com/pingcap/tidb/pkg/infoschema.(*SessionExtendedInfoSchema).TableByName()
      pkg/infoschema/infoschema.go:769 +0x2e3
  github.com/pingcap/tidb/pkg/planner/core.(*preprocessor).tableByName()
      pkg/planner/core/preprocess.go:496 +0x3d6
  github.com/pingcap/tidb/pkg/planner/core.(*preprocessor).handleTableName()
      pkg/planner/core/preprocess.go:1576 +0x2f9
  github.com/pingcap/tidb/pkg/planner/core.(*preprocessor).Leave()
      pkg/planner/core/preprocess.go:597 +0x367
  github.com/pingcap/tidb/pkg/parser/ast.(*TableName).Accept()
      pkg/parser/ast/dml.go:452 +0x1dc
  github.com/pingcap/tidb/pkg/parser/ast.(*TableSource).Accept()
      pkg/parser/ast/dml.go:604 +0x90
  github.com/pingcap/tidb/pkg/parser/ast.(*Join).Accept()
      pkg/parser/ast/dml.go:244 +0xb9
  github.com/pingcap/tidb/pkg/parser/ast.(*TableRefsClause).Accept()
      pkg/parser/ast/dml.go:827 +0x8b
  github.com/pingcap/tidb/pkg/parser/ast.(*SelectStmt).Accept()
      pkg/parser/ast/dml.go:1499 +0x50b
  github.com/pingcap/tidb/pkg/planner/core.Preprocess()
      pkg/planner/core/preprocess.go:138 +0x354
  github.com/pingcap/tidb/pkg/executor.(*Compiler).Compile()
      pkg/executor/compiler.go:67 +0x47c
  github.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt()
      pkg/session/session.go:2094 +0xe93
  github.com/pingcap/tidb/pkg/session.(*session).ExecuteInternal()
      pkg/session/session.go:1519 +0x3b9
  github.com/pingcap/tidb/pkg/timer/tablestore.executeSQL()
      pkg/timer/tablestore/store.go:438 +0x16f
  github.com/pingcap/tidb/pkg/timer/tablestore.(*tableTimerStoreCore).List()
      pkg/timer/tablestore/store.go:141 +0x2ec
  github.com/pingcap/tidb/pkg/timer/api.(*defaultTimerClient).GetTimers()
      pkg/timer/api/client.go:188 +0x13a
  github.com/pingcap/tidb/pkg/ttl/ttlworker.(*TTLTimersSyncer).SyncTimers()
      pkg/ttl/ttlworker/timer_sync.go:166 +0x33a
  github.com/pingcap/tidb/pkg/ttl/ttlworker.(*JobManager).onTimerTick()
      pkg/ttl/ttlworker/job_manager.go:306 +0x409
  github.com/pingcap/tidb/pkg/ttl/ttlworker.(*JobManager).jobLoop()
      pkg/ttl/ttlworker/job_manager.go:205 +0x127b
  github.com/pingcap/tidb/pkg/ttl/ttlworker.(*JobManager).jobLoop-fm()
      <autogenerated>:1 +0x33
  github.com/pingcap/tidb/pkg/ttl/ttlworker.(*baseWorker).loop()
      pkg/ttl/ttlworker/worker.go:134 +0xbb
  github.com/pingcap/tidb/pkg/ttl/ttlworker.(*baseWorker).loop-fm()
      <autogenerated>:1 +0x33
  github.com/pingcap/tidb/pkg/util.(*WaitGroupWrapper).Run.func1()
      pkg/util/wait_group_wrapper.go:157 +0x86
Previous write at 0x00c002953548 by goroutine 45584:
  github.com/pingcap/tidb/pkg/table/tables.(*TableCommon).Cols.func1()
      pkg/table/tables/tables.go:352 +0x225
  sync.(*Once).doSlow()
      GOROOT/src/sync/once.go:74 +0xf0
  sync.(*Once).Do()
      GOROOT/src/sync/once.go:65 +0x44
  github.com/pingcap/tidb/pkg/table/tables.(*TableCommon).Cols()
      pkg/table/tables/tables.go:349 +0x7e
  github.com/pingcap/tidb/pkg/planner/core.(*PlanBuilder).buildDataSource()
      pkg/planner/core/logical_plan_builder.go:4876 +0x68ee
  github.com/pingcap/tidb/pkg/planner/core.(*PlanBuilder).buildResultSetNode()
      pkg/planner/core/logical_plan_builder.go:449 +0x25a
  github.com/pingcap/tidb/pkg/planner/core.(*PlanBuilder).buildJoin()
      pkg/planner/core/logical_plan_builder.go:934 +0xfa5
  github.com/pingcap/tidb/pkg/planner/core.(*PlanBuilder).buildResultSetNode()
      pkg/planner/core/logical_plan_builder.go:435 +0xe4
  github.com/pingcap/tidb/pkg/planner/core.(*PlanBuilder).buildTableRefs()
      pkg/planner/core/logical_plan_builder.go:427 +0x117
  github.com/pingcap/tidb/pkg/planner/core.(*PlanBuilder).buildSelect()
      pkg/planner/core/logical_plan_builder.go:4107 +0xb2d
  github.com/pingcap/tidb/pkg/planner/core.(*PlanBuilder).Build()
      pkg/planner/core/planbuilder.go:515 +0xbb1
  github.com/pingcap/tidb/pkg/planner.buildLogicalPlan()
      pkg/planner/optimize.go:549 +0x311
  github.com/pingcap/tidb/pkg/planner.optimize()
      pkg/planner/optimize.go:466 +0xd04
  github.com/pingcap/tidb/pkg/planner.Optimize()
      pkg/planner/optimize.go:334 +0x2737
  github.com/pingcap/tidb/pkg/executor.(*Compiler).Compile()
      pkg/executor/compiler.go:99 +0x7ea
  github.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt()
      pkg/session/session.go:2094 +0xe93
  github.com/pingcap/tidb/pkg/session.(*session).ExecuteInternal()
      pkg/session/session.go:1519 +0x3b9
  github.com/pingcap/tidb/pkg/timer/tablestore.executeSQL()
      pkg/timer/tablestore/store.go:438 +0x16f
  github.com/pingcap/tidb/pkg/timer/tablestore.(*tableTimerStoreCore).List()
      pkg/timer/tablestore/store.go:141 +0x2ec
  github.com/pingcap/tidb/pkg/timer/runtime.(*TimerGroupRuntime).fullRefreshTimers()
      pkg/timer/runtime/runtime.go:234 +0x128
  github.com/pingcap/tidb/pkg/timer/runtime.(*TimerGroupRuntime).loop()
      pkg/timer/runtime/runtime.go:186 +0x6ee
  github.com/pingcap/tidb/pkg/timer/runtime.(*TimerGroupRuntime).loop-fm()
      <autogenerated>:1 +0x3d
  github.com/pingcap/tidb/pkg/timer/runtime.withRecoverUntil.func1()
      pkg/timer/runtime/runtime.go:494 +0x45
  github.com/pingcap/tidb/pkg/util.WithRecovery()
      pkg/util/misc.go:97 +0x77
  github.com/pingcap/tidb/pkg/timer/runtime.withRecoverUntil()
      pkg/timer/runtime/runtime.go:493 +0xcd
  github.com/pingcap/tidb/pkg/timer/runtime.(*TimerGroupRuntime).Start.func1()
      pkg/timer/runtime/runtime.go:127 +0x7b
  github.com/pingcap/tidb/pkg/util.(*WaitGroupWrapper).Run.func1()
      pkg/util/wait_group_wrapper.go:157 +0x86
Goroutine 40689 (running) created at:
  github.com/pingcap/tidb/pkg/util.(*WaitGroupWrapper).Run()
      pkg/util/wait_group_wrapper.go:155 +0xe4
  github.com/pingcap/tidb/pkg/ttl/ttlworker.(*baseWorker).Start()
      pkg/ttl/ttlworker/worker.go:71 +0x12e
  github.com/pingcap/tidb/pkg/domain.(*Domain).StartTTLJobManager()
      pkg/domain/domain.go:3010 +0x1c9
  github.com/pingcap/tidb/pkg/session.bootstrapSessionImpl()
      pkg/session/session.go:3533 +0x1b71
  github.com/pingcap/tidb/pkg/domain.(*Domain).rebuildSysVarCache()
      pkg/domain/sysvar_cache.go:146 +0x974
  github.com/pingcap/tidb/pkg/sessionctx/variable.glob..func204()
      pkg/sessionctx/variable/sysvar.go:1067 +0x58
  github.com/pingcap/tidb/pkg/sessionctx/variable.(*SysVar).ValidateWithRelaxedValidation()
      pkg/sessionctx/variable/variable.go:365 +0x23e
  github.com/pingcap/tidb/pkg/domain.(*Domain).rebuildSysVarCache()
      pkg/domain/sysvar_cache.go:145 +0x904
  github.com/pingcap/tidb/pkg/domain.(*Domain).LoadSysVarCacheLoop()
      pkg/domain/domain.go:1755 +0x93
  github.com/pingcap/tidb/pkg/session.bootstrapSessionImpl()
      pkg/session/session.go:3426 +0x864
  github.com/pingcap/tidb/pkg/domain.(*Domain).GetSessionCache()
      pkg/domain/sysvar_cache.go:61 +0x50
  github.com/pingcap/tidb/pkg/session.(*session).loadCommonGlobalVariablesIfNeeded()
      pkg/session/session.go:3794 +0x2ce
  github.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt()
      pkg/session/session.go:2008 +0x184
  github.com/pingcap/tidb/pkg/session.(*session).ExecuteInternal()
      pkg/session/session.go:1519 +0x3b9
  github.com/pingcap/tidb/pkg/domain.(*Domain).LoadPrivilegeLoop()
      pkg/domain/domain.go:1698 +0x108
  github.com/pingcap/tidb/pkg/session.bootstrapSessionImpl()
      pkg/session/session.go:3419 +0x804
  github.com/pingcap/tidb/pkg/session.BootstrapSession()
      pkg/session/session.go:3318 +0xad
  github.com/pingcap/tidb/pkg/testkit.bootstrap()
      pkg/testkit/mockstore.go:254 +0x94
  github.com/pingcap/tidb/pkg/testkit.CreateMockStoreAndDomain()
      pkg/testkit/mockstore.go:225 +0xd2
  pkg/expression/test/multivaluedindex/multivaluedindex_test.TestWriteMultiValuedIndex()
      pkg/expression/test/multivaluedindex/multi_valued_index_test.go:34 +0x54
  testing.tRunner()
      GOROOT/src/testing/testing.go:1595 +0x261
  testing.(*T).Run.func1()
      GOROOT/src/testing/testing.go:1648 +0x44
Goroutine 45584 (running) created at:
  github.com/pingcap/tidb/pkg/util.(*WaitGroupWrapper).Run()
      pkg/util/wait_group_wrapper.go:155 +0xe4
  github.com/pingcap/tidb/pkg/timer/runtime.(*TimerGroupRuntime).Start()
      pkg/timer/runtime/runtime.go:126 +0x1eb
  github.com/pingcap/tidb/pkg/ttl/ttlworker.(*ttlTimerRuntime).Resume()
      pkg/ttl/ttlworker/timer.go:283 +0x35b
  github.com/pingcap/tidb/pkg/ttl/ttlworker.(*JobManager).onTimerTick()
      pkg/ttl/ttlworker/job_manager.go:295 +0x2b1
  github.com/pingcap/tidb/pkg/ttl/ttlworker.(*JobManager).jobLoop()
      pkg/ttl/ttlworker/job_manager.go:205 +0x127b
  github.com/pingcap/tidb/pkg/ttl/ttlworker.(*JobManager).jobLoop-fm()
      <autogenerated>:1 +0x33
  github.com/pingcap/tidb/pkg/ttl/ttlworker.(*baseWorker).loop()
      pkg/ttl/ttlworker/worker.go:134 +0xbb
  github.com/pingcap/tidb/pkg/ttl/ttlworker.(*baseWorker).loop-fm()
      <autogenerated>:1 +0x33
  github.com/pingcap/tidb/pkg/util.(*WaitGroupWrapper).Run.func1()
      pkg/util/wait_group_wrapper.go:157 +0x86
================== 
```
### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53863,pingcap/tidb,2024-06-06 17:53:29+00:00,2024-07-31 06:17:57+00:00,2024-07-31 06:17:57+00:00,closed,"['type/bug', 'component/test', 'sig/sql-infra', 'severity/major', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1']",Concurrency Issue
DATA RACE in the TestShuffleMergeJoinInDisk,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

```
==================
WARNING: DATA RACE
Write at 0x00c00978fb10 by goroutine 63:
  github.com/pingcap/tidb/pkg/util/chunk.(*Chunk).resetForReuse()
      pkg/util/chunk/chunk.go:153 +0x910
  github.com/pingcap/tidb/pkg/util/chunk.(*allocator).Reset()
      pkg/util/chunk/alloc.go:123 +0x124
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).MustQuery.func1()
      pkg/testkit/testkit.go:169 +0x65
  runtime.deferCallSave()
      GOROOT/src/runtime/panic.go:798 +0x83
  testing.(*T).FailNow()
      <autogenerated>:1 +0x31
  github.com/stretchr/testify/require.NoError()
      external/com_github_stretchr_testify/require/require.go:1357 +0xba
  github.com/stretchr/testify/require.(*Assertions).NoError()
      external/com_github_stretchr_testify/require/require_forward.go:1072 +0xa6
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).ResultSetToResultWithCtx()
      pkg/testkit/testkit.go:272 +0x14e
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).MustQueryWithContext()
      pkg/testkit/testkit.go:197 +0x2e4
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).MustQuery()
      pkg/testkit/testkit.go:172 +0x106
  github.com/pingcap/tidb/pkg/executor/join_test.checkMergeAndRun()
      pkg/executor/join/merge_join_test.go:38 +0x329
  github.com/pingcap/tidb/pkg/executor/join_test.TestShuffleMergeJoinInDisk()
      pkg/executor/join/merge_join_test.go:67 +0x61c
  github.com/pingcap/tidb/pkg/domain.(*Domain).rebuildSysVarCache()
      pkg/domain/sysvar_cache.go:145 +0x904
  github.com/pingcap/tidb/pkg/domain.(*Domain).LoadSysVarCacheLoop()
      pkg/domain/domain.go:1755 +0x93
  github.com/pingcap/tidb/pkg/session.bootstrapSessionImpl()
      pkg/session/session.go:3426 +0x864
  github.com/pingcap/tidb/pkg/domain.(*Domain).GetSessionCache()
      pkg/domain/sysvar_cache.go:61 +0x50
  github.com/pingcap/tidb/pkg/session.(*session).loadCommonGlobalVariablesIfNeeded()
      pkg/session/session.go:3794 +0x2ce
  github.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt()
      pkg/session/session.go:2008 +0x184
  github.com/pingcap/tidb/pkg/session.(*session).ExecuteInternal()
      pkg/session/session.go:1519 +0x3b9
  github.com/pingcap/tidb/pkg/domain.(*Domain).LoadPrivilegeLoop()
      pkg/domain/domain.go:1698 +0x108
  github.com/pingcap/tidb/pkg/session.bootstrapSessionImpl()
      pkg/session/session.go:3419 +0x804
  github.com/pingcap/tidb/pkg/session.BootstrapSession()
      pkg/session/session.go:3318 +0xad
  github.com/pingcap/tidb/pkg/testkit.bootstrap()
      pkg/testkit/mockstore.go:254 +0x94
  github.com/pingcap/tidb/pkg/testkit.CreateMockStoreAndDomain()
      pkg/testkit/mockstore.go:225 +0xd2
  github.com/pingcap/tidb/pkg/executor/join_test.TestShuffleMergeJoinInDisk()
      pkg/executor/join/merge_join_test.go:46 +0xf9
  github.com/pingcap/failpoint.parseTerm()
      external/com_github_pingcap_failpoint/terms.go:149 +0x364
  github.com/pingcap/failpoint.parse()
      external/com_github_pingcap_failpoint/terms.go:126 +0xa5
  github.com/pingcap/failpoint.newTerms()
      external/com_github_pingcap_failpoint/terms.go:98 +0x3e
  github.com/pingcap/failpoint.(*Failpoint).Enable()
      external/com_github_pingcap_failpoint/failpoint.go:58 +0x3e
  github.com/pingcap/failpoint.(*Failpoints).Enable()
      external/com_github_pingcap_failpoint/failpoints.go:105 +0x296
  github.com/pingcap/failpoint.Enable()
      external/com_github_pingcap_failpoint/failpoints.go:255 +0x55
  github.com/pingcap/tidb/pkg/executor/join_test.TestShuffleMergeJoinInDisk()
      pkg/executor/join/merge_join_test.go:42 +0x56
  testing.tRunner()
      GOROOT/src/testing/testing.go:1595 +0x261
  testing.(*T).Run.func1()
      GOROOT/src/testing/testing.go:1648 +0x44
Previous read at 0x00c00978fb10 by goroutine 45341:
  github.com/pingcap/tidb/pkg/util/chunk.(*Chunk).Reset()
      pkg/util/chunk/chunk.go:285 +0x564
  github.com/pingcap/tidb/pkg/executor/sortexec.(*SortExec).Next()
      pkg/executor/sortexec/sort.go:273 +0x635
  github.com/pingcap/tidb/pkg/executor/internal/exec.Next()
      pkg/executor/internal/exec/executor.go:410 +0x3b0
  github.com/pingcap/tidb/pkg/executor/join.(*MergeJoinTable).fetchNextChunk()
      pkg/executor/join/merge_join.go:169 +0x26f
  github.com/pingcap/tidb/pkg/executor/join.(*MergeJoinTable).fetchNextInnerGroup()
      pkg/executor/join/merge_join.go:213 +0x744
  github.com/pingcap/tidb/pkg/executor/join.(*MergeJoinExec).Next()
      pkg/executor/join/merge_join.go:335 +0x3eb
  github.com/pingcap/tidb/pkg/executor/internal/exec.Next()
      pkg/executor/internal/exec/executor.go:410 +0x3b0
  github.com/pingcap/tidb/pkg/executor.(*shuffleWorker).run()
      pkg/executor/shuffle.go:409 +0x2aa
  github.com/pingcap/tidb/pkg/executor.(*ShuffleExec).prepare4ParallelExec.func2()
      pkg/executor/shuffle.go:215 +0x5d
Goroutine 63 (running) created at:
  testing.(*T).Run()
      GOROOT/src/testing/testing.go:1648 +0x845
  testing.runTests.func1()
      GOROOT/src/testing/testing.go:2054 +0x84
  testing.tRunner()
      GOROOT/src/testing/testing.go:1595 +0x261
  testing.runTests()
      GOROOT/src/testing/testing.go:2052 +0x8ad
  testing.(*M).Run()
      GOROOT/src/testing/testing.go:1925 +0xcd7
  main.main()
      bazel-out/k8-fastbuild/bin/pkg/executor/join/join_test_/testmain.go:159 +0x6dc
Goroutine 45341 (running) created at:
  github.com/pingcap/tidb/pkg/executor.(*ShuffleExec).prepare4ParallelExec()
      pkg/executor/shuffle.go:215 +0x264
  github.com/pingcap/tidb/pkg/executor.(*ShuffleExec).Next()
      pkg/executor/shuffle.go:230 +0x11b
  github.com/pingcap/tidb/pkg/executor/internal/exec.Next()
      pkg/executor/internal/exec/executor.go:410 +0x3b0
  github.com/pingcap/tidb/pkg/executor.(*SelectionExec).Next()
      pkg/executor/executor.go:1605 +0x208
  github.com/pingcap/tidb/pkg/executor/internal/exec.Next()
      pkg/executor/internal/exec/executor.go:410 +0x3b0
  github.com/pingcap/tidb/pkg/executor.(*ExecStmt).next()
      pkg/executor/adapter.go:1211 +0x84
  github.com/pingcap/tidb/pkg/executor.(*recordSet).Next()
      pkg/executor/adapter.go:160 +0x19a
  github.com/pingcap/tidb/pkg/session.(*execStmtResult).Next()
      <autogenerated>:1 +0x6c
  github.com/pingcap/tidb/pkg/session.GetRows4Test()
      pkg/session/tidb.go:346 +0xd2
  github.com/pingcap/tidb/pkg/session.ResultSetToStringSlice()
      pkg/session/tidb.go:364 +0xa7
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).ResultSetToResultWithCtx()
      pkg/testkit/testkit.go:271 +0xac
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).MustQueryWithContext()
      pkg/testkit/testkit.go:197 +0x2e4
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).MustQuery()
      pkg/testkit/testkit.go:172 +0x106
  github.com/pingcap/tidb/pkg/executor/join_test.checkMergeAndRun()
      pkg/executor/join/merge_join_test.go:38 +0x329
  github.com/pingcap/tidb/pkg/executor/join_test.TestShuffleMergeJoinInDisk()
      pkg/executor/join/merge_join_test.go:67 +0x61c
  github.com/pingcap/tidb/pkg/domain.(*Domain).rebuildSysVarCache()
      pkg/domain/sysvar_cache.go:145 +0x904
  github.com/pingcap/tidb/pkg/domain.(*Domain).LoadSysVarCacheLoop()
      pkg/domain/domain.go:1755 +0x93
  github.com/pingcap/tidb/pkg/session.bootstrapSessionImpl()
      pkg/session/session.go:3426 +0x864
  github.com/pingcap/tidb/pkg/domain.(*Domain).GetSessionCache()
      pkg/domain/sysvar_cache.go:61 +0x50
  github.com/pingcap/tidb/pkg/session.(*session).loadCommonGlobalVariablesIfNeeded()
      pkg/session/session.go:3794 +0x2ce
  github.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt()
      pkg/session/session.go:2008 +0x184
  github.com/pingcap/tidb/pkg/session.(*session).ExecuteInternal()
      pkg/session/session.go:1519 +0x3b9
  github.com/pingcap/tidb/pkg/domain.(*Domain).LoadPrivilegeLoop()
      pkg/domain/domain.go:1698 +0x108
  github.com/pingcap/tidb/pkg/session.bootstrapSessionImpl()
      pkg/session/session.go:3419 +0x804
  github.com/pingcap/tidb/pkg/session.BootstrapSession()
      pkg/session/session.go:3318 +0xad
  github.com/pingcap/tidb/pkg/testkit.bootstrap()
      pkg/testkit/mockstore.go:254 +0x94
  github.com/pingcap/tidb/pkg/testkit.CreateMockStoreAndDomain()
      pkg/testkit/mockstore.go:225 +0xd2
  github.com/pingcap/tidb/pkg/executor/join_test.TestShuffleMergeJoinInDisk()
      pkg/executor/join/merge_join_test.go:46 +0xf9
  github.com/pingcap/failpoint.parseTerm()
      external/com_github_pingcap_failpoint/terms.go:149 +0x364
  github.com/pingcap/failpoint.parse()
      external/com_github_pingcap_failpoint/terms.go:126 +0xa5
  github.com/pingcap/failpoint.newTerms()
      external/com_github_pingcap_failpoint/terms.go:98 +0x3e
  github.com/pingcap/failpoint.(*Failpoint).Enable()
      external/com_github_pingcap_failpoint/failpoint.go:58 +0x3e
  github.com/pingcap/failpoint.(*Failpoints).Enable()
      external/com_github_pingcap_failpoint/failpoints.go:105 +0x296
  github.com/pingcap/failpoint.Enable()
      external/com_github_pingcap_failpoint/failpoints.go:255 +0x55
  github.com/pingcap/tidb/pkg/executor/join_test.TestShuffleMergeJoinInDisk()
      pkg/executor/join/merge_join_test.go:42 +0x56
  testing.tRunner()
      GOROOT/src/testing/testing.go:1595 +0x261
  testing.(*T).Run.func1()
      GOROOT/src/testing/testing.go:1648 +0x44
================== 
```
### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53862,pingcap/tidb,2024-06-06 17:50:17+00:00,2024-11-18 03:24:00+00:00,2024-11-18 03:23:12+00:00,closed,"['type/bug', 'component/test', 'sig/execution', 'severity/major', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1', 'affects-8.5']",Concurrency Issue
incorrect result using CTE and subquery,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
``` SQL
CREATE TABLE `t9172e9ec` (
  `col_1` int(11) NOT NULL,
  `col_2` json NOT NULL,
  `col_3` char(119) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL DEFAULT '1Fj!VQi4iQ)^PgL_+l',
  `col_4` varchar(286) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL DEFAULT 'cU',
  `col_5` float DEFAULT NULL,
  PRIMARY KEY (`col_1`,`col_3`) /*T![clustered_index] CLUSTERED */
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci
PARTITION BY HASH (`col_1`) PARTITIONS 3;
INSERT INTO `t9172e9ec` VALUES(-2124506745,'[7854852970062856851, 485712809120497816]','m9dYdi-QwRg#*o*A3Ip',')u$3a$dfL4rc',8833.722),(-1987900253,'[4784139917445341210, 2409847733994134699, 10707724437804402980, 6577977165263525461]','rA0yD=c3(zA#Tx4Me=%','5=-l6',8261.812),(-1801039543,'[4784139917445341210, 2409847733994134699, 10707724437804402980, 6577977165263525461]','q','5=-l6',2249.8162),(-1801039543,'[4784139917445341210, 2409847733994134699, 10707724437804402980, 6577977165263525461]','qNiB(j^v=9#m)5I','5=-l6',8015.3647),(-1555981914,'[4784139917445341210, 2409847733994134699, 10707724437804402980, 6577977165263525461]','wREM','5=-l6',7211.5654),(-1512956812,'[12237306431704586590, 15033675751746115877, 17890410345510922576]','YKec~g','pvNYq!TYOu',4839.073),(-1427641173,'[4784139917445341210, 2409847733994134699, 10707724437804402980, 6577977165263525461]','k^j_b','5=-l6',1043.4517),(-1241352378,'[4784139917445341210, 2409847733994134699, 10707724437804402980, 6577977165263525461]','xJnURwQG!s9If','5=-l6',1577.0089),(-1137801237,'[4784139917445341210, 2409847733994134699, 10707724437804402980, 6577977165263525461]','q!8&+','5=-l6',6956.594),(-1135860082,'[4784139917445341210, 2409847733994134699, 10707724437804402980, 6577977165263525461]','mFIwt_-nw^+=xzhFO7','5=-l6',9747.357),(-833071871,'[3671565389575202116]','s(W6=&fu4+@@O1Dh4P=','B',6504.2065),(-401167891,'[4784139917445341210, 2409847733994134699, 10707724437804402980, 6577977165263525461]','~3xV&h^)ZNPTlC','5=-l6',3470.9688),(-385141748,'[4784139917445341210, 2409847733994134699, 10707724437804402980, 6577977165263525461]','oc','5=-l6',4505.947),(-369638048,'[6692908082570525008, 11282158432044887632]','7CLPayG','!%u0*yeZTW#+OhWEc+',4696.878),(-316801815,'[4784139917445341210, 2409847733994134699, 10707724437804402980, 6577977165263525461]','oMhb_vrKJTv!BIm0lNS','5=-l6',677.98785),(-155320341,'[15037175073412781918, 6436057204829237547]','9DhQlP=','Ild(5Ft4C!^zrk@7O=F',2871.2407),(-129161234,'[4784139917445341210, 2409847733994134699, 10707724437804402980, 6577977165263525461]','n3qVghjnkx*#zy9AaV','5=-l6',8387.211),(154916136,'[4784139917445341210, 2409847733994134699, 10707724437804402980, 6577977165263525461]','mkJsR','5=-l6',5501.6943),(241213743,'[4784139917445341210, 2409847733994134699, 10707724437804402980, 6577977165263525461]','xyaR%xp5m5g-H','5=-l6',8753.599),(297737358,'[10881785351205027060, 10968098726351092777, 13447444998800967333, 10787113729586840005, 18164090871369150855]','ZZbM','G&L*a%V1',9692.497),(361364887,'[13571935304690400155, 15428459843371141639, 5166067369409479765, 13376215633079336076, 14918734709157485711]','nYpg','K3&a9W^sbyS=nH~',NULL),(461116246,'[4784139917445341210, 2409847733994134699, 10707724437804402980, 6577977165263525461]','m','5=-l6',4245.67),(690428690,'[13874302886417823206, 5106557973216105875, 4500765527154768391, 698879997138293585, 4238860526309864992]','fZxMsQ','rb6R5NF',NULL),(787126218,'[4784139917445341210, 2409847733994134699, 10707724437804402980, 6577977165263525461]','oh4fN@M_bk4#s&N','5=-l6',8638.904),(1955454898,'[4784139917445341210, 2409847733994134699, 10707724437804402980, 6577977165263525461]','llE0aPj@+N_#k@Q','5=-l6',798.27545);
CREATE TABLE `ta0c4280a` (
  `col_64` time NOT NULL,
  KEY `idx_25` (`col_64`),
  UNIQUE KEY `idx_26` (`col_64`),
  PRIMARY KEY (`col_64`) /*T![clustered_index] CLUSTERED */
) ENGINE=InnoDB DEFAULT CHARSET=gbk COLLATE=gbk_bin;
INSERT INTO `ta0c4280a` VALUES('00:00:54'),('00:07:16'),('00:13:36'),('00:19:54'),('00:22:22'),('00:22:47'),('00:40:24'),('00:41:42'),('00:42:17'),('00:45:20'),('00:47:50'),('01:26:40'),('01:47:38'),('01:49:41'),('01:56:35'),('01:59:55'),('01:59:58'),('02:01:25'),('02:12:23'),('02:12:28'),('02:26:30'),('02:32:16'),('02:50:53'),('02:55:45'),('03:01:28'),('03:09:41'),('03:10:02'),('03:18:21'),('03:22:04'),('03:24:53'),('03:32:52'),('04:15:04'),('04:39:11'),('04:44:55'),('04:48:13'),('04:50:28'),('05:27:20'),('05:35:49'),('05:40:36'),('05:44:35'),('05:47:27'),('05:53:50'),('05:57:15'),('06:00:53'),('06:05:09'),('06:23:28'),('06:31:53'),('06:48:26'),('06:50:34'),('06:58:10'),('06:58:34'),('07:02:03'),('07:10:37'),('07:19:28'),('07:22:30'),('07:44:38'),('07:47:35'),('07:52:10'),('08:06:39'),('08:12:58'),('08:18:35'),('08:33:16'),('08:37:23'),('08:44:13'),('08:46:17'),('08:47:15'),('08:58:06'),('09:02:19'),('09:10:07'),('09:13:38'),('09:18:38'),('09:41:40'),('10:11:05'),('10:31:32'),('10:31:59'),('10:42:32'),('10:43:47'),('10:48:58'),('10:49:19'),('11:02:52'),('11:14:33'),('11:20:24'),('11:26:11'),('11:27:17'),('11:29:45'),('11:39:55'),('11:41:01'),('11:45:15'),('11:46:21'),('11:48:16'),('12:05:01'),('12:05:42'),('12:13:23'),('12:18:18'),('12:18:23'),('12:21:06'),('12:21:11'),('12:36:24'),('12:36:35'),('12:40:39'),('12:47:46'),('12:48:36'),('12:52:06'),('12:53:30'),('13:06:13'),('13:07:50'),('13:10:11'),('13:11:11'),('13:12:46'),('13:24:08'),('13:26:34'),('13:35:50'),('13:38:14'),('13:40:34'),('13:42:23'),('13:42:47'),('13:50:32'),('13:51:59'),('14:00:39'),('14:01:32'),('14:14:22'),('14:32:35'),('14:36:32'),('14:36:59'),('14:38:41'),('14:41:52'),('14:42:17'),('15:02:46'),('15:04:34'),('15:17:59'),('15:18:07'),('15:36:06'),('15:36:20'),('15:44:23'),('15:46:15'),('15:51:33'),('15:59:15'),('16:04:02'),('16:22:21'),('16:37:16'),('16:42:40'),('16:47:08'),('17:03:05'),('17:09:33'),('17:15:36'),('17:22:57'),('17:37:49'),('17:38:09'),('17:44:14'),('17:46:30'),('17:48:38'),('17:50:30'),('18:05:08'),('18:17:02'),('18:20:07'),('18:31:48'),('18:37:57'),('18:42:36'),('18:52:06'),('18:55:54'),('18:57:08'),('19:07:16'),('19:09:46'),('19:22:10'),('19:24:52'),('19:30:43'),('19:33:07'),('19:35:00'),('19:39:36'),('19:49:19'),('20:04:28'),('20:18:42'),('20:24:42'),('20:36:50'),('20:36:52'),('20:37:39'),('20:41:41'),('21:11:41'),('21:15:56'),('21:28:25'),('21:32:26'),('21:38:45'),('21:45:56'),('21:59:31'),('22:02:33'),('22:08:19'),('22:13:24'),('22:26:54'),('22:31:52'),('22:54:18'),('22:56:38'),('23:22:58'),('23:32:42'),('23:41:17');

CREATE TABLE `tld1ce2472` (
  `col_52` json NOT NULL,
  `col_53` date NOT NULL,
  `col_54` datetime NOT NULL,
  `col_55` json NOT NULL,
  `col_56` datetime NOT NULL DEFAULT '2030-11-15 00:00:00',
  `col_57` json NOT NULL,
  PRIMARY KEY (`col_54`,`col_56`) /*T![clustered_index] NONCLUSTERED */
) ENGINE=InnoDB DEFAULT CHARSET=gbk COLLATE=gbk_chinese_ci;
INSERT INTO `tld1ce2472` VALUES('[\""sQ3DTecnoKDB04UlsE9fZnuHcOmsKKmlgZcSZu47TkGSve1YYrGjX7d46eSVAcLT\"", \""QD24Or3D1BsDv1Q9fraSfexPhEgwceKdYI6uUvcmN3VAD8hdu2MAmC7I1rwUuzBF\"", \""rpgf3MpXDVtGicbZXiktVIZPqcclm3tiA3Ui64Vet17zp3xy2mm7rogqscTueQcO\""]','2008-05-07','2011-12-13 00:00:00','[\""c04PqN1B1h2dxEmcHOUYNhLHNNEQlFnkRhnuftF0Bd7DlkoL46XOnG1Vfd3gVmWe\"", \""CAroaoW5ei2wyH8HKdK6uKBt829sYfcddZKRQsHxCRRNEeY8NSwT0ddr6JxXc5m0\"", \""U0XhDvZWb93tiFONlwr47jtFrSVDJLPVYHPoKEtwGcqov0FwpbvUR9OfjisyYxmc\"", \""BWLKZIE08UFH08DQ6klBLflJZwmVtkWz4aj35lt3myVIh6UXCzDLT8zA3uF4rhZg\"", \""cAgPZvbC9xJT2i421NBzhl5UqWDSdOaT5niB3SpkTDOA37ovL7RuqKG9rpaJdUOl\""]','1976-01-24 00:00:00','[0.2044318454344091, 0.022017863976707134, 0.4001102885564622, 0.2508550080069659, 0.04603861529897418]'),('[\""8risuwRixSO7I9JF2FblCF5nrRAewwZgGd5KeaaKYhWm4H8S4URVXUlwEg0i7pXm\"", \""HjTk7soYR318JIarutZkMK8fxz5CvMepeVer2SUNQqpucA0ia81gKNGSI5CpaAim\""]','1987-09-09','1981-09-05 00:00:00','[\""Gzdrj1TFDO0hA4fT7jL47ADL6WSDllOEiG84M5o8xMPMDXQ1J2ERszd7wtwccYln\""]','1972-02-19 00:00:00','[0.6541864885449548, 0.6847267454153251, 0.21656763359152537, 0.4157849328013752]'),('[\""NVnk2gAW0leRUvJ7K4kc8pFCTQptBQCpbJpzJM0a1UwSg5yZRBoIo6C8HAl7Anfl\"", \""agpfAniYB9J4ry2yxM7lmHHkdxDlUOg7ysnDDS224Uy35hQohkx6ZlQ95Pdmi8ym\"", \""iGmlCEBWX39tArtJQDDRhhXDkrO9t4325b1LVZ0d4jSrHhNyFbLxPk0DdXHGiPuD\""]','1996-07-15','2015-03-31 00:00:00','[\""r5Ebn8Bu9hWCgBAKyTJkwm1msCMPGqE0qPNqJePIr9lfY9DDUfj7uBngnaduJW3E\"", \""6qhD8BwmvaiYSuuWBJjZzD47KwqPQrVrVhzYBB6d4OMUdkArN7ppz2kLnm5jqAHc\"", \""I72IGndAp6dHcYJqB1rzkYelAZZKeW07p2mWRfrbu3beki0LL0yOrMos7eOspLd8\""]','1979-04-09 00:00:00','[0.41150895967330214, 0.5068919190831073, 0.5868392081295616, 0.3143672081876886, 0.08395895213379623]'),('[\""gdlG6ksXifxNRJzuBsBgW4LVUeFjmbEGqoYzqK0x0v74w6jRkhQk4PafSG3pjNcg\"", \""kckeddQI88gj3bcQIhJ4wRiV9HXHcelHpFoUTopaiJN8dvg54ppRkaXlw2Kr8XVN\"", \""XmnfNLQwFULh6ZORviXWeknaTBnPiYy4fB1d3kQ89stcch1GhvJb4a1N6PfVv0cf\"", \""XuSelWDc1ngOXdevOsj3bqd8XLuCdie3NysT6t4vhi23ki3d4w7G6sbellInLodQ\"", \""P45ms1m7nSH7P8xeGGVkYvn9sYKaEr2hroNH0Mk6gLCLBUrifgdDMMoK0xvqwxrF\""]','2016-02-03','2028-04-14 00:00:00','[\""aWr92VD66L2bG5CMhhlpEAizRI4oL5a97ec67NDDFpHZUt7u4CIeGqLrvM8vBhRC\"", \""f2gJNBlnCP9XEW6lUtQzGLoKNL25UyRakj1IiH1tPOdCnM1ZObvthPpkGI6M7Pi2\"", \""4mw5z3QEZTjmylIMthCp4FR12ko8zutmuTguRXP4yDNwQbbM4p5ER50sbDLdFn1Y\""]','2019-02-06 00:00:00','[0.18762694195376287, 0.3689823603721429, 0.610368713091008, 0.7178364851908664]'),('[\""IJldX6gjLYtfNPp45PkUpCirHTBkcmLrguAiUgmqlKlvucrMQV0HB9x4zSpCfABg\"", \""0proaVQk1GsPN3f8c0U7zDXjxIvpvgaTUVCakM36wlSd9HHmsJA6FakToDdEOBW5\"", \""9z4fFSGThKxOzLnJix4WbZnFPrRlcQPKgT1XO24m7mYrmohfNByh70ZFsL4qd8wo\""]','2000-01-05','2025-08-29 00:00:00','[\""2NO9y1CFjiSLkUKlCgNzYi6l3e4pccRny7ghwgyIExfpH3pahiEawIykAo0B5fpb\"", \""FcPummX2RLSgyK7pwG3jtvPhbSoCPYkRPYJKGkn5LIUOaMiEBWp8uJF7qUiEsnxC\"", \""b7ccR5P5cctNKFtFjOEkkxUAq8nvxt0ulSY4AWdwwjim6pF2tf6Z6cjVRhuwRjqS\"", \""oEPUXQM0MWt9R2vzf0VxPQYbi4ahMwyt34ilJ94pnl3l20MJnInZQIj7bQOTX7zE\""]','2028-07-15 00:00:00','[0.9674478048581427, 0.2222114351688126]'),('[\""ym5oBkTFkkeDKu8XCU9VjLmwamYxa0kTF6p9zRjSFgBnFE0q1bpQKfuoSmKZP7iv\"", \""2SnLWzJtZqlfH7cnxPC3tJb3e3RmN3cW5s3FnjbZdkTnTrwQfdNTYoikmNe1Fbxr\""]','1978-06-18','1978-03-09 00:00:00','[\""bpoyZPQkhVjEj9syukrU4XrLuT1SfKppEjrn8r8qTi6isAvHdWefe4xQOQUekUvh\"", \""D0aIqSi6mM2ENKRrqyGw7V1RjiIYFKPZm3WoBpVoHyt2SMIjN2z6yzknO9LKmY2z\"", \""P1sIX5FEffa02NvQMyxHyHhsXX4q9fqPGzfpZcJ49eaR87j07dYVqzV3JmbmbT5l\"", \""3r7DrA8yp6udkInkwax6F8pzGvGQ1IzQGjiP9l0pAePspHLMgauMTy9sN5gyi9W4\""]','1982-08-17 00:00:00','[0.8104981513704869, 0.5554296267840119, 0.15148036211320645, 0.3089212940993241]'),('[\""IjExPD7nBEdiZo0JWiGdqj1QczqNYczMZzfsBTbFFMwblmAHF0eWWpfraBU73Mxv\"", \""PW7Cct2TmwIOZnBm9FVnMcaBE4upxpunbMWMsAylLqZhKXv5iRExEjv1R1ZZBG35\"", \""Yp7koedCnwUBySeZHwBUHbeZrIxU5BVsFzLoraVGCS2mBT0nvSeopNGoyvNBIFoB\""]','2036-04-26','1999-09-22 00:00:00','[\""qDhPEzORlSK3pp0rM4xMjkTL2Av3w4pboqSPFsZsypqo1aD8HMCdtydGtftt8niI\""]','2016-04-13 00:00:00','[0.22173159880605683, 0.766526350394025, 0.15976997253636382]'),('[\""BeCNPq05ps8jyXghHcCduvax1uTGN5lxVKerbAwVQOMyYVl6DK8Lal9hr7kb0ENn\"", \""DDAtQ7dOKCphmyS9L7vP3R9ZJTCN2smbp1klQp0gVcgUG3myPk77zrDtOYdyXfkF\"", \""PRVVeIJpTKH2RTWU9xybHRaTQlsNmnfwhVgpF0WvZSXm9XTzeHD0llVoNjBO51Cv\"", \""uGeFbLcOGxaNCrkWZBVczff88mSlDtTq0OlCYb80Vunhd1KtJmyIw13N0HWxZMZr\"", \""55DPB4li7uXBLpIS0dwnHI6IZ9XLSxLm74bfEGsqqdPJmo22J0UnmhkuzLuvCab6\""]','1988-02-06','1985-01-20 00:00:00','[\""FdZBvPDMfv1q0GRx79G2py6lAvL6pb2hAZJBY3xSDB4HktYWcyTaDLIqAwGEvQQo\"", \""ypX6dOSrUn7ue6v3jt1TJEMe2N8wYop8Qhs2KxFAnaNzO0C8M0WL8vnugXECqjUF\"", \""KUmHn4k5VHAlkywMuhjsUdSF0PAKhlJLTRcNpoipG8EytOGWQNj1yaCkFIRXoRes\""]','1975-09-07 00:00:00','[0.8705401834506464, 0.35452960405946554, 0.5874242096203672, 0.1550717839826001, 0.8393586183398839]'),('[\""vH8q1l9oIVwhmVpk8lFmxxzzGGLdKZ5ndMulSB8dzxw09VkwI8EWFv0vrXvHCbui\"", \""S3bmEa6qMrBXZiOrfBaWG5EU6ma8RUyQ6TOxlpaA4WXQbunIfW5Dl7fPLGDzz9Ac\"", \""dwxTL5ScIMJccTK8HE42NFkY5oGNXZD7yYQtaIYQIhr5h2XaZoGGxq8odXELEg8S\"", \""zEbPnyABCd5r8TQlkaZnD3xuEc7ZdM6v4dEesbcTnVQKhwauQVEbFrTuobsj0eBR\""]','1980-08-07','2004-12-19 00:00:00','[\""ghFazkT2xiNmjHey6pMCPzkQUnBl6ZDZNaJdkNOzxJgSLk1R1dnY49gfTHDvYqZI\"", \""9oVaH4EPaXQ59PFEVuSjkNZzUWtWHpcwLIg4wIeIlWi13P7WotFfcjB2AwzYK10k\""]','2008-09-21 00:00:00','[0.8933399442803783, 0.2749574908374919, 0.2957384535419304, 0.18474097724774424, 0.7974148420776407]'),('[\""JJ5t1z2gNFoWrL63QJSJpa9LOjNAoXv6orIp2EOaNUFxxu9Z3xedBSsBe1sgrSvr\"", \""cbDjBokgQQNiopgnS42CxOBn8pVeCJDT3dkXWGxP09CRQ5xk49XmAVepvIndsoTb\"", \""kkc46lojec7AfOWAco1C69xQtToYr2N6KJLUz7LIj3GmULEMSPfoEaGYvxoWzPWh\"", \""Q7uMpWS4t4fhw23V7oqTPTudTbb6vpFQnxSICHlEQaRWoRdM8C2qad2bioPA1fY9\"", \""xrMqLrUtZT5hdtah7GNVUxRqX6LATf2cgzUltL44Q5VLVh1eTvwjDEiETXj4COkn\""]','1987-02-13','2028-04-21 00:00:00','[\""QnAN7ZuTfFwQwpQ5C9bgPYJJrbiA7XJp6Xv4TvccWzLcBh5YYx8NE84C245qs6EN\"", \""eCFKcYZPpUaZgiGE5JEaOMXMpZ6awMwKUIMzWIn9hcZwSzI02b9lXO8SfImbJRep\""]','1971-02-13 00:00:00','[0.33193776490747656, 0.5154397675349843]'),('[\""eQXJXdcZU4TPhyjcRH8wQOgJG9qVitb7aJBtddDqFaJdTIQXNaD28WSA1Eo0euBF\"", \""SpyoBa2QOUPIwo7w3Z5P4KF1BasA0Fe1oujUf2exK3Q5DetApO7qUM7UOYmROwGK\""]','2022-05-24','2034-12-31 00:00:00','[\""cut624h0F2Uim28edGLcYTOt12BqSll7dSLBtEIVLkXPWuTU73iGNXbdzaWYLOEY\"", \""YNFswJ2UY1O5ExGSi0rMmDab0gl7xtZGIvrIPyzEaiycqGlDhPl4QAv9uavPdWiO\"", \""aoRdlHLFfXFz7pWyiQjgyPLUiPLJcGItO40t2LWFRyPaDfpTY1aV2WuEDH3qenu5\""]','1988-02-02 00:00:00','[0.8247831765243192]'),('[\""Wc2nqMv2Hzdzp2cLG6kClWvHpl4m66pnEICIu5rK3tYhwgVtoqHu1x7YyCzXoAjQ\"", \""ewfoMyomtgpu4pWxMLUJz46FBznG6h2rSNaWVcmAtMKTC316XAmCeHN2Kxy8BkKE\"", \""RkFlp2AeYOA3HSVritwR9kXefDiY5qANrnSA3FquXhhgsMHeINRV7KssF2PowiBs\"", \""7JUCh0rsAZsD8FEad63d1RNZNXzyGmRgJp6ANEe6hFEuOqvi97CvAoT9cCqxtZue\""]','2016-12-03','1972-07-05 00:00:00','[\""GCancSWzgLwv9znfZomRIDNYumQ6rUh8M0kRrweynMXqBTKiRJ7AfTiExK6UEOvP\"", \""L944q746VFqefnfGvB3Tf9IyOOSVkkxpd69NSiTDM26weRpmq15VPQrPtgFh9GrF\"", \""jwm9ilA4DWuGAEfHcvf6ugnVF8mU4iyfrMhhhi81WqvATB3R4EAHIQ6sWNVKJgie\"", \""ktY05QCrVn4C4FDThhWZK9hb7rnJWtpLSHhAltZKatZAvZkNsOyFmOHoQvMItf5V\""]','2034-12-23 00:00:00','[0.6008856389305994, 0.10304033595648161]'),('[\""lssjyTBCQkAJ1QbBQvzsQScQtrqb8GQZQ4HNCr9Fm5nqkFlGoQXH1h8kj3NqyW5p\"", \""lsEKIBO7QWl2TB3un26wZdDLC37bbU3KDnvpZxJUWgToVbKyzrILLdS2mgYBy21P\""]','1994-06-12','1978-11-02 00:00:00','[\""buMrRmXBPm9SdutmAaBQnJo6kx5PxD5DgboEuKKcEE1XnHLLrwGfRM6WSKMWca2C\"", \""8FEp1GPD2VV8XZatbjuNzZ9Z79GZMOw07StxKKltY7SLIQtkRVCsxEZiLhqAIeEA\"", \""82dxl070t6CkB8fo8PP1mnenMrV63v9Vlcf8Nzzhj5oNHYwk2urQWrftya0qWDRJ\"", \""kcw2TjlVeq44JN9ZC829FtJSjyaunnASik4SyMJMOByFpeKEwOKDYQ33rgt0hW2K\""]','2012-02-11 00:00:00','[0.6277570612427995, 0.5454411297738203]'),('[\""wG2W2JaRcVZAhYURL5Hrbqiap6bZY95fM9OY4pWfnS9Zl5yyp17ee1MTbOreNxGf\"", \""rrp16lcpMmaDo8Dhl2snquHuYem4kJ3RW77IuwfN12fdlcnGtv2Ceis6xXr3Ety9\"", \""6qf9hanUbsSngKVZtbM1I3BloTBXvOWwnxoTzBpzL8jLynjvQvFHTCkxpVZvcVWr\""]','1985-05-03','2036-09-16 00:00:00','[\""hjRkMRn8hWqryg5oDwpEFC2AEIvlMD9xuUa351Ohy06ImqrPynRGDPbKCjkmJrwl\"", \""rKxD7xtliA3n2rT9UUYXWG0xhXa4ialg1vkVGxLUiXkNXA0WVHN5Jq2dHUJoPeI9\"", \""43MKN5NVNMpdzaq3RlkDGZJEXEk4bQ8Iuh4qcN53Fn2kfRop3GDiR9GD884FuKd0\"", \""20YV0DXetYe6v133Do3UgMHR1uXFuzXBjryIxqBi2MyKdlERmS3nZZ8quOCEL1ja\""]','1983-07-28 00:00:00','[0.28114710718714564, 0.021354294649253792, 0.45153938340584726, 0.35598969419044985, 0.8845288174858683]'),('[\""oqnvNXdXQGgE1uv9EclA8R9XjfG9iEgmeruCmrXg4n4JdH6pavWKY5xk469vEQa9\"", \""uFASsTjQNmbVIWznAMSPdC4XwOGRtxNQbTc19WsZSb4VQfKmiMDUCbXv7V2MJCcF\""]','1976-01-24','2014-05-02 00:00:00','[\""18JkGp40SBQ8Vp79KAP1vVGAYhTfSbVdwhS8RqHu8RiWoHzIFANTbU2NGqxYfyaf\"", \""vAZS0KWjRHvdZpci8Jw8sUopf0D6qTWQQgPs8rAZB6eQgiwec7mXz6oVBnHvWLrr\""]','1989-05-10 00:00:00','[0.4208078551460235]'),('[\""LgG7cm9DT6rwGIlrxe7ReHzRHDds6GHYHJepXTjFk2g0oaYBR7zKvryNSBjwmpF6\"", \""cyM6dO3MY1d6HIWX64ABPzm6KAtScgOOU4YFQ9No5ydIaLemiOwa2iSsr0hTr8Xy\"", \""ZQcILvVNTSNYMLTpkbQ5MgTGPCmodsgIYofU2gKsZAFFuG7MIV9fQJb11Dgo6LEd\""]','2007-03-20','2024-01-19 00:00:00','[\""gMmQ23WA2GgDfu6HSoXnf6ze6uxeXslHkEvwWlYoV21sJqHtwaQ6DgSytKg46mdQ\"", \""Rcd7TgmEMWWIcYa5PQIqfqfJi6CAv2OKjx5zsENs2c9vCL3XkebqyljXOo14jE1J\"", \""956AAzHAuYivb08aLX32dAsgsmsTerZfmnZZm8yGJziH4xR5T0bmg0U66TJJGFiD\"", \""laC5C5HFmaszxNWTRCkmQDfrZP1JaxwWa72bkarFnZE0scosoJApByv3TUpHkVHp\"", \""RKO7OHN10qlb6n8ybYzCQm1d9oTuWwKWHgNaD4Nxo1zg2Cf4nSmyp3h3VRYRVNUV\""]','2031-05-05 00:00:00','[0.8060840636775954, 0.642041104435424, 0.9540080687107967, 0.16041433481692366, 0.17091702212789037]'),('[\""QBgccD8tseIKMri76e5TNDC1KND9SXcHV0fC635SkOq750HioW8ms7ZJacdhT2nr\""]','1999-05-05','1997-05-06 00:00:00','[\""YxHvXhTcvNwVpXlrDb3D5zxl0dNTF3i22IC8J9rWwo9wScVSwzvAABQacT5MuTEA\"", \""6OVblnkf9N6J76G9kKUK9VhcDTdpJKTSYNJiGkRRK5o4jKgxHJGqBNLrcoUYigOV\"", \""03Fc8yTgxq56RzogtJispWmwh66T1yJHDFj3YMXHoYukONGGestUBATPJYKJwHcA\""]','2011-07-19 00:00:00','[0.15579453147694006, 0.33177963066270505, 0.6908690844097451]'),('[\""cJe7aECw1jZ8tIFf3Dp3PASUpkRNpicEI6BsON6EG2mE7YeyOlT9ceKNw8UEFsm3\""]','2014-03-29','1984-04-13 00:00:00','[\""VjcRYwofJra048jsmcjOgHdDwVRpgdLpRHptjkexfZ2J0wbZso7HhNg3FjExsqBb\"", \""M3JMRpxrvDHLxjNPetwHdTBAGC2bT8Ip5Ggz2uB0J2Ut3OTwzlgmAnHHGEIMfMP2\""]','1970-04-08 00:00:00','[0.948916749838948, 0.4206918428771202, 0.060679772047249565, 0.6640076525615456, 0.9889790975833586]'),('[\""QPDXlJUd6pPvZA5QOvoReTmLOPsualhhFaVlzR6cIyJPi0KMX6vx1ADxQlJz2MH5\"", \""yHZkFndm6PsXnkMCrNS6GZ1OiCneMH7kn7b8V430VBfuEZFGqS3EtVPtYFSkx55z\"", \""bgLgA6OPMHfCXXQa34ySRvsVwPoZdew8WSAtsq0jS8rXJWo4mxlcikp08HxXDaKK\"", \""2ybme9e9vi7rZE6FNTrB1iK8p530dFANOBSVaul6Gs0rQL0dWten1266X6SZAsR4\""]','2025-09-15','1974-06-13 00:00:00','[\""pTueF7kXbrxzIl3XSIN3UkdNtFi4fATx05WvoXpYa2kz5Cfit5ubPJcIxkjmM29U\"", \""Q3aANhK23M2CHSKQ30jSoVqpjTVEPvYFYhhQtrifVIqDTObjnLxiQBfcx7mzDfV4\"", \""yfKYZxbYHmlui6aYRv9s91jYgl3MYNV9LBqUejTWcpe4M318UNo6k8sjCBi6g57x\"", \""0HfvYYaydDCszMy61iXEM3kd5qZOyDmwrFSHoWvD1PHe7OpaEOiR5g1Sh0qsY9A8\"", \""j8ODaeU8s8bSPGULUoeY3dnOrr30fHtMDli6GQYQ9YwaIbe9dFIQaPf3NFIpCZfa\""]','1984-11-15 00:00:00','[0.528994129000875, 0.5605515770867295, 0.14821028305828848, 0.7982894590510905]'),('[\""IXa4DtqGB6dKD970f0NzaZvh9J9QoCxDWz7VguwOetmYDMw7wiFOLiLjTtg76Rtb\""]','2020-04-20','1979-03-28 00:00:00','[\""rx8LbV9DqLV64tGwMsUdurNlLzBfuKQeCDb22EFd7EDGxa7EDLPlHUfSKICJynzu\"", \""DnxAsbjND7e0bbUSFCxw1xfMlMfN0jCtgdcepl4AM9Sy7YBUvlZ5h4g1Cf95fwGW\"", \""x1vF8noZ2Yyc6GIVT8nzRxV4E1g9lKRrdzUz6A4R6Y4NEilkloGovrwgMRtzFWlw\"", \""zeRgr2CzG7Sotb9b67PeK7ZsD40GuSMxtN1llKZnuCA9sNRV7Ivek35YSEFWdOLh\""]','2006-08-02 00:00:00','[0.20630171921895388]'),('[\""XQx3ozCSGuybB7EjxI4yFVKguvLO9Cazz2YSVdx1kLFaNE1jZRiAsAgyHupkEPHa\"", \""PgsskxaCcbQjWrN3xMtQ1j9YmYxi0dtIrfU48qHBvKlewTJXD7h0bJPJJZmrRjK3\""]','1971-10-25','1975-08-15 00:00:00','[\""dWaMem5dnRjpA0uwV1VrZfk27lWS64UwuOrXA9qhYhNbRr6pyGbqZdMRRyIyXRWq\"", \""N77MnMCUp04o0XW3BA43WQKNOeon6X6wTToC8YhyIIoIoPkHVBkWFNBEDmxptgKU\"", \""DcdKzACPOrqEZbqMCUwIrOsbp3bvfd0LiOGDg2LnC0fwTz9i5cwZWAh7WzRtyc7z\"", \""l8IudkXbnTtGuxCZTfayBPTx1hAVHzCMAcisbXqIGG427n0zZbQDS4yZHBLQv0W3\""]','2009-06-22 00:00:00','[0.1593263193234567, 0.34035088779449396]'),('[\""YsgzLdXz5IvB5q29G1stCXvey0r3qTWv9RDvH27vHYAQ3st3xanrZA80nKH6jD4L\"", \""jq8O5pL5cgKcJzU6ujK0CfulhD6Aw78KcCFv5r3FIKGvsxMP03187UmwaAiDw4Cc\""]','2021-01-03','1981-02-20 00:00:00','[\""CnApJ3ILfwffcYx4AVz0Cs1AJxFOqicgJ0ollY5mxLJyHVoy15zURkx48Y688Ueg\"", \""4RBrHJFss2wvSeytKHS9mXEL2TqGiiTVXdxqgttv3oQbNZqVhte97YIbp7y2qC5W\"", \""3r8H6M1wBvUh6vUjIKVpHHDscC2oBRpRN0yb1UAIGL4jIwwV8FrPUjX8i85kPI6W\"", \""FTzBK1fsUTT3rTDHju1YsNVcOXsT7wsoZ5RBzS6SQMTlLNpR6i3qRdEOeZPNc5xO\""]','2022-12-13 00:00:00','[0.8754196728271935, 0.7141393404122288, 0.8235300556896564, 0.21554555345927504]'),('[\""YPbysJv1X3lCkxukFNzZtLVycSmr3CvD6JSMWIdMgT7Z1ISGJ3M4xHm2orZ2QFVr\"", \""e2hSaC3Ldwlc0EBQqY7qhwObdz3YyGOTO0Fe8Zn8pgTWBrO4PM4iwaNvxEAa7PrK\"", \""fQVlbj4p6Q1YlhHuFrlEaHQcMAkmjZThLdwAxiZmABdeAIqoxh0hM8CD3wMxY75o\"", \""eQHI3dvwoyPMxFodcRBDaHWnAcTnRP5i8h3GRuEEYjo1jUD1bjDZ3v4HyBwEOO8b\"", \""qIzJgGbjbgfgUWMFhBT2VVV5fFnSUczrtNo4IWjjF81Ap5L1TxExAnLxpBkC95ah\""]','2017-04-08','1998-06-24 00:00:00','[\""4Jo3SnJY3uWZ690agQdv04Mw9VVOlEm5CyFF0jqdSsFd6ql2PnaVlT7b7049vwVB\"", \""3vptqqQxLhKkV0XcYtarCW1MatDchxuOBdOelFGqI7yIJ7U7BbTN7sOEZWYr4Fut\""]','2021-03-27 00:00:00','[0.8180578937136436, 0.8131665260858524]'),('[\""HUfwMryglH8wPdd8OZw1bckCiDTOyXYQQwT8D2239tXmYhW6DOoTIf4qpgXWIi4O\""]','1990-11-18','1990-02-27 00:00:00','[\""Uqh84j0LJe6QQopi8E8zguLx6gvQh51rWUj2NvwxYZYgc0wLMfPnEoTIgl3rgEBd\"", \""y9YUfwoorTSm4Z0a27GMo5tqXvQO8W1DgAT9aNUGfPvQNuIQLmFjOGPxFrul5Evf\"", \""VE7LZG9sudeAKZA1msozHQ6JWlrl66oOy3Kf1dfpM6WSlly9JwBXA1P9YMT5SQhV\"", \""Ogo9MbqIy0Qhn77JHmCudeSHnXbYRfgAzqWThmVCCp3pBL1lEOJHnOEJ4ztJ6Bmz\""]','1982-01-06 00:00:00','[0.026131386523690858, 0.6585488872343441, 0.7635409061946831, 0.7872914525072943, 0.7307815826642772]'),('[\""3MyUaU7dGrxc6J1hzHJjHDSxVkwhUwueAw85KpgOrJxSudErBuQiFulfX1kvkf1s\"", \""H2MZF255TutMRr9u1D3fuqyaTED8KSlJwBTTxbEo4qnB4xibTH3pXUyFppbC0K8K\""]','2028-06-11','1979-07-11 00:00:00','[\""vyMQejcEh6sfk8EOvn2lhMISLaLHhUNOK00IIQxHpT0ZQCEojSDwaTiLoOoEVExp\"", \""220ZT51lWbVasBS6khvK6MGrC0Q4eCQeUTnKF8CpEMtwjas16RyHdxZSnh7yZY6J\""]','2019-11-17 00:00:00','[0.34063902254564044, 0.5850040729325597, 0.33365817698661265]'),('[\""F0WE8GwxgchAX5GKtmDbplAdqjnFUhzO0QHpHRKOOPsaOI5EQKS3rAm04oWSyT0M\"", \""WPe1speeGef34rHBW16rABnRdh0aozu5kwYvByNOVR6vXkvAvcs0vNpnrgBxk41A\""]','2020-11-23','1979-07-08 00:00:00','[\""mehvg2vnm2GYOP7EicBn5qY8U9fTlHO8mkf2SetLGjvffEMPA4pXOVXWssak1qJW\"", \""Jw4LUVcpgL4NP6CzQyTrzwvqprbijQk4n7fjFB28SdSGv4jWzbfEAuWyrhlOFK1L\"", \""wFgMdJnOrmwDA6fmrW1WfqFNG2tCJMNBD7Y1pbtQerbVnkuiG7ehgki5lqK7a7PI\""]','2007-06-06 00:00:00','[0.054501327314774584, 0.6916573434014444, 0.31421126805111077]'),('[\""9Ed67fshAce8zp834HvpeGJwoJXAsEqaebx9o3UWmGnSkJzlpO3CMD4oi1p4PMdl\"", \""j9eKWlYdAzjbpm7MQQys2aaTvTpYfWKAMyyeVszqQuX5NWqByeeWbqNF5VvDhprg\"", \""5kzqDeETLhUeMuIPapja8RNrMq0LvvW1u6Q7bKABJeVr74cJjmdJxKe8nOV4NhSO\"", \""dqb41x1E4n52q3eR2Hh7itWE9fxOr7uaTtHEauGEy7TivloPRcwz4W6eW6K4LMVE\"", \""Jbksc4mOrG7QnNXu37PxY36LNnvoRucQBv8bZtx2KsEqnSyZEsB1SusRYuF9ilix\""]','1971-08-15','2016-10-20 00:00:00','[\""J89C1L3nNMtgnzWwsFxsXVXNsJRXdjYgx2FuxGAcmMZPVE9QtCWIWYWpogsNmIIJ\"", \""lwI5my3KSA01P6nKaLUrO8ecoIiCIGatMqxqf8RzSx78BjfsIMGdULPeRyBUiDIW\"", \""UYXQpYmNOwYpA9jJA0fNctp7kXrv9D6zZCmsOMTTh8beqi8BQyVMqdlES8xi9kIh\"", \""opcu1kwvta6M0vSSeK5udcfYRxzikmBlnoQjVjKuw9kiK7oSinvB96450hz9OgkZ\"", \""opfEE4DsabUCk6Dbo5d8tK00WAM9XuwXZ4q5YI8OfHjAz1mAABFPYX5QC9TyDyrE\""]','1978-11-09 00:00:00','[0.2865868953743651]'),('[\""ZrYlI4JWMtO6Lpa9FY8u7f1juHGtz6MlYqZfDIgfQDG1XYI48NVnmqfOq2cuBTwc\"", \""1qMtPySwSbmpCA3TCjdGQF3OhsqGgZHpN6WtCnfeIdUZxBP2yyzXyG3n44tvOOnn\""]','2024-08-06','2007-08-09 00:00:00','[\""P3SZzNHLfRNfoXDZC1VUjgd0ZUAaVq8Fu1a4ZWh9MAwA5QHfRBg1avigFIguzSYb\"", \""ItWoS4y2dvNXM7K74Co1RUfxNvcV05nyJZ2Ii7ZAhMsZhYvKGDlGPORFNZ2Morn2\""]','1984-05-17 00:00:00','[0.33445322853416226, 0.42247847640391006, 0.6980432085867009, 0.8656718784348065, 0.04832676111430641]'),('[\""dFlvqd7bdQREHugEx6N8aaXBStdJwmFatSvUYV2Afx9ejMWQXgLoh9wD1lHudVHq\"", \""GKj1KKUIAbOND7J4BwS3NAB7vpwemjT0BPRcrfDYT4wu3pwqfJW5AvCWZa389HUt\"", \""bpt0MklF3C5I4wkEl7XQ1xZMjU7viUTqcaJNveT44tveOFrSPNeCJTqoV0Pid1eP\""]','2024-11-08','2013-10-25 00:00:00','[\""xz6z9q2DHDSCjRmevHdBDhhpObsMnBkpIk0m0GBg2luuQ05aWuzD4SsZQst2GPwp\"", \""nBbgk1cAjS4Wads8hd8M7bOfiS0YoXgbD1ZkISKtDXVDW34zclrB71Q3VcfVqtxk\"", \""gDB6ug5fcXg6oEBKKvipRbkR9ioMQDUa6r31q2bKqMGOotnHz8UOgmiUI0nkybxy\""]','2012-05-31 00:00:00','[0.007774545162851695, 0.018373712783083588, 0.34495933769366577, 0.4936089832440795]'),('[\""5nx4PAHlqyhHXpvrBqm62qG1G4RRsJdve2l6N3nascCtkblRj6jkOpNsEqyyvDKs\"", \""zH9HHmj0tsxX3piJjEgoqNhkfA3gLZ7pi863FvkTrUaQDph1mcYTruAUPdkLxBo6\""]','2013-08-18','2025-04-25 00:00:00','[\""L8GYR71vGEsKU6cmQouPdGN8gt38qxTa4ytxMSg4HuLmu8h5OB8YvLBUM4HehCZy\"", \""zTFpLPZdDta9aPeNNaIPTA6hbRShQbwxT0LmZnLFc5Bz23OCqPYswKoq4cOuGtAf\""]','2015-07-13 00:00:00','[0.4500643614903652]'),('[\""8p9UqRaITcccEPH5j8axW93dQkdODlsdxqQcxQH6yrIdiVJdP39fPEPbd5cbh9Pz\""]','1977-06-05','1991-08-03 00:00:00','[\""38mUGUvdMHrJUMy8zEoEtH0CjJ8AGkLwaZLjym5NwgocyF1CWkgJNKcFOWlRAZmn\"", \""lsbnhWsqwEo9IK3pGjy3vIsaeCWlXRyGoTA9VWzKs9a14wLoYoBlAkja2h7ENa7S\"", \""M6cRcnSna4zRchaJAJwSo5A9Q3NeSemdSoPJVWXwsArA5DIktGBsFS0LAWwfE2WB\"", \""rnzG7E5a7jLdylrCqX3mgoE9lWpxYXbQ32sP8zoq9LidnKEjVFq13UB66eHFDCoM\"", \""nKiVohyrtMJw0UaHl6EWUf022m9D5UsaL4Tt3wyJnwS2S9tJI5cC7PBinbrNYUSI\""]','1994-07-30 00:00:00','[0.014740044389187237]'),('[\""SPoTAdmXpQUuC8DKgEZPdnX5wz1jlObeuLL32wr7ejzk2f1pMPMYPXpUTT8MoRDT\"", \""D1gKJmFHAUmwXQLRa2APw0xUghmzK2qqVm1kUjHKlAcsUbkZn6qsozyD8N2ww9Ad\""]','1982-03-18','2002-09-19 00:00:00','[\""H2jbiCofuyOqlDns2Oy8mDmX4FNR5nzbMqeFGjNLOwC5KOYM4G2R5Aeeep8gv4LE\"", \""CGT73BNm09mEUolTpnnBWwzfC29E8uKhuwjRq0gQo93UyuboEkMrXwcSrWRbSPVl\"", \""9MJLefyZvr4GiwIx6mrmtiLPmSREKksbXI2jENM8QKsvswGRhUPoon0at1RdxkwG\""]','1975-11-06 00:00:00','[0.7716774375944869]'),('[\""mLijrizdfV3tuIAUq1GtXpX1GwpeFGy7UIUhdjBGOknyjDUpovboGQ0JzpvBz4Jc\"", \""HkpLqRIibx4sy9akMXIjXhkg5lRynMqmnlbCSL87OlSG9GDnB1Of34wjvWOO3MdZ\"", \""zyAI0M5pF53pG7QG0mfV8Q1DIMPIRZXa92RQxV0pGhDWnT6DLM6jg40YAkU7Awwf\"", \""OoRFK2PCQMAkH76MYGyRdozARIMV33yiSRanB7Hti3ysrRYGNAwXj1rx2XSlbEbH\"", \""IaBWfERuSJmWTh3FO36IszI02nFVdqcsAOL4VjMX0WypVff4RlFBQxLVsgBMcZqD\""]','2029-08-30','2020-05-20 00:00:00','[\""HP8wc6rxGE3KUEdu0szMdOQnyCJzQ6RPfVtUl3Sl5R3W8YOVMCvZMX0XcszeuZvK\"", \""vqPblY3uRrJXwgmy0JuAeOEsMc6B0aofX4Ysv0Z8lY9IaLIPcpVu007MBu7bHYbB\""]','2023-04-17 00:00:00','[0.2100180343726104, 0.5288731985948688, 0.29053431791941275]'),('[\""uvqMmRpzy4QFvYmSDfrGeY9qUsLYxSu9ZW9pN8SZCzZzrpaYcgB5lZbzTPd5p9Zz\"", \""Ir4meUN0y6rG8S2TM99QYL3cbk9xE3kOlUAwfPfoJEm0nsESpSYSqfEqKsa65PX7\""]','2013-09-29','1996-05-25 00:00:00','[\""Igdi0XIAlQ7OkGbEkXjllBg9qKwAwwWyWXIJjlIgyobLhN6eLL0yrMTBXsO5fgcF\"", \""rYYaFjdBEvZ5bkenyy6V5pumaYy6aclhQDkHyrgEd9x2u0BhC5PRC00pj9aSDTIE\"", \""S3APWVpiIq7TcYunGnTwFvVpDlbDGMRkDCoNEZwvATX0HWyFQ9MHsWZ8SthCpncg\""]','1985-04-21 00:00:00','[0.5205479611252712, 0.4833118971041047, 0.8880511436007136, 0.7291263090168532]'),('[\""uqiIZanZRB2Hp44P3TIen2MdoPgsP8K3eSc9GwwCEROdHIf8xWEYQAn0cmdCikPf\"", \""8yAhWDqGQvMnfZqciF0AXcI9CxcTmTsOeUKF1Eo2n6G3EPnZ1zOlOSMNp2ORXign\"", \""KCh3NS5TCSmUGRhAizVhutCdskSVJveMVf19OMIiHkjUCwnbPwz8mqLdaKJX7b1n\"", \""q9xAUMs9SxWu59Z9kmcokoW99YHmOZNYwADW8qwTq7cY0mpbwA8Y2myHCEPG1NUt\""]','2015-06-07','2032-12-11 00:00:00','[\""cgsX8drEa662W6Wv394ct1VCQhpzXeJEpoqkf3S2pEPXPn32NOUMjrIvOB6qqWL9\"", \""A8kxBeaw3CtIMYtnLIbH4wbxyhkAFi03h43L4T4ceGVeMb2r5oJkEtcnRXnBGrlT\"", \""z19caFCRGnz7NK5nhMOMARLKx111O88FTKB7axW2XypY9YgOeHO11uiKf7YAmjDr\""]','1995-06-11 00:00:00','[0.5648117356635188, 0.5385770398212066, 0.4740902785263248, 0.7296322307810768]'),('[\""CuyMtWnPOm5m8R7FBh6iypyFO15gEJyxOQ5hYNAm8biWNNW9gCDQb6Ez6TimIRCF\"", \""lm0UnWOOqnvHsNv2IMPjF7PeYCCXmI3oyHo93cY2hOcLyrRjFag6vGFSGS70DtEz\""]','1989-02-11','2023-07-22 00:00:00','[\""5DMqdanoOjtJDRLNwkQqUouRnJznILFEtsgcsBavYvnCu6Jqy1lcTKJGYtuKVD2Y\"", \""zyzw1U4bJ21LhHo7xhfXYKbOmMqPW1rhCuiMhPsQQ2jVo4dSb5SxgBhY0vRLamdz\"", \""WcuWLYUB5M1SDDkSlOx5aVIAizkX82KjbVVocnY6koQKqOxJVMpi7H6EDEczWNwN\""]','2015-05-08 00:00:00','[0.6426271847645817, 0.9162404778297084, 0.8061965421391227, 0.3191241916987836, 0.8786555615760616]'),('[\""XTmNuxoni9aUgRfHA7f2mqFsh5oaSAdEoghgHYke7K8maZ2fQjvee9tVbTulaKaE\"", \""ndVt2iJNyuGdJT6owDtYXVXsqU2tPm8NjxtttitSbsWusL4DvWk2s0itUD5S15xk\"", \""NksN5L7bUDgIJvH4K76nS8NabdIcIrd9JVOu20R1yzCX0c3B0xtMAl2fzkqsvVoE\""]','1975-03-04','2019-05-29 00:00:00','[\""yDgqCzMMivMI85kANtgeU3RZTdmYxiHQbgXOu7ifCQbtjOF6vh9pTacV6ujO4hDA\"", \""f6wGdaA610izP3HNw45VkTVAZekLE9TgRGNZ9JrhxCVkoNlFxdtwe0OGr3OhgqDy\"", \""tnUrjtEa5zGvbHmLQjBwOMHhC0CkSFY0SdIJAxFxVGlYrFFWoPyNH2f28vsHn99m\"", \""jOoEENMrOfst4RJ0rv5fN8xsGoMu268kfa5wGD9nSN79F0AUOMTHnJBtiicUMeSq\""]','1992-05-08 00:00:00','[0.01350922371878786, 0.5072105171964445, 0.9585680740487551, 0.7358299994294016]'),('[\""jYQ3z4yNucM6cOnCL7RPFoSfv3aLLzx8JWf7OAud9uFRg6WREGTGvMXhw1P0aZoq\"", \""jmwjQvPc7shQy5UPKZ4CM8AaD4plydZgDNfari5mDER8Cxwl5XgeHfRoqn66ikBT\"", \""R5S8GPCeLxP3yvZQXoXWlrwfRRR4aBpHhpXpaOerBnLkguONZKNpYu3XhnV5yVJv\"", \""rqN1HvZ7MBn7INFKfKxWIoBKBXcF34O4S9MNieTXu2as3XtRNzVxv5dy4U1C6D7N\""]','2013-02-02','2008-04-10 00:00:00','[\""3CSFgVXyxJiFnnGEEKtkS9wvsvW6EcpShA386RsbmohQwv2mg9C31l3EdTQgJK2p\"", \""KVmFiU3WFQwuRwUAPadLeJmr3jyD3QQ13eZABRf040Z7MlgyKGPn22GeGCzfJ5hN\"", \""gQNvCAmOpVqF4hAglYVnHdWT3twYnLfssVnswpW6vX6WS1027IFprY4763IUEb4M\"", \""TXWgoPzoSBb0iyNYynFM0nZPV6kT6ytNVl6k1WPTxogcKSPuD7PEllJWqbw1MSVx\"", \""GnjNN4xhOFggCK2uTZqGmACnP78B9oOTmP47PvbYEbT7Dz15EbfCaoaEZfLZsPur\""]','2034-07-20 00:00:00','[0.5898806239693096]'),('[\""eE4b4IIWmibUmvH45vzvx6jN1wbwPn6LZzSjP0uVwq4yggwoqD99KXHztNYCQ1I4\"", \""gwkvNw9PNvKOQZok2iH7rRZNdHZ3I9HaRxsb77nfXBsS3FvxazSunD0cIS9omEw7\"", \""bv8vFaG0jdzCKVPyWpnN3dZdrBUyk75vc9aJas2nhKg4gpPKOYYgwCWjwiOOyWUF\"", \""n5jXPO4GhjVrzJd57Zn1siTgu5HsMXuG5kZiuR6rKvtrtQVFA4q8k1M4ljuim2WK\"", \""q1lOtwYt4YHIVvA066rikIL1q5k5W6xS7TtUkMQwAQcLpNQUlnRZYL7HMPu92VeE\""]','2007-02-03','1980-08-12 00:00:00','[\""b2Crpf9zsy4MZRUZQhLAGiFtMCt0IilZalTwvc7XllyhKgdSK0Uvf0kmmJ6LA84O\"", \""6OJqcICSkQV1dx0T0ImzCyPydlm5zcRsv4O5Xqlv8aiHgSK1WFj2ZcnayMU7Uq0H\"", \""eeb2AUlxIMFXoSCkmoyEPHbVLwJJwW2o8AtOp2zORb1F0etZT3Bgi8Opdj3kqcJr\""]','1975-11-20 00:00:00','[0.7095289813412694]'),('[\""qVTi754IOSmfaCpqJiASWDopeQZcrRv9Wps08HYikCe1GvkORj46AFXafXUjI5Hf\""]','2031-05-26','1998-01-06 00:00:00','[\""2mEHXOK5BS0KdygGC85nnQfKBej3ElHBnhmgSA9lKoh2PsTp7yDUJD6XnKgKGQAa\"", \""i2E2aw1zINVGDaeb4SRfTfDjcsfe8vP2p57OXgIM91Llqfhot33dNtZFghM6ocm7\""]','2014-02-11 00:00:00','[0.30204438320967697]'),('[\""6FrALKao6NCXhgZRn4a2mFjAPKEWNKKuNiyI3SGQa8yxJOgzIUt20Sk6osChKRpr\"", \""4S3M2ioWWLBjDUFNHg30O2hH4X4IG8m6JlvoOCef07pMhrzNnITBV32nSxNHZ6mY\"", \""VVdgBtldDI7WSFei8sdGA4vmNxWeIit2neeea2fmtWZ5hqk9WNzib9m3RrdwH3mg\""]','2006-09-28','1974-06-14 00:00:00','[\""MilzGZV7UUyiWJSnIuyqRbZ9hka1T07A7yThFgwxTzsAISbdDgPn8wliOS9ph0We\"", \""xh9Y14LVy4yoTpcXDbkx47fZbh6kQkLVgKMT8RsgIIZMYojmOcnx37aZJ5FjAxp5\""]','2021-02-04 00:00:00','[0.1817475434478905, 0.04947526469145963, 0.11897320857692152]'),('[\""r6f1CTcubN6E3w8OTe062efIGFPFyCUlGMZA9LzUDvEZqiugRSQXQsn2IZOA5Xzp\"", \""6wiwf7FWTtNbmY46D9aubLI21ZxEK2mcLHU41Ik1DPadH6jnFhizsM51qiW6Szaf\"", \""2OdIDWyIEDXMRrKRQ45RYtjCaAj80pTxbPR3FhGSrTTxFOW7avxjFR91rgJtOIBY\""]','2034-12-25','1984-06-16 00:00:00','[\""Xiz7ZZSQCN9dDO8wfpAxqnzgYXebwmklxY7rcU3JH59g8P6fjNOM7BliEVWyfyhb\"", \""n9sMsY54SzZuQBwsy3g015ot28Tb8en2vBuMwzPGQ1x21RGiVUU6kXnQwAK232sb\"", \""XotC7vn6ilZuR7BldjiRsaTNGbLDSevuFST3EzIxiRznoeTOvXukihoosKQX2A6a\"", \""ExVoA4du4ao5FLVsUiZfjvSwvc8yx4QlrmpNDbuGPMlvXr2dVM1RK2rJBuprhr5F\""]','1974-12-17 00:00:00','[0.7622978727040536, 0.550288819397284, 0.6478534317044453, 0.574880285886972, 0.8104694325088238]'),('[\""Nfg9MB9c93xk3t3pl9ZHnZcD5BTls8tmptUugPtlH7kyc6fh2uQr8OnXbflbKVrJ\"", \""PczPlfQsY1RvdTagXd6PM9zO8mN6u4l0PhmVLhLKjhkKUo8HJEW5hY5qZHxfSj2e\"", \""auGk7o0NAuOfQsCFTmL91VHdAf70YbhRHewAryq58bYXsrJTlO33EZhCIDWKPTn8\"", \""5ypcpkL08yeWfNW2X5SOilzXZ1NOc1kxUVWzySCtcgx2EVuXNIQ1rf3dM8dY12ij\""]','2008-02-23','1983-01-15 00:00:00','[\""IkGRNZuuZ3XVnVIxkHOib0kHM7JFeqGAKZYexnNNOj4XC2KJEGweM9kT2rPuvicP\""]','1981-07-04 00:00:00','[0.9102220819633761, 0.4714516249325858, 0.4190343694839622]'),('[\""yfsdIPmrpLPHGqA9pNP8ac6EUR0HJFxS34Yp5NZvdAYBKRmHZyQFAN6bZUnSb9qr\"", \""9Flmqn8x4M8X1X3VnoDLFV8ghPMGcyVWeYfgXkkO1y3FsuDe6jBqblRo96XWBA7r\"", \""HgnaXXR4xInO5uyL6c4EW8U4F1kbfhciWwyOBVJKFeJ6CXdzZQZ5bF3IdfZNfgo2\"", \""1jXZzQuPn11TEEKyFpmsStpkYMG1sn57yJrL5OnC53fxXRXjDJCdnmsZat3DlBRL\""]','1992-09-14','2000-05-22 00:00:00','[\""hXxe1sPw6pRBIZagetKI6BoS89b4wfKn2VtAXB0Bw2cZTzTd0TANg26wbwePGWB6\"", \""Ik746SMiWnoOyzp2oP9iFTkrsRftijVjLYpLHOVQfreS2lxbJFgX2p6V7rtFzGn3\"", \""oxnXl58oVtBsDm0hLdFXajGA7ZUYsOGsULW5l2v4O0ScBuHMjH3BAFgMGiNDJ3Ho\""]','1986-05-10 00:00:00','[0.9579275304888738]'),('[\""WSWmwBhfYxMI8Rx8DSBdbA2bNtx1DGqFQOl2VdHrUGGIN3SnTTkmgzSUh86XEf8H\"", \""fSyTyNFhNdLtDFVDDO4rVTQjtQIUiK5g6sM52Hlivyl3ioJ3BbzNguE4Eqbs1oFK\""]','2031-06-04','1995-08-27 00:00:00','[\""QUo7iRYo7W6WgaGAvomNdR9wFjlKWQYnvSJ2B9XlpLJn2BHngwSKCqGQ8Tz36S2w\""]','2011-11-06 00:00:00','[0.27425788776763105, 0.8558269035458208, 0.5002935869406752, 0.9848318085928289]'),('[\""4Jk373n5CII88haXS42bG3jLeyAVtBRqDrVABl94hXgzIEvtpEnT77fAqwpmjZRO\"", \""Cq8o3R8KGHEIMTEz0Hdv3kglQ6F1J5vwwx8Mp0Zf1HEnBelFrAaHY4eIajF0iiSQ\"", \""KTIC001ymGERG2m54QvapbewzNl3rc8N9vtKYhNwfTgCRPtbfe2b6N113Qi83rZd\""]','1983-10-29','2031-09-18 00:00:00','[\""r7pDTX3AThTGW0oC0l3mrrOYzTcM2idITy1yxjGPeLfjAVcdr6WSGMtQYo0Euy6c\"", \""ZWF4SFZ2nfHG5ZZbLhGkNNOO0vnxtDcDRMZK0cQ8vrtje9nwR0FWhoSgQF6HfAy4\"", \""Ywctz9IGkTjoEphmWkcFELUd4nwfnGVZ6u6scPSJA7943IW6A2Ym8vuOubg6XLsX\"", \""QCf3uUPYT5cxaPNYKZOSVqLd3EGCTygiXtrTklfe0aUr5lKC2V9hUPbeFzJPyPW7\""]','1977-09-19 00:00:00','[0.6683491899661822, 0.2984031402684146, 0.28247967809615726, 0.028400568045308293, 0.630651915875849]'),('[\""NU3Mf3vmj0PGQEnBIFuqZip20NgPWK7RX9LN4v3Ocu3KO5KvjLPbvoplawgO1cAU\"", \""GZQZObn4h3H6lUrh5E3uD9HIdl28CZTpHXMye1g5rzl8ignvuanNp257a3hfmKb7\"", \""MlM1xPyNck5PzgVDIHIXHhfOqW8pAKcUkytUkk6NlDM3wlixnU3gH6ZzqdsYRKhY\""]','1991-04-16','2020-04-05 00:00:00','[\""XggXsuRXzidUfpJqUQC9GDx2mDWcrn2VMygrpFdy0Lf4mlpNKUnPLIuHz3qfx912\""]','2020-11-03 00:00:00','[0.26511703221350175, 0.04429804919254248, 0.08027287360090749, 0.9063692551468664, 0.37159171748060377]'),('[\""14JAyt1S3rl5aPifNk75tL9My0nuqOb6mn45MAkfTggVFceEjr7pwiWQNGKVhB05\"", \""YwbrqH0nm2FjN3tXBlhgCDhqiGVHORKXeMGlij569txCC9D7k5Xhc5wDNLNXdTUd\"", \""Cnwtmg26OnJQbn0wUY1UuKgvKcqi6h634LOaX7Nc4dBlzBfWZQLIHHwrG1QPwg5a\"", \""sgvLSgcEAQahs9ENMI1ssVW4ccvNAlwRs6lQu0M6qbS3WtWYzfYTeOmwpKXFQzhN\"", \""ebQzSTflkL4xXmr9pGteQr5w03zbry7LKmsgdFThFJIulHykDwvSNB3sATM7vrxF\""]','1992-01-18','1979-03-30 00:00:00','[\""W8pSjXlBXKESmAvCDe8nl7ugcFGZJ6XPB6O65lKD9vmt7WMCbSqpTSwktLipGslx\"", \""hLR1CCrlK0ImFuDvgxY5UnElbkDkGfcF3eyPwjQhfLapuQjYE11GJvxdlgWOs4TU\""]','2011-11-23 00:00:00','[0.5736748735516263, 0.9721622442070186, 0.5201736855560637]'),('[\""bYpuouwFJrTWhq5Cn8Qke1NQ7Dti1Lrcledhbsos6j3Nj22CSHT1d87Tv3XtKOlJ\"", \""KgmseOr4kzvUN0eUodaITvqwaULbvMA6tzTVRCNMhKNyIsajY5ECkzfmq4nIsBVQ\"", \""JKl7yTHB1DX67bhbwOxah4QnBMYiHDZMdtT5QiTIboFpdmTvGspidZCdweyFNW3a\""]','1992-09-08','2018-06-02 00:00:00','[\""hG3rK2QeFBtwLuJ3ZteKFGq0BDNYmMcIKiXvV9kVNrNTqdEJHFMQNtL9G6IN12L8\"", \""YdyaPkOMTRTF0tF1RIu4lkrUKKY86j4gC7pJodH5aodOHKLDvvAwwzWnMoNZTkwl\"", \""aN0hO9WQbXPd22lGEN4qf4U558XAg4SnP3Z74awKfZz41ZUsot0cCyIHjBEv8ePB\"", \""7whFDYB1o5FHdk9EWF6y0psI0hOEG5blBzsBRK0dnxrXwcFtABB2S6FSGdlQtFUY\""]','1972-07-12 00:00:00','[0.3503955800144707, 0.7946302522533017, 0.733857653670291]'),('[\""OqiJaOEW7ePejHT5LfFksIbOWFASBppwajLOrudlXed9pDvOOreqXuHh0JNkCO81\"", \""rst9lKHCNWv3SD8JZ48R1GrFeqIPutKwaBoau8IsvuwHrWjwHnonyvfJXXSzsxTa\""]','2011-09-19','1992-01-22 00:00:00','[\""0LRURRNtwvrNRNunUdk73nszhvphIs2avQGcjhZXE0cNJkQDSxRrhtGch3mLgUMZ\"", \""QgIcTnO8Nrcpg4tQvlWta1GNoRZAdRDRlrTStwhd1L5GlChWCDVRAlOO0gkHzu5b\"", \""dCre8Tnr8oE3FdJk5xk8ihAhgHS6uIw9DG9WWLePbnZVRNMnRVaDZyipfvlDopII\"", \""dhvPh1A34k1sLSaazw4Muf1SjjOKG4uLeI9eYgem6pSm8LZ8cIlMX8kOAxp7FTBj\""]','2016-04-17 00:00:00','[0.6717135134579746, 0.9704113290689538, 0.06066643892762763, 0.03669350790819926]'),('[\""vV9XRAbZohgSthNUWGcyYIinogKNtlH5g4pK1i8uVJ7a6KQZvh5Uxb801qCrNa45\"", \""8K26RnNcHxt87Pj19ZeLZrAH4md6JLBY4GzzVjU5aTsfYQt4dSclv7O9X411WTGx\"", \""wCnUEnmvhklXfnZh8GDKO5Jwz5yAMuYOnTBTMZJJfRRxjhbeSwtwqgZ2NVrc1GkY\""]','2002-04-28','2009-03-06 00:00:00','[\""MJPxFkACq3eYUGok6FgbfOPEIbUx3i8C8zIy3Srf5snj1i8Zl1u8LjWpw35Hv4tr\"", \""aswyDTLhw7y0D0tYlx0JDkKvyhwwHkJkuh4NuzoKzPANKJEtPEzi2LuX12ukdYem\"", \""DP7qyYDq4gGHVJWU0IjGbprueZHqPz4RfSJ7ko8F4augyyzsf68WNpUIXOhz0GZ7\"", \""0s6tCopZXQIgNQqSZ52LdUEDwbxQhWSvbXncmXSfzMKcjkCROjoBXb0fVyLAqDVn\""]','2006-07-06 00:00:00','[0.8158090770480149, 0.9545080603120522, 0.7687410776212851, 0.6287726826718296, 0.0863719136006138]'),('[\""CT4e9RclIuqk5JxoMfc4qAKy685BKfcl2eWFSEQJwunrfTsQbL7u8mGt2Jc04yz5\"", \""aiwzHnLbJuAAEhciOc31To2n4j9cEXYS6f88K4J6cKim7KgDDIYsTHrj1viYufhi\"", \""AGZIh74KNFVODzMY68m06RYqUbkoqHkVC47pxIBoAmZjQGmBSG1WPEho9vWkll3i\"", \""w17PEZ7I36PCv30HeujJv2jDFPqhUMew64feOOz0ANISehx013L38gzN2TDKHarT\""]','1976-07-19','1989-04-11 00:00:00','[\""2fCS64TgSTkpc4GzhwRmwraRGxgyocIlgFLh4ySL8N2WP57T2D4w4EpIl7eoTRQB\"", \""Uh05REOtbU5j7PClHQfg5yTm9H5sHHijTvyrM6Q2PTAFals05KQsFUGVnmM8oTGR\""]','1998-07-23 00:00:00','[0.8692478970963795, 0.9862730054642267, 0.5459771173802278]'),('[\""6trQrYQqZgk2HgsUS5ZbSGlHG6k5jnrAIlySHXmILHD8nvlJkffcO4YsX8Re6E1P\"", \""DX6iXKwnEdakiE7tO1tzLgffsfhWev5KJYMBme3B0JaEAjXCmp7Dvf4Yjw7GJusN\""]','2002-04-21','1984-09-05 00:00:00','[\""VVbsc8rRsSAD9GwTUyzvJSGF5N3zQYiXbUBbI6SgzUbkT3GR1U74XEy8ez0b1nXM\"", \""3ORwrkcJuNLNcl0twEFF9bdasDhf0guvUzJ8rOTg9WUALNyS2onYkN0ZjKQLRXLc\"", \""jyBCTGJrzzRipMLz65XuEqH8YcxlrxmCDnsWJwbzhLewwFCYCQy0uFFvDdsGpFeb\"", \""gaK2lAOHqGbGjbOvqIZVdQaKqaCMPe7CLKqjxHsZLZ5IzAr4yE3dsgP2axwHSeSc\"", \""GFd0F9kkHyQtZkVsrHfkz9oDYOsvVEzjiMeKbxPjgJMP8q1Uua0B0gTPK5fqHxqc\""]','2028-02-18 00:00:00','[0.5471565929987244, 0.34350304848042856]');

WITH `cte_1465` (`col_7280`, `col_7281`, `col_7282`, `col_7283`) AS (SELECT /*+ USE_INDEX_MERGE(`tld1ce2472` )*/ LENGTH(`tld1ce2472`.`col_57`) AS `r0`,EXPORT_SET(2, `tld1ce2472`.`col_54`, `tld1ce2472`.`col_57`, '-', 8) AS `r1`,TRIM(`tld1ce2472`.`col_53`) AS `r2`,`tld1ce2472`.`col_53` AS `r3` FROM `tld1ce2472` WHERE NOT (JSON_CONTAINS(`tld1ce2472`.`col_52`, '""zhVuWVabjeEZQpf2c9KO8jpAy4W2U7gXSYUnpoAs502NuQyyJAn7VMRXmZjsEuMN""')) GROUP BY `tld1ce2472`.`col_53`,`tld1ce2472`.`col_57`,`tld1ce2472`.`col_54` HAVING `tld1ce2472`.`col_53` BETWEEN '1991-05-27' AND '2034-05-05' OR `tld1ce2472`.`col_54`<='2033-08-05' ORDER BY `r0`,`r1`,`r2`,`r3`), `cte_1466` (`col_7284`, `col_7285`) AS (SELECT /*+ INL_JOIN(`t9172e9ec`)*/ RIGHT(`ta0c4280a`.`col_64`, 4) AS `r0`,`ta0c4280a`.`col_64` AS `r1` FROM (`ta0c4280a`) JOIN `t9172e9ec` WHERE `ta0c4280a`.`col_64` IN ('09:41:40.00')) (SELECT 1 FROM (`cte_1466`) JOIN `cte_1465` WHERE NOT (ISNULL(`cte_1466`.`col_7285`)) AND `cte_1466`.`col_7284` BETWEEN '3-@3mtQ-2-b_z7$dNM' AND '4f' LIMIT 80246884);


```

### 2. What did you expect to see? (Required)

MySQL:
``` sql
mysql> WITH `cte_1465` (`col_7280`, `col_7281`, `col_7282`, `col_7283`) AS (SELECT /*+ USE_INDEX_MERGE(`tld1ce2472` )*/ LENGTH(`tld1ce2472`.`col_57`) AS `r0`,EXPORT_SET(2, `tld1ce2472`.`col_54`, `tld1ce2472`.`col_57`, '-', 8) AS `r1`,TRIM(`tld1ce2472`.`col_53`) AS `r2`,`tld1ce2472`.`col_53` AS `r3` FROM `tld1ce2472` WHERE NOT (JSON_CONTAINS(`tld1ce2472`.`col_52`, '""zhVuWVabjeEZQpf2c9KO8jpAy4W2U7gXSYUnpoAs502NuQyyJAn7VMRXmZjsEuMN""')) GROUP BY `tld1ce2472`.`col_53`,`tld1ce2472`.`col_57`,`tld1ce2472`.`col_54` HAVING `tld1ce2472`.`col_53` BETWEEN '1991-05-27' AND '2034-05-05' OR `tld1ce2472`.`col_54`<='2033-08-05' ORDER BY `r0`,`r1`,`r2`,`r3`), `cte_1466` (`col_7284`, `col_7285`) AS (SELECT /*+ INL_JOIN(`t9172e9ec`)*/ RIGHT(`ta0c4280a`.`col_64`, 4) AS `r0`,`ta0c4280a`.`col_64` AS `r1` FROM (`ta0c4280a`) JOIN `t9172e9ec` WHERE `ta0c4280a`.`col_64` IN ('09:41:40.00')) (SELECT 1 FROM (`cte_1466`) JOIN `cte_1465` WHERE NOT (ISNULL(`cte_1466`.`col_7285`)) AND `cte_1466`.`col_7284` BETWEEN '3-@3mtQ-2-b_z7$dNM' AND '4f' LIMIT 80246884);
Empty set, 2 warnings (0.00 sec)
```

### 3. What did you see instead (Required)
``` sql
1300 rows in set, 5 warnings (0.01 sec)
```
### 4. What is your TiDB version? (Required)
b69f81b91597ec2bfb7aa2d3356ea2b15c209cb7
<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53857,pingcap/tidb,2024-06-06 11:49:49+00:00,2024-11-01 10:02:54+00:00,,open,"['type/bug', 'sig/planner', 'severity/major', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'fuzz/randomtest', 'affects-8.1', 'impact/wrong-result', 'affects-8.2', 'affects-8.5']",Incorrect Query Result
Ingest writers leak when cancelling adding index job,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

1. Set `tidb_enable_dist_task = on`.
2. Run add index.
3. Cancel add index through `admin cancel ddl jobs X`.

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

Add index job is canceled normally, no other side effects.

### 3. What did you see instead (Required)

DDL worker panic. Ingest writers leak.
```
[2024/06/05 07:06:10.237 +00:00] [ERROR] [misc.go:114] [""panic in the recoverable goroutine""] [label=ddl-worker] [funcInfo=""worker 3, tp add index runDDLJob""] [r=""close of closed channel""] [stack=""[github.com/pingcap/tidb/pkg/util.Recover\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/util/misc.go:118\nruntime.gopanic\n\t/usr/local/go/src/runtime/panic.go:914\nruntime.closechan\n\t/usr/local/go/src/runtime/chan.go:365\ngithub.com/pingcap/tidb/pkg/lightning/backend/local.(*engineManager).closeEngine\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/lightning/backend/local/engine_mgr.go:373\ngithub.com/pingcap/tidb/pkg/lightning/backend/local.(*Backend).CloseEngine\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/lightning/backend/local/local.go:793\ngithub.com/pingcap/tidb/pkg/lightning/backend.engine.unsafeClose\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/lightning/backend/backend.go:345\ngithub.com/pingcap/tidb/pkg/lightning/backend.(*OpenedEngine).Close\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/lightning/backend/backend.go:291\ngithub.com/pingcap/tidb/pkg/ddl/ingest.(*engineInfo).Clean\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/ddl/ingest/engine.go:116\ngithub.com/pingcap/tidb/pkg/ddl/ingest.(*litBackendCtx).UnregisterEngines\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/ddl/ingest/engine_mgr.go:107\ngithub.com/pingcap/tidb/pkg/ddl/ingest.(*litBackendCtxMgr).Unregister\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/ddl/ingest/backend_mgr.go:300\ngithub.com/pingcap/tidb/pkg/ddl.convertAddIdxJob2RollbackJob\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/ddl/rollingback.go:95\ngith](http://github.com/pingcap/tidb/pkg/util.Recover/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/util/misc.go:118/nruntime.gopanic/n/t/usr/local/go/src/runtime/panic.go:914/nruntime.closechan/n/t/usr/local/go/src/runtime/chan.go:365/ngithub.com/pingcap/tidb/pkg/lightning/backend/local.(*engineManager).closeEngine/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/lightning/backend/local/engine_mgr.go:373/ngithub.com/pingcap/tidb/pkg/lightning/backend/local.(*Backend).CloseEngine/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/lightning/backend/local/local.go:793/ngithub.com/pingcap/tidb/pkg/lightning/backend.engine.unsafeClose/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/lightning/backend/backend.go:345/ngithub.com/pingcap/tidb/pkg/lightning/backend.(*OpenedEngine).Close/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/lightning/backend/backend.go:291/ngithub.com/pingcap/tidb/pkg/ddl/ingest.(*engineInfo).Clean/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/ddl/ingest/engine.go:116/ngithub.com/pingcap/tidb/pkg/ddl/ingest.(*litBackendCtx).UnregisterEngines/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/ddl/ingest/engine_mgr.go:107/ngithub.com/pingcap/tidb/pkg/ddl/ingest.(*litBackendCtxMgr).Unregister/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/ddl/ingest/backend_mgr.go:300/ngithub.com/pingcap/tidb/pkg/ddl.convertAddIdxJob2RollbackJob/n/t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/ddl/rollingback.go:95/ngith)
```

Here is the heap profile when there is no DDL running job.
![img_v3_02bi_41c351c0-8a5c-454f-8693-1a7d79e28b1g](https://github.com/pingcap/tidb/assets/24713065/6c9dbfca-1073-4e4c-b48d-27689577769d)


### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
f1ec74b3b8",https://github.com/pingcap/tidb/issues/53843,pingcap/tidb,2024-06-06 03:26:28+00:00,2024-08-05 03:32:36+00:00,2024-06-07 07:05:59+00:00,closed,"['type/bug', 'severity/major', 'component/ddl', 'impact/panic']",Memory Leak / Resource Exhaustion
fix unstable integration test for br,"## Bug Report

The br integration test `br_full_ddl` is unstable.",https://github.com/pingcap/tidb/issues/53835,pingcap/tidb,2024-06-05 10:23:52+00:00,2024-09-13 22:43:42+00:00,2024-09-13 22:43:42+00:00,closed,"['type/bug', 'severity/major', 'component/br', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1']",Performance Degradation
`memory_quota` hint doesn't work well with global binding,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

1. Start the TiDB cluster: `tiup playground v8.1.0`
2. Use sysbench to create a table and insert 100000 rows:
```sql
sysbench oltp_insert --table-size=100000 --mysql-db=test --mysql-user=root --mysql-port=4000 --mysql-host=127.0.0.1 prepare
sysbench oltp_insert --table-size=100000 --mysql-db=test --mysql-user=root --mysql-port=4000 --mysql-host=127.0.0.1 run
```
3. Try following SQLs:
```sql
use test;
create table sbtest2 like sbtest1;
insert into sbtest2 select * from sbtest1;
create table sbtest3 like sbtest1;
```
4. Try this SQLs with hint:

```sql

replace into  sbtest3 select /*+ memory_quota(2 GB) */ a.* from sbtest1 a, sbtest2 b where a.pad=b.pad  limit 0,10000;

create global binding for replace into sbtest3 select a.* from sbtest1 a, sbtest2 b where a.pad=b.pad  limit 0,10000 using replace into  sbtest3 select /*+ memory_quota(2 GB) */ a.* from sbtest1 a, sbtest2 b where a.pad=b.pad  limit 0,10000;


replace into sbtest3 select  a.* from sbtest1 a, sbtest2 b where a.pad=b.pad  limit 0,10000;
```

### 2. What did you expect to see? (Required)
All queries canceled by memory controller.

### 3. What did you see instead (Required)
```sql
mysql> replace into  sbtest3 select /*+ memory_quota(2 GB) */ a.* from sbtest1 a, sbtest2 b where a.pad=b.pad  limit 0,10000;
ERROR 8175 (HY000): Your query has been cancelled due to exceeding the allowed memory limit for a single SQL query. Please try narrowing your query scope or increase the tidb_mem_quota_query limit and try again.[conn=4011851786]

mysql> create global binding for replace into sbtest3 select a.* from sbtest1 a, sbtest2 b where a.pad=b.pad  limit 0,10000 using replace into  sbtest3 select /*+ memory_quota(2 GB) */ a.* from sbtest1 a, sbtest2 b where a.pad=b.pad  limit 0,10000;
Query OK, 0 rows affected (0.01 sec)

mysql> replace into sbtest3 select  a.* from sbtest1 a, sbtest2 b where a.pad=b.pad  limit 0,10000;
Query OK, 10000 rows affected (0.34 sec)
Records: 10000  Duplicates: 0  Warnings: 0
```

### 4. What is your TiDB version? (Required)

v8.1.0",https://github.com/pingcap/tidb/issues/53834,pingcap/tidb,2024-06-05 08:58:17+00:00,2024-06-19 09:21:17+00:00,2024-06-18 11:02:48+00:00,closed,"['type/bug', 'sig/planner', 'severity/major', 'affects-5.4', 'affects-6.1', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1', 'report/customer']",Data Corruption
TiDB cannot handle `non-breaking space character` correctly,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
1. Start the Tidb cluser
2. Use MySQL client to connect the TiDB server
3. Try `select * from test limit 1;`
<img width=""638"" alt=""image"" src=""https://github.com/pingcap/tidb/assets/29879298/7cf64506-0235-4705-a25f-150d3802e5de"">

This is a `non-breaking space character`.

### 2. What did you expect to see? (Required)
It works well.
I tested it on v5.1.2, it worked well.

### 3. What did you see instead (Required)

```sql
mysql> select * from test limit 1;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your TiDB version for the right syntax to use line 1 column 14 near "" from test limit 1""
```

### 4. What is your TiDB version? (Required)

- master
- v7.1.5
- v6.0.0",https://github.com/pingcap/tidb/issues/53833,pingcap/tidb,2024-06-05 07:13:31+00:00,2024-09-18 16:00:05+00:00,2024-06-06 05:53:25+00:00,closed,"['type/bug', 'sig/sql-infra', 'affects-6.1', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1', 'report/customer']",SQL Syntax / Parsing Error
POTENTIAL DEADLOCK: Recursive locking TestAutoCommitRespectsReadOnly,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
see https://do.pingcap.net/jenkins/blue/rest/organizations/jenkins/pipelines/pingcap/pipelines/tidb/pipelines/ghpr_unit_test/runs/10712/nodes/63/steps/69/log/?start=0
<!-- a step by step guide for reproducing the bug. -->
```
POTENTIAL DEADLOCK: Recursive locking:
current goroutine 123 lock 0xc007ef60c8
pkg/domain/sysvar_cache.go:120 domain.(*Domain).rebuildSysVarCache ??? <<<<<
pkg/domain/sysvar_cache.go:119 domain.(*Domain).rebuildSysVarCache ???
pkg/domain/domain.go:2639 domain.(*Domain).NotifyUpdateSysVarCache ???
pkg/session/session.go:1283 session.(*session).replaceGlobalVariablesTableValue ???
pkg/session/session.go:1344 session.(*session).SetGlobalSysVar ???
pkg/sessionctx/variable/sysvar.go:823 variable.glob..func164 ???
pkg/domain/sysvar_cache.go:146 domain.(*Domain).rebuildSysVarCache ???
pkg/domain/domain.go:2639 domain.(*Domain).NotifyUpdateSysVarCache ???
pkg/session/session.go:1283 session.(*session).replaceGlobalVariablesTableValue ???
pkg/session/session.go:1344 session.(*session).SetGlobalSysVar ???
pkg/executor/set.go:155 executor.(*SetExecutor).setSysVariable ???
pkg/executor/set.go:104 executor.(*SetExecutor).Next ???
pkg/executor/internal/exec/executor.go:409 exec.Next ???
pkg/executor/adapter.go:1212 executor.(*ExecStmt).next ???
pkg/executor/adapter.go:960 executor.(*ExecStmt).handleNoDelayExecutor ???
pkg/executor/adapter.go:794 executor.(*ExecStmt).handleNoDelay ???
pkg/executor/adapter.go:558 executor.(*ExecStmt).Exec ???
pkg/session/session.go:2284 session.runStmt ???
pkg/session/session.go:2162 session.(*session).ExecuteStmt ???
pkg/testkit/testkit.go:394 testkit.(*TestKit).ExecWithContext ???
external/com_github_pingcap_errors/juju_adaptor.go:112 errors.ErrorStack ???
pkg/testkit/testkit.go:150 testkit.(*TestKit).MustExec ???
pkg/session/test/txn/txn_test.go:298 txn_test.TestAutoCommitRespectsReadOnly ???

Previous place where the lock was grabbed (same goroutine)
pkg/domain/sysvar_cache.go:120 domain.(*Domain).rebuildSysVarCache ??? <<<<<
pkg/domain/sysvar_cache.go:119 domain.(*Domain).rebuildSysVarCache ???
pkg/domain/domain.go:2639 domain.(*Domain).NotifyUpdateSysVarCache ???
pkg/session/session.go:1283 session.(*session).replaceGlobalVariablesTableValue ???
pkg/session/session.go:1344 session.(*session).SetGlobalSysVar ???
pkg/executor/set.go:155 executor.(*SetExecutor).setSysVariable ???
pkg/executor/set.go:104 executor.(*SetExecutor).Next ???
pkg/executor/internal/exec/executor.go:409 exec.Next ???
pkg/executor/adapter.go:1212 executor.(*ExecStmt).next ???
pkg/executor/adapter.go:960 executor.(*ExecStmt).handleNoDelayExecutor ???
pkg/executor/adapter.go:794 executor.(*ExecStmt).handleNoDelay ???
pkg/executor/adapter.go:558 executor.(*ExecStmt).Exec ???
pkg/session/session.go:2284 session.runStmt ???
pkg/session/session.go:2162 session.(*session).ExecuteStmt ???
pkg/testkit/testkit.go:394 testkit.(*TestKit).ExecWithContext ???
external/com_github_pingcap_errors/juju_adaptor.go:112 errors.ErrorStack ???
pkg/testkit/testkit.go:150 testkit.(*TestKit).MustExec ???
pkg/session/test/txn/txn_test.go:298 txn_test.TestAutoCommitRespectsReadOnly ???

```

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)
master
<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53822,pingcap/tidb,2024-06-05 04:03:31+00:00,2024-08-14 13:22:40+00:00,2024-08-14 13:22:40+00:00,closed,"['type/bug', 'component/test', 'sig/sql-infra', 'severity/major', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1']",Deadlock
DATA RACE in the TestTableRestoreSuite,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

```
==================
WARNING: DATA RACE
Read at 0x00c000b4a508 by goroutine 224:
  github.com/pingcap/tidb/pkg/lightning/backend/tidb.(*tidbEncoder).Encode()
      pkg/lightning/backend/tidb/tidb.go:529 +0xcb
  github.com/pingcap/tidb/lightning/pkg/importer.(*chunkProcessor).encodeLoop()
      lightning/pkg/importer/chunk_process.go:458 +0x29a1
  github.com/pingcap/tidb/lightning/pkg/importer.(*chunkProcessor).process()
      lightning/pkg/importer/chunk_process.go:209 +0xbad
  github.com/pingcap/tidb/lightning/pkg/importer.(*TableImporter).preprocessEngine.func3()
      lightning/pkg/importer/table_import.go:792 +0x2c9
  github.com/pingcap/tidb/lightning/pkg/importer.(*TableImporter).preprocessEngine.func5()
      lightning/pkg/importer/table_import.go:824 +0x4f
Previous write at 0x00c000b4a508 by goroutine 221:
  github.com/pingcap/tidb/pkg/lightning/backend/tidb.(*tidbEncoder).Encode()
      pkg/lightning/backend/tidb/tidb.go:543 +0x1178
  github.com/pingcap/tidb/lightning/pkg/importer.(*chunkProcessor).encodeLoop()
      lightning/pkg/importer/chunk_process.go:458 +0x29a1
  github.com/pingcap/tidb/lightning/pkg/importer.(*chunkProcessor).process()
      lightning/pkg/importer/chunk_process.go:209 +0xbad
  github.com/pingcap/tidb/lightning/pkg/importer.(*TableImporter).preprocessEngine.func3()
      lightning/pkg/importer/table_import.go:792 +0x2c9
  github.com/pingcap/tidb/lightning/pkg/importer.(*TableImporter).preprocessEngine.func5()
      lightning/pkg/importer/table_import.go:824 +0x4f
Goroutine 224 (running) created at:
  github.com/pingcap/tidb/lightning/pkg/importer.(*TableImporter).preprocessEngine()
      lightning/pkg/importer/table_import.go:782 +0x1f8d
  github.com/pingcap/tidb/lightning/pkg/importer.(*tableRestoreSuite).TestRestoreEngineFailed()
      lightning/pkg/importer/table_import_test.go:452 +0x25e4
  runtime.call16()
      src/runtime/asm_amd64.s:747 +0x42
  reflect.Value.Call()
      GOROOT/src/reflect/value.go:380 +0xb5
  github.com/stretchr/testify/suite.Run.func1()
      external/com_github_stretchr_testify/suite/suite.go:202 +0x766
  testing.tRunner()
      GOROOT/src/testing/testing.go:1595 +0x261
  testing.(*T).Run.func1()
      GOROOT/src/testing/testing.go:1648 +0x44
Goroutine 221 (finished) created at:
  github.com/pingcap/tidb/lightning/pkg/importer.(*TableImporter).preprocessEngine()
      lightning/pkg/importer/table_import.go:782 +0x1f8d
  github.com/pingcap/tidb/lightning/pkg/importer.(*tableRestoreSuite).TestRestoreEngineFailed()
      lightning/pkg/importer/table_import_test.go:452 +0x25e4
  runtime.call16()
      src/runtime/asm_amd64.s:747 +0x42
  reflect.Value.Call()
      GOROOT/src/reflect/value.go:380 +0xb5
  github.com/stretchr/testify/suite.Run.func1()
      external/com_github_stretchr_testify/suite/suite.go:202 +0x766
  testing.tRunner()
      GOROOT/src/testing/testing.go:1595 +0x261
  testing.(*T).Run.func1()
      GOROOT/src/testing/testing.go:1648 +0x44
================== 
```
### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53820,pingcap/tidb,2024-06-05 03:20:02+00:00,2024-11-01 10:04:03+00:00,,open,"['type/bug', 'component/test', 'severity/major', 'component/lightning', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1', 'affects-8.5']",Assertion Failure
The TPS of point-get drops to 0 while the QPS remains unchanged,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
1. deploy a tidb cluster with 3 tidb + 3 tikv
2. run ycsb workloadc

### 2. What did you expect to see? (Required)
The TPS metric worked well.
| tidb | tikv| pd|
|---|---|---|
| [9c5981c1401a243af21ff1ba9d219710363a8f2f](https://github.com/pingcap/tidb/commit/9c5981c1401a243af21ff1ba9d219710363a8f2f)|[e106c8dd7237b95e8f26e064856b96b7fe384420](https://github.com/tikv/tikv/commit/e106c8dd7237b95e8f26e064856b96b7fe384420)|[740f15e6529ea7607be801fcc8a5747f96f6585d](https://github.com/tikv/pd/commit/740f15e6529ea7607be801fcc8a5747f96f6585d)|

|tps|qps|
|---|---|
| 74967 | 74942 |

![image](https://github.com/pingcap/tidb/assets/84501897/6bd81bc4-06d9-46dc-b36d-0eb5bc1d3cd3)


### 3. What did you see instead (Required)
The TPS of point dropped to nearly 0.
| tidb | tikv| pd|
|---|---|---|
| [203e5f2cff1d094166d67a144de3be0aa96bdef5](https://github.com/pingcap/tidb/commit/203e5f2cff1d094166d67a144de3be0aa96bdef5)|[e15796505d01ec56b01bd5a893accd0a186c3e32](https://github.com/tikv/tikv/commit/e15796505d01ec56b01bd5a893accd0a186c3e32)|[78cb08160a8e16a4704c5def5d44a50ae10f6e4c](https://github.com/tikv/pd/commit/78cb08160a8e16a4704c5def5d44a50ae10f6e4c)|

|tps|qps|
|---|---|
|25.2| 75615|

![image](https://github.com/pingcap/tidb/assets/84501897/0d4aab6b-189c-4b46-b563-b75eee526f97)


### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53819,pingcap/tidb,2024-06-05 02:50:42+00:00,2024-07-04 09:46:14+00:00,,open,"['type/bug', 'sig/transaction', 'severity/moderate']",Performance Degradation
Unexpected random records using `ORDER BY + LIMIT`,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
创建测试表及写入数据
```
CREATE TABLE `test` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '自增主键',
  `create_time` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) COMMENT '记录创建时间戳',
  `update_time` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3) COMMENT '记录更新时间戳',
  `task_id` bigint(20) unsigned NOT NULL DEFAULT '0' COMMENT '任务id',
  `user_id` bigint(20) unsigned NOT NULL DEFAULT '0' COMMENT 'C端用户id',
  `status` tinyint(2) unsigned NOT NULL DEFAULT '0' COMMENT '任务状态0:未知,1:待推送,2:推送完成,3:推送失败,4:已取消',
  `reason` varchar(64) NOT NULL DEFAULT '' COMMENT '失败原因',
  PRIMARY KEY (`id`)
  /*T![clustered_index] CLUSTERED */,
  KEY `idx_task` (`task_id`),
  KEY `idx_status` (`status`),
  UNIQUE KEY `uk_task_user` (`task_id`, `user_id`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_bin AUTO_INCREMENT = 635227 COMMENT = '发送任务详情表'
```

```
INSERT INTO test (id,create_time,update_time,task_id,user_id,status,reason) VALUES
	 (593431,'2024-06-04 15:10:20.288','2024-06-04 15:15:02.950',71,1,2,''),
	 (593432,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.030',71,2452000,2,''),
	 (593433,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.165',71,3178014,2,''),
	 (593434,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.274',71,488021,2,''),
	 (593435,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.313',71,2628001,2,''),
	 (593436,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.356',71,2452002,2,''),
	 (593437,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.402',71,2452003,2,''),
	 (593438,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.444',71,2452004,2,''),
	 (593439,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.483',71,2452005,2,''),
	 (593440,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.526',71,2452006,2,'');
INSERT INTO test (id,create_time,update_time,task_id,user_id,status,reason) VALUES
	 (593441,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.565',71,3178015,2,''),
	 (593442,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.607',71,2452001,2,''),
	 (593443,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.647',71,3178016,2,''),
	 (593444,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.741',71,3178018,2,''),
	 (593445,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.782',71,3238000,2,''),
	 (593446,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.823',71,3238001,2,''),
	 (593447,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.867',71,3240003,2,''),
	 (593448,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.923',71,3240004,2,''),
	 (593449,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.968',71,108026,2,''),
	 (593450,'2024-06-04 15:10:20.288','2024-06-04 15:15:03.990',71,2,3,'库存不足');
```

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)
正常情况数据不重复（如下为MySQL 8.0版本中测试）
`SELECT * FROM test WHERE (task_id = 71) ORDER BY create_time DESC LIMIT 0,2`
![image](https://github.com/pingcap/tidb/assets/120696271/2528603e-9144-44da-95d5-347d042184cd)

`SELECT * FROM test WHERE (task_id = 71) ORDER BY create_time DESC LIMIT 2,2`
![image](https://github.com/pingcap/tidb/assets/120696271/670e887f-ab78-4399-b4d9-3b984ffa27e7)

### 3. What did you see instead (Required)
593431 这个id的数据重复出现
5.7.25-TiDB-v7.5.0版本：
`SELECT * FROM test WHERE (task_id = 71) ORDER BY create_time DESC LIMIT 0,2`
![image](https://github.com/pingcap/tidb/assets/120696271/b6e1d0d4-3dba-4d38-8cd2-d34f7309600e)

`SELECT * FROM test WHERE (task_id = 71) ORDER BY create_time DESC LIMIT 2,2`
![image](https://github.com/pingcap/tidb/assets/120696271/c554e199-007c-41a3-9fd6-d1e26dcdca8e)

8.0.11-TiDB-v7.5.0版本：
![image](https://github.com/pingcap/tidb/assets/120696271/b3b66532-b77b-4615-bad0-054a54333275)



### 4. What is your TiDB version? (Required)
5.7.25-TiDB-v7.5.0,8.0.11-TiDB-v7.5.0
<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53818,pingcap/tidb,2024-06-05 02:46:23+00:00,2024-06-10 06:30:05+00:00,2024-06-05 08:34:20+00:00,closed,['type/bug'],Incorrect Query Result
"tidb restart with error log “[FATAL] [job_table.go:366] [""dispatch loop get cluster state failed, it should not happen, please try restart TiDB""]”","## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
1、run sysbench mussel 
2、inject pd leader io delay 500ms

### 2. What did you expect to see? (Required)
tidb is normal

### 3. What did you see instead (Required)
tidb restart with error log “[FATAL] [job_table.go:366] [""dispatch loop get cluster state failed, it should not happen, please try restart TiDB""]”

`[2024/06/03 12:42:37.820 +08:00] [FATAL] [job_table.go:366] [""dispatch loop get cluster state failed, it should not happen, please try restart TiDB""] [category=ddl] [error=""context canceled""] [stack=""github.com/pingcap/tidb/pkg/ddl.(*jobScheduler).startDispatchLoop\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/ddl/job_table.go:366\ngithub.com/pingcap/tidb/pkg/util.(*WaitGroupWrapper).RunWithLog.func1\n\t/home/jenkins/agent/workspace/build-common/go/src/github.com/pingcap/tidb/pkg/util/wait_group_wrapper.go:171""]`
### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
./tidb-server -V
 Release Version: v8.2.0-alpha
Edition: Community
Git Commit Hash: 8483dc538be95234dde6d6c31d1bb3248488440e
Git Branch: heads/refs/tags/v8.2.0-alpha
UTC Build Time: 2024-06-02 11:45:42
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: unistore
2024-06-03T12:32:12.769+0800",https://github.com/pingcap/tidb/issues/53808,pingcap/tidb,2024-06-04 12:21:31+00:00,2024-06-06 05:03:22+00:00,2024-06-06 04:30:04+00:00,closed,"['type/bug', 'severity/major', 'feature/developing', 'component/ddl']",Crash / Segmentation Fault
DATA RACE in the TestAdminCheckGlobalIndexDuringDDL,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

```
==================
WARNING: DATA RACE
Write at 0x00c006ac4290 by goroutine 40210:
  github.com/pingcap/tidb/pkg/executor.ResetContextOfStmt()
      pkg/executor/executor.go:2056 +0x3fb3
  github.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt()
      pkg/session/session.go:2016 +0x285
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecWithContext()
      pkg/testkit/testkit.go:383 +0xe29
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).Exec()
      pkg/testkit/testkit.go:356 +0xb5
  pkg/executor/test/admintest/admintest_test.TestAdminCheckGlobalIndexDuringDDL.func1()
      pkg/executor/test/admintest/admin_test.go:2066 +0x79
  github.com/pingcap/tidb/pkg/ddl/util/callback.(*TestDDLCallback).OnJobUpdated()
      pkg/ddl/util/callback/callback.go:124 +0x1f2
  github.com/pingcap/tidb/pkg/ddl.(*jobScheduler).delivery2Worker.func1()
      pkg/ddl/job_table.go:593 +0xf68
  github.com/pingcap/tidb/pkg/util.(*WaitGroupWrapper).Run.func1()
      pkg/util/wait_group_wrapper.go:157 +0x86
Previous read at 0x00c006ac4290 by goroutine 63:
  github.com/pingcap/tidb/pkg/ddl.(*ddl).DoDDLJob()
      pkg/ddl/ddl.go:1196 +0xfa4
  github.com/pingcap/tidb/pkg/ddl.(*ddl).TruncateTablePartition()
      pkg/ddl/ddl_api.go:5050 +0xdd8
  github.com/pingcap/tidb/pkg/ddl.(*ddl).AlterTable()
      pkg/ddl/ddl_api.go:3935 +0x24be
  github.com/pingcap/tidb/pkg/executor.(*DDLExec).executeAlterTable()
      pkg/executor/ddl.go:388 +0x2a2
  github.com/pingcap/tidb/pkg/executor.(*DDLExec).Next()
      pkg/executor/ddl.go:152 +0x38d
  github.com/pingcap/tidb/pkg/executor/internal/exec.Next()
      pkg/executor/internal/exec/executor.go:410 +0x3b0
  github.com/pingcap/tidb/pkg/executor.(*ExecStmt).next()
      pkg/executor/adapter.go:1211 +0x84
  github.com/pingcap/tidb/pkg/executor.(*ExecStmt).handleNoDelayExecutor()
      pkg/executor/adapter.go:960 +0x55b
  github.com/pingcap/tidb/pkg/executor.(*ExecStmt).handleNoDelay()
      pkg/executor/adapter.go:794 +0x3ca
  github.com/pingcap/tidb/pkg/executor.(*ExecStmt).Exec()
      pkg/executor/adapter.go:559 +0x1326
  github.com/pingcap/tidb/pkg/session.runStmt()
      pkg/session/session.go:2285 +0x5d3
  github.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt()
      pkg/session/session.go:2146 +0x1ac4
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecWithContext()
      pkg/testkit/testkit.go:383 +0xe29
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).MustExecWithContext()
      pkg/testkit/testkit.go:155 +0xab
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).MustExec()
      pkg/testkit/testkit.go:150 +0x128
  pkg/executor/test/admintest/admintest_test.TestAdminCheckGlobalIndexDuringDDL()
      pkg/executor/test/admintest/admin_test.go:2096 +0x6a4
  github.com/pingcap/failpoint.parseTerm()
      external/com_github_pingcap_failpoint/terms.go:149 +0x364
  github.com/pingcap/failpoint.parse()
      external/com_github_pingcap_failpoint/terms.go:126 +0xa5
  fmt.Sscanf()
      GOROOT/src/fmt/scan.go:114 +0x2d3
  github.com/pingcap/failpoint.parseVal()
      external/com_github_pingcap_failpoint/terms.go:285 +0x229
  fmt.(*ss).doScanf()
      GOROOT/src/fmt/scan.go:1230 +0x40e
  fmt.Fscanf()
      GOROOT/src/fmt/scan.go:143 +0xdc
  fmt.Sscanf()
      GOROOT/src/fmt/scan.go:114 +0x184
  github.com/pingcap/failpoint.parseVal()
      external/com_github_pingcap_failpoint/terms.go:279 +0xc4
  github.com/pingcap/failpoint.parseTerm()
      external/com_github_pingcap_failpoint/terms.go:149 +0x364
  github.com/pingcap/failpoint.parse()
      external/com_github_pingcap_failpoint/terms.go:126 +0xa5
  github.com/pingcap/failpoint.newTerms()
      external/com_github_pingcap_failpoint/terms.go:98 +0x3e
  github.com/pingcap/failpoint.(*Failpoint).Enable()
      external/com_github_pingcap_failpoint/failpoint.go:58 +0x3e
  github.com/pingcap/failpoint.(*Failpoints).Enable()
      external/com_github_pingcap_failpoint/failpoints.go:105 +0x296
  github.com/pingcap/failpoint.Enable()
      external/com_github_pingcap_failpoint/failpoints.go:255 +0x65d
  pkg/executor/test/admintest/admintest_test.TestAdminCheckGlobalIndexDuringDDL()
      pkg/executor/test/admintest/admin_test.go:2095 +0x65e
  github.com/pingcap/tidb/pkg/session.runStmt()
      pkg/session/session.go:2285 +0x5d3
  github.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt()
      pkg/session/session.go:2146 +0x1ac4
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecWithContext()
      pkg/testkit/testkit.go:383 +0xe29
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).MustExecWithContext()
      pkg/testkit/testkit.go:155 +0xab
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).MustExec()
      pkg/testkit/testkit.go:150 +0x128
  pkg/executor/test/admintest/admintest_test.TestAdminCheckGlobalIndexDuringDDL()
      pkg/executor/test/admintest/admin_test.go:2078 +0x485
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecWithContext()
      pkg/testkit/testkit.go:383 +0xe29
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).MustExecWithContext()
      pkg/testkit/testkit.go:155 +0xab
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).MustExec()
      pkg/testkit/testkit.go:150 +0x128
  github.com/pingcap/tidb/pkg/testkit.(*TestKit).RefreshSession()
      pkg/testkit/testkit.go:122 +0x104
  github.com/pingcap/tidb/pkg/testkit.NewTestKit()
      pkg/testkit/testkit.go:84 +0x49d
  pkg/executor/test/admintest/admintest_test.TestAdminCheckGlobalIndexDuringDDL()
      pkg/executor/test/admintest/admin_test.go:2059 +0xbe
  github.com/pingcap/tidb/pkg/domain.(*Domain).rebuildSysVarCache()
      pkg/domain/sysvar_cache.go:145 +0x904
  github.com/pingcap/tidb/pkg/domain.(*Domain).LoadSysVarCacheLoop()
      pkg/domain/domain.go:1755 +0x93
  github.com/pingcap/tidb/pkg/session.bootstrapSessionImpl()
      pkg/session/session.go:3426 +0x864
  github.com/pingcap/tidb/pkg/domain.(*Domain).GetSessionCache()
      pkg/domain/sysvar_cache.go:61 +0x50
  github.com/pingcap/tidb/pkg/session.(*session).loadCommonGlobalVariablesIfNeeded()
      pkg/session/session.go:3794 +0x2ce
  github.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt()
      pkg/session/session.go:2008 +0x184
  github.com/pingcap/tidb/pkg/session.(*session).ExecuteInternal()
      pkg/session/session.go:1519 +0x3b9
  github.com/pingcap/tidb/pkg/domain.(*Domain).LoadPrivilegeLoop()
      pkg/domain/domain.go:1698 +0x108
  github.com/pingcap/tidb/pkg/session.bootstrapSessionImpl()
      pkg/session/session.go:3419 +0x804
  github.com/pingcap/tidb/pkg/session.BootstrapSession()
      pkg/session/session.go:3318 +0xad
  github.com/pingcap/tidb/pkg/testkit.bootstrap()
      pkg/testkit/mockstore.go:254 +0x94
  github.com/pingcap/tidb/pkg/testkit.CreateMockStoreAndDomain()
      pkg/testkit/mockstore.go:225 +0xd2
  pkg/executor/test/admintest/admintest_test.TestAdminCheckGlobalIndexDuringDDL()
      pkg/executor/test/admintest/admin_test.go:2057 +0x4c
  testing.tRunner()
      GOROOT/src/testing/testing.go:1595 +0x261
  testing.(*T).Run.func1()
      GOROOT/src/testing/testing.go:1648 +0x44
Goroutine 40210 (running) created at:
  github.com/pingcap/tidb/pkg/util.(*WaitGroupWrapper).Run()
      pkg/util/wait_group_wrapper.go:155 +0xe4
  github.com/pingcap/tidb/pkg/ddl.(*jobScheduler).delivery2Worker()
      pkg/ddl/job_table.go:511 +0x193
  github.com/pingcap/tidb/pkg/ddl.(*jobScheduler).loadDDLJobAndRun()
      pkg/ddl/job_table.go:467 +0x4dc
  github.com/pingcap/tidb/pkg/ddl.(*jobScheduler).startDispatchLoop()
      pkg/ddl/job_table.go:401 +0xe05
  github.com/pingcap/tidb/pkg/ddl.(*jobScheduler).startDispatchLoop-fm()
      <autogenerated>:1 +0x33
  github.com/pingcap/tidb/pkg/util.(*WaitGroupWrapper).RunWithLog.func1()
      pkg/util/wait_group_wrapper.go:171 +0xd0
Goroutine 63 (running) created at:
  testing.(*T).Run()
      GOROOT/src/testing/testing.go:1648 +0x845
  testing.runTests.func1()
      GOROOT/src/testing/testing.go:2054 +0x84
  testing.tRunner()
      GOROOT/src/testing/testing.go:1595 +0x261
  testing.runTests()
      GOROOT/src/testing/testing.go:2052 +0x8ad
  testing.(*M).Run()
      GOROOT/src/testing/testing.go:1925 +0xcd7
  go.uber.org/goleak.VerifyTestMain()
      external/org_uber_go_goleak/testmain.go:53 +0x64
  pkg/executor/test/admintest/admintest_test.TestMain()
      pkg/executor/test/admintest/main_test.go:49 +0x784
  main.main()
      bazel-out/k8-fastbuild/bin/pkg/executor/test/admintest/admintest_test_/testmain.go:173 +0x6dc
================== 
```
### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53802,pingcap/tidb,2024-06-04 10:13:52+00:00,2024-06-05 03:28:26+00:00,2024-06-05 03:28:26+00:00,closed,"['type/bug', 'sig/sql-infra', 'severity/minor']",Concurrency Issue
Incomplete and incorrect errors for arguments of JSON functions,"## Bug Report

Some JSON functions have errors where:
- The error text differs from MySQL
- The error has an incorrect number of arguments for the message
- The error has an error code that differs from MySQL

### 1. Minimal reproduce step (Required)

```
SELECT JSON_CONTAINS(123, '');
SELECT JSON_CONTAINS('{}', 123);
SELECT JSON_OVERLAPS(123, '');
SELECT JSON_OVERLAPS('{}', 123);
SELECT 'abc' MEMBER OF(123);
```
<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

With MySQL 8.4.0

```
mysql> SELECT JSON_CONTAINS(123, '');
ERROR 3146 (22032): Invalid data type for JSON data in argument 1 to function json_contains; a JSON string or JSON type is required.
mysql> SELECT JSON_CONTAINS('{}', 123);
ERROR 3146 (22032): Invalid data type for JSON data in argument 2 to function json_contains; a JSON string or JSON type is required.
mysql> SELECT JSON_OVERLAPS(123, '');
ERROR 3146 (22032): Invalid data type for JSON data in argument 1 to function json_overlaps; a JSON string or JSON type is required.
mysql> SELECT JSON_OVERLAPS('{}', 123);
ERROR 3146 (22032): Invalid data type for JSON data in argument 2 to function json_overlaps; a JSON string or JSON type is required.
mysql> SELECT 'abc' MEMBER OF(123);
ERROR 3146 (22032): Invalid data type for JSON data in argument 2 to function member of; a JSON string or JSON type is required.
```

### 3. What did you see instead (Required)

```
mysql> SELECT JSON_CONTAINS(123, '');
ERROR 3069 (22032): Invalid JSON data provided to function %!s(int=1): json_contains
mysql> SELECT JSON_CONTAINS('{}', 123);
ERROR 3069 (22032): Invalid JSON data provided to function %!s(int=2): json_contains
mysql> SELECT JSON_OVERLAPS(123, '');
ERROR 3069 (22032): Invalid JSON data provided to function %!s(int=1): json_overlaps
mysql> SELECT JSON_OVERLAPS('{}', 123);
ERROR 3069 (22032): Invalid JSON data provided to function %!s(int=2): json_overlaps
mysql> SELECT 'abc' MEMBER OF(123);
ERROR 3069 (22032): Invalid JSON data provided to function %!s(int=2): member of
```

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
```
Release Version: v8.1.0
Edition: Community
Git Commit Hash: 945d07c5d5c7a1ae212f6013adfb187f2de24b23
Git Branch: HEAD
UTC Build Time: 2024-05-21 03:51:57
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv
```",https://github.com/pingcap/tidb/issues/53799,pingcap/tidb,2024-06-04 09:25:06+00:00,2024-06-18 03:22:17+00:00,2024-06-18 03:22:17+00:00,closed,"['type/bug', 'type/compatibility', 'component/expression', 'component/json', 'sig/sql-infra', 'severity/major', 'compatibility-mysql80', 'affects-5.4', 'affects-6.1', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1']",SQL Syntax / Parsing Error
runtime error: slice bounds out of range [:33] with capacity 32 in `expression.(*builtinRpadUTF8Sig).vecEvalString`,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

```sql
create table t_u6z6v6m3u ( 
c_ytzsa int ,
c_zllrsddn96 text ,
c_gvxf double ,
c_g91_kal4n double unique ,
primary key(c_ytzsa) CLUSTERED) pre_split_regions=2;

insert into t_u6z6v6m3u (c_ytzsa, c_zllrsddn96, c_gvxf, c_g91_kal4n) values 
  (666539487, 'w5qtrc', 85.90, 32768.9), 
  (1408667566, 'a6d0', 71.4, 15.89), 
  (-1680147087, 'yit7oneb5', 65535.7, 257.3), 
  (1211374988, 'e64', 92.46, 11.76);

SELECT
  rpad(
      cast(ref_0.c_zllrsddn96 as char), 
      33, 
      cast(unhex(
        cast(case when (NOT NOT(cast( (cast(null as char) >= 'g7ru0xq_') as unsigned))) then ref_0.c_zllrsddn96 else ref_0.c_zllrsddn96 end
           as char)) as char)) as c4
FROM
  t_u6z6v6m3u as ref_0;
```

### 2. What did you expect to see? (Required)
Expect no crashes
### 3. What did you see instead (Required)
```
runtime error: slice bounds out of range [:33] with capacity 32
github.com/pingcap/errors.AddStack
	/root/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/errors.go:178
github.com/pingcap/errors.Trace
	/root/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/juju_adaptor.go:15
github.com/pingcap/tidb/pkg/util.GetRecoverError
	/workspace/source/tidb/pkg/util/util.go:304
github.com/pingcap/tidb/pkg/executor.recoveryProjection
	/workspace/source/tidb/pkg/executor/projection.go:466
github.com/pingcap/tidb/pkg/executor.(*projectionWorker).run.func1
	/workspace/source/tidb/pkg/executor/projection.go:435
runtime.gopanic
	/usr/local/go/src/runtime/panic.go:914
runtime.goPanicSliceAcap
	/usr/local/go/src/runtime/panic.go:140
github.com/pingcap/tidb/pkg/expression.(*builtinRpadUTF8Sig).vecEvalString
	/workspace/source/tidb/pkg/expression/builtin_string_vec.go:2630
github.com/pingcap/tidb/pkg/expression.(*ScalarFunction).VecEvalString
	/workspace/source/tidb/pkg/expression/scalar_function.go:72
github.com/pingcap/tidb/pkg/expression.evalOneVec
	/workspace/source/tidb/pkg/expression/chunk_executor.go:172
github.com/pingcap/tidb/pkg/expression.(*defaultEvaluator).run
	/workspace/source/tidb/pkg/expression/evaluator.go:52
github.com/pingcap/tidb/pkg/expression.(*EvaluatorSuite).Run
	/workspace/source/tidb/pkg/expression/evaluator.go:124
github.com/pingcap/tidb/pkg/executor.(*projectionWorker).run
	/workspace/source/tidb/pkg/executor/projection.go:451
runtime.goexit
	/usr/local/go/src/runtime/asm_amd64.s:1650

```
### 4. What is your TiDB version? (Required)

```
Release Version: v8.1.0
Edition: Community
Git Commit Hash: 945d07c5d5c7a1ae212f6013adfb187f2de24b23
Git Branch: HEAD
UTC Build Time: 2024-05-21 03:51:57
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv
```

We are the BASS team from the School of Cyber Science and Technology at Beihang University. Our main focus is on system software security, operating systems, and program analysis research, as well as the development of automated program testing frameworks for detecting software defects. Using our self-developed database vulnerability testing tool, we have identified the above-mentioned vulnerabilities in TiDB that may lead to database crashes.",https://github.com/pingcap/tidb/issues/53797,pingcap/tidb,2024-06-04 08:10:14+00:00,2024-11-25 09:41:09+00:00,,open,"['type/bug', 'sig/execution', 'severity/moderate', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1', 'impact/panic', 'affects-8.5']",Crash / Segmentation Fault
runtime error: index out of range [0] with length 0 in `expression.ExplainExpressionList`,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

```sql
create table t_ldpj7bp ( 
c_w_jr14qm2 int ,
c_t3nd927 int ,
c_ts int ,
c_s text ,
c_qchmg double ,
c_r int ,
c_olb3fsg6 text ,
c_zkbe tinyint ,
primary key(c_w_jr14qm2) NONCLUSTERED) shard_row_id_bits=8 pre_split_regions=5;

-- sql #267
alter table t_ldpj7bp set tiflash replica 1;

insert into t_ldpj7bp (c_w_jr14qm2, c_t3nd927, c_ts, c_s, c_qchmg, c_r, c_olb3fsg6, c_zkbe) values 
  (730552758, -682774206, 1698439632, 'lrvil359', 18446744073709551616.5, cast(cast(null as signed) as signed), 'oj1', (-1367510804 in (
    2123597870, 1485484027))), 
  (-1001332962, -1396443960, cast(cast(null as signed) as signed), 'e43lh', 15.54, -1568307927, 'i', (-1162033997 not in (
    -1850570375, -781179836, -1281662147, -431391092, cast(null as signed)))), 
  (-727295464, 1998529670, -1873237194, 'lps56o', 70.81, 1380690610, cast(null as char), ((NOT NOT(cast( (cast(cast(null as signed) as signed) && cast(2536017375093623800 as signed)) as unsigned)))) 
    and ((NOT NOT(cast( (cast(2051320819 as signed) <=> cast(-8632453786780487783 as signed)) as unsigned))))), 
  (2133408768, 736339957, -1486317339, 'f', 62.97, -1444096406, 'tj', (NOT NOT(cast( (cast(cast(null as char) as char) = cast(cast(null as char) as char)) as unsigned))));

-- [[NOTE]] please wait a while before executing the following sql, otherwise the bug may not be triggered.
SELECT
  ref_0.c_t3nd927 as c2
FROM
  t_ldpj7bp as ref_0
WHERE
  (EXISTS (
  select distinct 
      cast(cast(null as signed) as signed) as c0
    from 
      (select  
            ref_1.c_w_jr14qm2 as c0, 
            ref_1.c_ts as c1
          from 
            t_ldpj7bp as ref_1
          where (NOT NOT(cast( (cast(2147483648.100000 as double) || cast(78.5 as double)) as unsigned)))) as subq_0
    where (NOT NOT(cast( (cast(ref_0.c_t3nd927 as signed) <> cast(-2308981195293685378 as signed)) as unsigned)))
    order by c0 desc))
ORDER BY
  c2 ASC
LIMIT 55;

```

### 2. What did you expect to see? (Required)
Expect no crashes
### 3. What did you see instead (Required)
```
runtime error: index out of range [0] with length 0
github.com/pingcap/tidb/pkg/server.(*clientConn).Run.func1
	/workspace/source/tidb/pkg/server/conn.go:1015
runtime.gopanic
	/usr/local/go/src/runtime/panic.go:914
runtime.goPanicIndex
	/usr/local/go/src/runtime/panic.go:114
github.com/pingcap/tidb/pkg/expression.ExplainExpressionList
	/workspace/source/tidb/pkg/expression/explain.go:176
github.com/pingcap/tidb/pkg/planner/core.(*PhysicalProjection).ExplainInfo
	/workspace/source/tidb/pkg/planner/core/explain.go:377
github.com/pingcap/tidb/pkg/planner/core.(*Explain).getOperatorInfo
	/workspace/source/tidb/pkg/planner/core/common_plans.go:1167
github.com/pingcap/tidb/pkg/planner/core.(*Explain).prepareOperatorInfo
	/workspace/source/tidb/pkg/planner/core/common_plans.go:1081
github.com/pingcap/tidb/pkg/planner/core.(*Explain).explainFlatOpInRowFormat
	/workspace/source/tidb/pkg/planner/core/common_plans.go:1017
github.com/pingcap/tidb/pkg/planner/core.(*Explain).explainFlatPlanInRowFormat
	/workspace/source/tidb/pkg/planner/core/common_plans.go:958
github.com/pingcap/tidb/pkg/planner/core.(*Explain).RenderResult
	/workspace/source/tidb/pkg/planner/core/common_plans.go:910
github.com/pingcap/tidb/pkg/planner/core.GetExplainRowsForPlan
	/workspace/source/tidb/pkg/planner/core/common_plans.go:781
github.com/pingcap/tidb/pkg/session.(*session).SetProcessInfo
	/workspace/source/tidb/pkg/session/session.go:1423
github.com/pingcap/tidb/pkg/server.(*clientConn).dispatch.func2
	/workspace/source/tidb/pkg/server/conn.go:1301
runtime.gopanic
	/usr/local/go/src/runtime/panic.go:920
github.com/pingcap/tidb/pkg/executor.(*ExecStmt).Exec.func1
	/workspace/source/tidb/pkg/executor/adapter.go:450
runtime.gopanic
	/usr/local/go/src/runtime/panic.go:914
runtime.goPanicIndex
	/usr/local/go/src/runtime/panic.go:114
github.com/pingcap/tidb/pkg/expression.ExplainExpressionList
	/workspace/source/tidb/pkg/expression/explain.go:176
github.com/pingcap/tidb/pkg/planner/core.(*PhysicalProjection).ExplainInfo
	/workspace/source/tidb/pkg/planner/core/explain.go:377
github.com/pingcap/tidb/pkg/planner/core.(*Explain).getOperatorInfo
	/workspace/source/tidb/pkg/planner/core/common_plans.go:1167
github.com/pingcap/tidb/pkg/planner/core.(*Explain).prepareOperatorInfo
	/workspace/source/tidb/pkg/planner/core/common_plans.go:1081
github.com/pingcap/tidb/pkg/planner/core.(*Explain).explainFlatOpInRowFormat
	/workspace/source/tidb/pkg/planner/core/common_plans.go:1017
github.com/pingcap/tidb/pkg/planner/core.(*Explain).explainFlatPlanInRowFormat
	/workspace/source/tidb/pkg/planner/core/common_plans.go:958
github.com/pingcap/tidb/pkg/planner/core.(*Explain).RenderResult
	/workspace/source/tidb/pkg/planner/core/common_plans.go:910
github.com/pingcap/tidb/pkg/planner/core.GetExplainRowsForPlan
	/workspace/source/tidb/pkg/planner/core/common_plans.go:781
github.com/pingcap/tidb/pkg/session.(*session).SetProcessInfo
	/workspace/source/tidb/pkg/session/session.go:1423
github.com/pingcap/tidb/pkg/executor.(*ExecStmt).Exec
	/workspace/source/tidb/pkg/executor/adapter.go:540
github.com/pingcap/tidb/pkg/session.runStmt
	/workspace/source/tidb/pkg/session/session.go:2277
github.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt
	/workspace/source/tidb/pkg/session/session.go:2138
github.com/pingcap/tidb/pkg/server.(*TiDBContext).ExecuteStmt
	/workspace/source/tidb/pkg/server/driver_tidb.go:294
github.com/pingcap/tidb/pkg/server.(*clientConn).handleStmt
	/workspace/source/tidb/pkg/server/conn.go:2016
github.com/pingcap/tidb/pkg/server.(*clientConn).handleQuery
	/workspace/source/tidb/pkg/server/conn.go:1769
github.com/pingcap/tidb/pkg/server.(*clientConn).dispatch
	/workspace/source/tidb/pkg/server/conn.go:1343
github.com/pingcap/tidb/pkg/server.(*clientConn).Run
	/workspace/source/tidb/pkg/server/conn.go:1113
github.com/pingcap/tidb/pkg/server.(*Server).onConn
	/workspace/source/tidb/pkg/server/server.go:739

```
### 4. What is your TiDB version? (Required)

```
Release Version: v8.1.0
Edition: Community
Git Commit Hash: 945d07c5d5c7a1ae212f6013adfb187f2de24b23
Git Branch: HEAD
UTC Build Time: 2024-05-21 03:51:57
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv
```

We are the BASS team from the School of Cyber Science and Technology at Beihang University. Our main focus is on system software security, operating systems, and program analysis research, as well as the development of automated program testing frameworks for detecting software defects. Using our self-developed database vulnerability testing tool, we have identified the above-mentioned vulnerabilities in TiDB that may lead to database crashes.",https://github.com/pingcap/tidb/issues/53796,pingcap/tidb,2024-06-04 08:08:38+00:00,2024-08-30 07:25:34+00:00,2024-07-02 07:30:17+00:00,closed,"['type/bug', 'sig/planner', 'severity/major', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'affects-7.5', 'affects-8.1', 'report/community', 'impact/panic']",Crash / Segmentation Fault
multi-schema-change ADD INDEX may be blocked,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

```diff
diff --git a/pkg/ddl/ingest/env.go b/pkg/ddl/ingest/env.go
index c74d7f69fa..1c014b4f29 100644
--- a/pkg/ddl/ingest/env.go
+++ b/pkg/ddl/ingest/env.go
@@ -19,6 +19,7 @@ import (
        ""path/filepath""
        ""strconv""

+       ""github.com/pingcap/failpoint""
        ""github.com/pingcap/tidb/pkg/config""
        ""github.com/pingcap/tidb/pkg/ddl/logutil""
        ""github.com/pingcap/tidb/pkg/lightning/log""
@@ -68,6 +69,10 @@ func InitGlobalLightningEnv(filterProcessingJobIDs FilterProcessingJobIDsFunc) {
        } else {
                memTotal = memTotal / 2
        }
+       failpoint.Inject(""setMemTotalInMB"", func(val failpoint.Value) {
+               i := val.(int)
+               memTotal = uint64(i) * size.MB
+       })
        LitBackCtxMgr = NewLitBackendCtxMgr(sortPath, memTotal, filterProcessingJobIDs)
        litRLimit = util.GenRLimit(""ddl-ingest"")
        LitInitialized = true
```

```
$ GO_FAILPOINTS=""github.com/pingcap/tidb/pkg/ddl/ingest/setMemTotalInMB=return(1100)"" bin/tidb-server -store tikv -path 127.0.0.1:2379 -log-file /tmp/tidb.log
```

```
mysql> create table t (c int, c2 int, c3 int, c4 int);
Query OK, 0 rows affected (0.05 sec)

mysql> insert into t values (1,1,1,1), (2,2,2,2), (3,3,3,3);
Query OK, 3 rows affected (0.00 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> alter table t add index i(c), add index i2(c2);
```

### 2. What did you expect to see? (Required)

fail or success

### 3. What did you see instead (Required)

blocked

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53791,pingcap/tidb,2024-06-04 06:28:22+00:00,2024-06-11 04:48:01+00:00,2024-06-11 04:48:01+00:00,closed,"['type/bug', 'severity/major', 'component/ddl', 'affects-7.5', 'affects-8.1']",Deadlock
multi-schema-change merging ADD INDEX should consider the memory limit,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

Add failpoint to set memory limit to a lower value

```diff
diff --git a/pkg/ddl/ingest/env.go b/pkg/ddl/ingest/env.go
index c74d7f69fa..bef3dfb6d3 100644
--- a/pkg/ddl/ingest/env.go
+++ b/pkg/ddl/ingest/env.go
@@ -19,6 +19,7 @@ import (
        ""path/filepath""
        ""strconv""

+       ""github.com/pingcap/failpoint""
        ""github.com/pingcap/tidb/pkg/config""
        ""github.com/pingcap/tidb/pkg/ddl/logutil""
        ""github.com/pingcap/tidb/pkg/lightning/log""
@@ -68,6 +69,10 @@ func InitGlobalLightningEnv(filterProcessingJobIDs FilterProcessingJobIDsFunc) {
        } else {
                memTotal = memTotal / 2
        }
+       failpoint.Inject(""setMemTotalInGB"", func(val failpoint.Value) {
+               i := val.(int)
+               memTotal = uint64(i) * size.GB
+       })
        LitBackCtxMgr = NewLitBackendCtxMgr(sortPath, memTotal, filterProcessingJobIDs)
        litRLimit = util.GenRLimit(""ddl-ingest"")
        LitInitialized = true
```

Then we can see multi-schema-change failed

```
mysql> use test
Database changed
mysql> create table t (c int, c2 int, c3 int, c4 int);
Query OK, 0 rows affected (0.04 sec)

mysql> insert into t values (1,1,1,1), (2,2,2,2), (3,3,3,3);
Query OK, 3 rows affected (0.01 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> alter table t add index i(c), add index i2(c2), add index i3(c3), add index i4(c4);
ERROR 8247 (HY000): Ingest failed: memory used up
```

but if TiDB can add index one-by-one, it should succeed

```
mysql> alter table t add index i4(c4);
Query OK, 0 rows affected (2.01 sec)
```

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53789,pingcap/tidb,2024-06-04 06:09:45+00:00,2024-06-27 06:28:28+00:00,2024-06-27 06:28:28+00:00,closed,"['type/bug', 'severity/major', 'component/ddl', 'affects-7.5', 'affects-8.1']",Performance Degradation
ebs br: backup against no tikv store is not failed,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

Issue a backup to a tidb cluster with 0 tikv replica, as described in https://github.com/pingcap/tidb-operator/issues/5658

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)
The backup failed

### 3. What did you see instead (Required)
The backup is not failed or succeed

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53784,pingcap/tidb,2024-06-04 04:24:08+00:00,2024-06-12 09:01:31+00:00,2024-06-12 09:01:31+00:00,closed,"['type/bug', 'severity/major', 'component/br', 'affects-6.5', 'affects-7.5', 'affects-8.1']",Performance Degradation
"Invalid column type `decimal(0,0)` can be created unexpectedly","## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

```
-- If we create a column with decimal(0,0), then tidb will automatically fix it as decimal(10,0)
-- But when we create a column with decimal(0), then tidb will create  decimal(0,0), which is not as expected
TiDB test> create table a(b decimal(0,0), c decimal(0));
TiDB test> show create table a;
+-------+-------------------------------------------------------------+
| Table | Create Table                                                |
+-------+-------------------------------------------------------------+
| a     | CREATE TABLE `a` (                                          |
|       |   `b` decimal(10,0) DEFAULT NULL,                           |
|       |   `c` decimal(0,0) DEFAULT NULL                             |
|       | ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin |
+-------+-------------------------------------------------------------+
```


### 2. What did you expect to see? (Required)

```
TiDB test> create table a(b decimal(0,0), c decimal(0));
TiDB test> show create table a;
+-------+-------------------------------------------------------------+
| Table | Create Table                                                |
+-------+-------------------------------------------------------------+
| a     | CREATE TABLE `a` (                                          |
|       |   `b` decimal(10,0) DEFAULT NULL,                           |
|       |   `c` decimal(10,0) DEFAULT NULL                            |
|       | ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin |
+-------+-------------------------------------------------------------+
```

### 3. What did you see instead (Required)
```
TiDB test> create table a(b decimal(0,0), c decimal(0));
TiDB test> show create table a;
+-------+-------------------------------------------------------------+
| Table | Create Table                                                |
+-------+-------------------------------------------------------------+
| a     | CREATE TABLE `a` (                                          |
|       |   `b` decimal(10,0) DEFAULT NULL,                           |
|       |   `c` decimal(0,0) DEFAULT NULL                             |
|       | ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin |
+-------+-------------------------------------------------------------+
```
And this will lead to tiflash failed to sync the schema and cause queries error or failed to start tiflash-server. Reported from asktug: https://asktug.com/t/topic/1027023/16

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
```
select tidb_version() \G
***************************[ 1. row ]***************************
tidb_version() | Release Version: v6.5.4
Edition: Community
Git Commit Hash: d7ce2f2faa1da3177a0f0a7e825f6e8fccd13ec8
Git Branch: heads/refs/tags/v6.5.4
UTC Build Time: 2023-08-23 08:32:40
GoVersion: go1.19.12
Race Enabled: false
TiKV Min Version: 6.2.0-alpha
Check Table Before Drop: false
Store: tikv
```",https://github.com/pingcap/tidb/issues/53779,pingcap/tidb,2024-06-04 02:51:28+00:00,2024-08-11 12:41:35+00:00,2024-06-14 08:35:52+00:00,closed,"['type/bug', 'severity/major', 'affects-5.4', 'affects-6.1', 'affects-6.5', 'affects-7.1', 'component/ddl', 'affects-7.5', 'affects-8.1', 'report/community']",Constraint Violation
stats cache cost track metric is inaccurate,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
million tables read
set global.tidb_stats_cache_mem_quota 1GB
![img_v3_02bh_620827a9-0817-4b3b-a81d-434827c85c8g](https://github.com/pingcap/tidb/assets/7677963/18968a41-f82f-45e4-9f65-bab93d0c7885)

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
master",https://github.com/pingcap/tidb/issues/53776,pingcap/tidb,2024-06-04 02:34:49+00:00,2024-12-18 10:28:39+00:00,,open,"['type/bug', 'sig/planner', 'component/statistics', 'severity/moderate']",Performance Degradation
inl_join hints has wrong warrings in the cte query block,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
```
CREATE TABLE t_employees  (
    id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    fname VARCHAR(25) NOT NULL,
    lname VARCHAR(25) NOT NULL,
    store_id INT NOT NULL,
    department_id INT NOT NULL
);
alter table t_employees add index idx(department_id);

explain 
with t as (select  /*+ inl_join(e) */em.* from t_employees em join t_employees e where em.store_id=e.department_id )
select * from t ;
```
The hint is worked, but it has some wrong warnings.

### 2. What did you expect to see? (Required)
```
id                     |estRows |task     |access object                    |operator info                                                                                                                                                                            |
-----------------------+--------+---------+---------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
IndexJoin_16           |12500.00|root     |                                 |inner join, inner:IndexReader_15, outer key:test.t_employees.store_id, inner key:test.t_employees.department_id, equal cond:eq(test.t_employees.store_id, test.t_employees.department_id)|
├─TableReader_24(Build)|10000.00|root     |                                 |data:TableFullScan_23                                                                                                                                                                    |
│ └─TableFullScan_23   |10000.00|cop[tikv]|table:em                         |keep order:false, stats:pseudo                                                                                                                                                           |
└─IndexReader_15(Probe)|12500.00|root     |                                 |index:IndexRangeScan_14                                                                                                                                                                  |
  └─IndexRangeScan_14  |12500.00|cop[tikv]|table:e, index:idx(department_id)|range: decided by [eq(test.t_employees.department_id, test.t_employees.store_id)], keep order:false, stats:pseudo                                                                        |
```
the explain use index join without warnings.

### 3. What did you see instead (Required)
```
id                     |estRows |task     |access object                    |operator info                                                                                                                                                                            |
-----------------------+--------+---------+---------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
IndexJoin_16           |12500.00|root     |                                 |inner join, inner:IndexReader_15, outer key:test.t_employees.store_id, inner key:test.t_employees.department_id, equal cond:eq(test.t_employees.store_id, test.t_employees.department_id)|
├─TableReader_24(Build)|10000.00|root     |                                 |data:TableFullScan_23                                                                                                                                                                    |
│ └─TableFullScan_23   |10000.00|cop[tikv]|table:em                         |keep order:false, stats:pseudo                                                                                                                                                           |
└─IndexReader_15(Probe)|12500.00|root     |                                 |index:IndexRangeScan_14                                                                                                                                                                  |
  └─IndexRangeScan_14  |12500.00|cop[tikv]|table:e, index:idx(department_id)|range: decided by [eq(test.t_employees.department_id, test.t_employees.store_id)], keep order:false, stats:pseudo                                                                        |
```
the explain use index join with warnings 
There are no matching table names for (e) in optimizer hint /*+ INL_JOIN(e, e) */ or /*+ TIDB_INLJ(e, e) */. Maybe you can use the table alias name

### 4. What is your TiDB version? (Required)
Release Version: v8.1.0
Edition: Community
Git Commit Hash: 945d07c5d5c7a1ae212f6013adfb187f2de24b23
Git Branch: HEAD
UTC Build Time: 2024-05-21 03:51:57
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv
<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53767,pingcap/tidb,2024-06-03 13:07:17+00:00,2024-06-11 09:52:31+00:00,2024-06-11 09:52:31+00:00,closed,"['type/bug', 'sig/planner', 'severity/moderate', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1']",SQL Syntax / Parsing Error
Query failed to execute in TiDB but succeeded in MySQL,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
```sql
CREATE TABLE t0(c0 int);
CREATE TABLE t1(c0 int);
SELECT t0.c0, t1.c0 FROM t0 NATURAL JOIN t1 WHERE '1' AND (t0.c0 IN (SELECT c0 FROM t0));
```

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)
Query executed successfully.

### 3. What did you see instead (Required)
```sql
MySQL [d0]> SELECT t0.c0, t1.c0 FROM t0 NATURAL JOIN t1 WHERE '1' AND (t0.c0 IN (SELECT c0 FROM t0));
ERROR 1054 (42S22): Unknown column 't1.c0' in 'field list'
```

### 4. What is your TiDB version? (Required)
```sql
Release Version: v8.2.0-alpha-234-gdf64c343dd-dirty
Edition: Community
Git Commit Hash: df64c343ddfc4063891900acf95e2b3640c79f29
Git Branch: master
UTC Build Time: 2024-05-27 08:15:16
GoVersion: go1.21.7
Race Enabled: false
Check Table Before Drop: false
Store: tikv
```
<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53766,pingcap/tidb,2024-06-03 12:03:02+00:00,2024-10-10 07:16:42+00:00,2024-10-10 07:16:42+00:00,closed,"['type/bug', 'sig/planner', 'severity/major', 'compatibility-mysql80', 'affects-6.1', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1']",Incorrect Query Result
flaky test TestRenameTableAutoIDs,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

```
     testkit.go:157: 
        	Error Trace:	pkg/testkit/testkit.go:157
        	            				pkg/testkit/testkit.go:150
        	            				pkg/ddl/schema_test.go:398
        	Error:      	Received unexpected error:
        	            	[schema:1146]Table 'renametableautoids2.t2' doesn't exist
        	            	github.com/pingcap/errors.AddStack
        	            		external/com_github_pingcap_errors/errors.go:178
        	            	github.com/pingcap/errors.Trace
        	            		external/com_github_pingcap_errors/juju_adaptor.go:15
        	            	github.com/pingcap/tidb/pkg/planner/core.Preprocess
        	            		pkg/planner/core/preprocess.go:141
        	            	github.com/pingcap/tidb/pkg/executor.(*Compiler).Compile
        	            		pkg/executor/compiler.go:67
        	            	github.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt
        	            		pkg/session/session.go:2094
        	            	github.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecWithContext
        	            		pkg/testkit/testkit.go:383
        	            	github.com/pingcap/tidb/pkg/testkit.(*TestKit).MustExecWithContext
        	            		pkg/testkit/testkit.go:155
        	            	github.com/pingcap/tidb/pkg/testkit.(*TestKit).MustExec
        	            		pkg/testkit/testkit.go:150
        	            	github.com/pingcap/tidb/pkg/ddl_test.TestRenameTableAutoIDs
        	            		pkg/ddl/schema_test.go:398
        	            	testing.tRunner
        	            		GOROOT/src/testing/testing.go:1595
        	            	runtime.goexit
        	            		src/runtime/asm_amd64.s:1650
        	Test:       	TestRenameTableAutoIDs
        	Messages:   	sql:insert into RenameTableAutoIDs2.t2 values (50, 5), [], error stack [schema:1146]Table 'renametableautoids2.t2' doesn't exist
        	            	github.com/pingcap/errors.AddStack
        	            		external/com_github_pingcap_errors/errors.go:178
        	            	github.com/pingcap/errors.Trace
        	            		external/com_github_pingcap_errors/juju_adaptor.go:15
        	            	github.com/pingcap/tidb/pkg/planner/core.Preprocess
        	            		pkg/planner/core/preprocess.go:141
        	            	github.com/pingcap/tidb/pkg/executor.(*Compiler).Compile
        	            		pkg/executor/compiler.go:67
        	            	github.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt
        	            		pkg/session/session.go:2094
        	            	github.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecWithContext
        	            		pkg/testkit/testkit.go:383
        	            	github.com/pingcap/tidb/pkg/testkit.(*TestKit).MustExecWithContext
        	            		pkg/testkit/testkit.go:155
        	            	github.com/pingcap/tidb/pkg/testkit.(*TestKit).MustExec
        	            		pkg/testkit/testkit.go:150
        	            	github.com/pingcap/tidb/pkg/ddl_test.TestRenameTableAutoIDs
        	            		pkg/ddl/schema_test.go:398
        	            	testing.tRunner
        	            		GOROOT/src/testing/testing.go:1595
        	            	runtime.goexit
        	            		src/runtime/asm_amd64.s:1650 
```

https://tiprow.hawkingrei.com/view/gs/pingcapprow/pr-logs/pull/pingcap_tidb/53762/fast_test_tiprow/1797589167828373504

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53765,pingcap/tidb,2024-06-03 11:30:10+00:00,2024-07-18 06:22:33+00:00,2024-07-18 06:22:33+00:00,closed,"['type/bug', 'component/test', 'severity/major', 'feature/developing', 'component/ddl']",Assertion Failure
`SELECT $$` from MySQL Client leads to errors in the logs,"## Bug Report

MySQL Client 8.4.0 sends `SELECT $$` when connecting and this leads to log entries like this:

```json
{
  ""level"": ""INFO"",
  ""time"": ""2024/06/03 10:14:15.875 +02:00"",
  ""caller"": ""conn.go:1151"",
  ""message"": ""command dispatched failed"",
  ""conn"": 2097154,
  ""session_alias"": """",
  ""connInfo"": ""id:2097154, addr:127.0.0.1:57330 status:10, collation:utf8mb4_0900_ai_ci, user:root"",
  ""command"": ""Query"",
  ""status"": ""inTxn:0, autocommit:1"",
  ""sql"": ""select $$"",
  ""txn_mode"": ""PESSIMISTIC"",
  ""timestamp"": 0,
  ""err"": ""[planner:1054]Unknown column '$$' in 'field list'\ngithub.com/pingcap/errors.AddStack\n\t/home/dvaneeden/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/errors.go:178\ngithub.com/pingcap/errors.(*Error).GenWithStackByArgs\n\t/home/dvaneeden/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/normalize.go:175\ngithub.com/pingcap/tidb/pkg/planner/core.(*expressionRewriter).toColumn\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/planner/core/expression_rewriter.go:2438\ngithub.com/pingcap/tidb/pkg/planner/core.(*expressionRewriter).Leave\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/planner/core/expression_rewriter.go:1454\ngithub.com/pingcap/tidb/pkg/parser/ast.(*ColumnName).Accept\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/parser/ast/expressions.go:534\ngithub.com/pingcap/tidb/pkg/parser/ast.(*ColumnNameExpr).Accept\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/parser/ast/expressions.go:607\ngithub.com/pingcap/tidb/pkg/planner/core.rewriteExprNode\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/planner/core/expression_rewriter.go:302\ngithub.com/pingcap/tidb/pkg/planner/core.(*PlanBuilder).rewriteWithPreprocess\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/planner/core/expression_rewriter.go:241\ngithub.com/pingcap/tidb/pkg/planner/core.(*PlanBuilder).buildProjection\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/planner/core/logical_plan_builder.go:1713\ngithub.com/pingcap/tidb/pkg/planner/core.(*PlanBuilder).buildSelect\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/planner/core/logical_plan_builder.go:4238\ngithub.com/pingcap/tidb/pkg/planner/core.(*PlanBuilder).Build\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/planner/core/planbuilder.go:515\ngithub.com/pingcap/tidb/pkg/planner.buildLogicalPlan\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/planner/optimize.go:549\ngithub.com/pingcap/tidb/pkg/planner.optimize\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/planner/optimize.go:466\ngithub.com/pingcap/tidb/pkg/planner.Optimize\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/planner/optimize.go:334\ngithub.com/pingcap/tidb/pkg/executor.(*Compiler).Compile\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/executor/compiler.go:99\ngithub.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/session/session.go:2094\ngithub.com/pingcap/tidb/pkg/server.(*TiDBContext).ExecuteStmt\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/server/driver_tidb.go:294\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).handleStmt\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/server/conn.go:2021\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).handleQuery\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/server/conn.go:1774\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).dispatch\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/server/conn.go:1348\ngithub.com/pingcap/tidb/pkg/server.(*clientConn).Run\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/server/conn.go:1114\ngithub.com/pingcap/tidb/pkg/server.(*Server).onConn\n\t/home/dvaneeden/dev/pingcap/tidb/pkg/server/server.go:739\nruntime.goexit\n\t/usr/lib/golang/src/runtime/asm_amd64.s:1695""
}
```

### 1. Minimal reproduce step (Required)

Connect with MySQL Client 8.4.0
<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

No errors

### 3. What did you see instead (Required)

Error about `SELECT $$`

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->

```
Release Version: v8.2.0-alpha-282-gfc3132ce9b
Edition: Community
Git Commit Hash: fc3132ce9bbc10a36ba94111b50b112d9c330e36
Git Branch: master
UTC Build Time: 2024-06-03 07:50:31
GoVersion: go1.22.3
Race Enabled: false
Check Table Before Drop: false
Store: unistore
```

## Impact on users

1. Adds noise to the logging
2. Might increase error metrics, causing noise in metrics.",https://github.com/pingcap/tidb/issues/53753,pingcap/tidb,2024-06-03 08:16:00+00:00,2025-01-22 12:55:57+00:00,,open,"['type/bug', 'sig/planner', 'severity/moderate', 'compatibility-mysql84']",SQL Syntax / Parsing Error
wrong NDV in the global stats when to disable async-merge-global-stats,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

```
set @@tidb_enable_async_merge_global_stats=OFF;
CREATE TABLE employees  (
    id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    fname VARCHAR(25) NOT NULL,
    lname VARCHAR(25) NOT NULL,
    store_id INT NOT NULL,
    department_id INT NOT NULL
)

PARTITION BY RANGE(id)  (
    PARTITION p0 VALUES LESS THAN (5),
    PARTITION p1 VALUES LESS THAN (10),
    PARTITION p2 VALUES LESS THAN (15),
    PARTITION p3 VALUES LESS THAN MAXVALUE
);



INSERT INTO employees(FNAME,LNAME,STORE_ID,DEPARTMENT_ID) VALUES
    ('Bob', 'Taylor', 3, 2), ('Frank', 'Williams', 1, 2),
    ('Ellen', 'Johnson', 3, 4), ('Jim', 'Smith', 2, 4),
    ('Mary', 'Jones', 1, 1), ('Linda', 'Black', 2, 3),
    ('Ed', 'Jones', 2, 1), ('June', 'Wilson', 3, 1),
    ('Andy', 'Smith', 1, 3), ('Lou', 'Waters', 2, 4),
    ('Jill', 'Stone', 1, 4), ('Roger', 'White', 3, 2),
    ('Howard', 'Andrews', 1, 2), ('Fred', 'Goldberg', 3, 3),
    ('Barbara', 'Brown', 2, 3), ('Alice', 'Rogers', 2, 2),
    ('Mark', 'Morgan', 3, 3), ('Karen', 'Cole', 3, 2);

ANALYZE TABLE employees;

select * from employees;

SHOW STATS_HISTOGRAMS WHERE TABLE_NAME='employees';

alter table employees truncate   partition p0 ; 

select * from employees;

SHOW STATS_HISTOGRAMS WHERE TABLE_NAME='employees';



analyze table employees partition p3;

select * from employees;

SHOW STATS_HISTOGRAMS WHERE TABLE_NAME='employees'

```
<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

```
+---------+------------+----------------+---------------+----------+---------------------+----------------+------------+--------------+-------------+-------------+-----------------+----------------+----------------+---------------+
| Db_name | Table_name | Partition_name | Column_name   | Is_index | Update_time         | Distinct_count | Null_count | Avg_col_size | Correlation | Load_status | Total_mem_usage | Hist_mem_usage | Topn_mem_usage | Cms_mem_usage |
+---------+------------+----------------+---------------+----------+---------------------+----------------+------------+--------------+-------------+-------------+-----------------+----------------+----------------+---------------+
| test    | employees  | global         | id            | 0        | 2024-06-03 14:36:02 | 14             | 0          | 8.0          | 0.0         | allEvicted  | 0               | 0              | 0              | 0             |
| test    | employees  | global         | fname         | 0        | 2024-06-03 14:36:02 | 14             | 0          | 5.29         | 0.0         | allEvicted  | 0               | 0              | 0              | 0             |
| test    | employees  | global         | lname         | 0        | 2024-06-03 14:36:02 | 13             | 0          | 6.63         | 0.0         | allEvicted  | 0               | 0              | 0              | 0             |
| test    | employees  | global         | store_id      | 0        | 2024-06-03 14:36:02 | 3              | 0          | 5.08         | 0.0         | allEvicted  | 0               | 0              | 0              | 0             |
| test    | employees  | global         | department_id | 0        | 2024-06-03 14:36:02 | 4              | 0          | 5.08         | 0.0         | allEvicted  | 0               | 0              | 0              | 0             |
+---------+------------+----------------+---------------+----------+---------------------+----------------+------------+--------------+-------------+-------------+-----------------+----------------+----------------+---------------+
```
### 3. What did you see instead (Required)

```
+---------+------------+----------------+---------------+----------+---------------------+----------------+------------+--------------+-------------+-------------+-----------------+----------------+----------------+---------------+
| Db_name | Table_name | Partition_name | Column_name   | Is_index | Update_time         | Distinct_count | Null_count | Avg_col_size | Correlation | Load_status | Total_mem_usage | Hist_mem_usage | Topn_mem_usage | Cms_mem_usage |
+---------+------------+----------------+---------------+----------+---------------------+----------------+------------+--------------+-------------+-------------+-----------------+----------------+----------------+---------------+
| test    | employees  | global         | id            |        0 | 2024-06-03 15:04:21 |              0 |          0 |            8 |           0 | allEvicted  |               0 |              0 |              0 |             0 |
| test    | employees  | global         | fname         |        0 | 2024-06-03 15:04:21 |              0 |          0 |         5.29 |           0 | allEvicted  |               0 |              0 |              0 |             0 |
| test    | employees  | global         | lname         |        0 | 2024-06-03 15:04:21 |              0 |          0 |         6.63 |           0 | allEvicted  |               0 |              0 |              0 |             0 |
| test    | employees  | global         | store_id      |        0 | 2024-06-03 15:04:21 |              0 |          0 |         5.08 |           0 | allEvicted  |               0 |              0 |              0 |             0 |
| test    | employees  | global         | department_id |        0 | 2024-06-03 15:04:21 |              0 |          0 |         5.08 |           0 | allEvicted  |               0 |              0 |              0 |             0 |
+---------+------------+----------------+---------------+----------+---------------------+----------------+------------+--------------+-------------+-------------+-----------------+----------------+----------------+---------------+
5 rows in set (0.00 sec)
```

### 4. What is your TiDB version? (Required)

master
<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53752,pingcap/tidb,2024-06-03 08:05:46+00:00,2024-06-04 11:01:29+00:00,2024-06-04 11:01:29+00:00,closed,"['type/bug', 'sig/planner', 'severity/major', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1']",Data Corruption
`replace into` with global index report error,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

```
create table t(a varchar(70), b mediumint(9), unique index idx_a(a), unique index idx_b(b)) partition by key(b) partitions 5;
insert into t values ('',826534 );
replace into t values ('',826536 );
```

### 2. What did you expect to see? (Required)

no error

### 3. What did you see instead (Required)

```
mysql> replace into t values ('',826536 );
ERROR 8141 (HY000): assertion failed: key: 7480000000000003bb5f6980000000000000020380000000000c9ca6, assertion: Exist, start_ts: 450206017021804545, existing start ts: 0, existing commit ts: 0
```

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53750,pingcap/tidb,2024-06-03 07:29:50+00:00,2024-06-03 12:19:26+00:00,2024-06-03 12:19:26+00:00,closed,"['type/bug', 'severity/major', 'component/tablepartition', 'feature/developing', 'fuzz/randomtest']",Assertion Failure
The query is inconsistent with MySQL when using the default value of the current_date() column in the function,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
#In TiDB
#table creation
mysql> show create table rand;
+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
| Table | Create Table                                                                                                                                        |
+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
| rand  | CREATE TABLE `rand` (
  `id` int(11) DEFAULT NULL,
  `date_t` date DEFAULT CURRENT_DATE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin |
+-------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql> insert into rand(id) values(1);
Query OK, 1 row affected (0.01 sec)

mysql> insert into rand values(1,'2024-06-03 00:00:00.000000');
Query OK, 1 row affected (0.01 sec)

mysql> select * from rand;
+------+------------+
| id   | date_t     |
+------+------------+
|    1 | 2024-06-03 |
|    1 | 2024-06-03 |
+------+------------+
2 rows in set (0.01 sec)

### 2. What did you expect to see? (Required)
#Behavior in MySQL
root@localhost : test 02:15:59>>> select date_t ,count(*) from rand group by date_t;
+------------+----------+
| date_t     | count(*) |
+------------+----------+
| 2024-06-03 |        2 |
+------------+----------+
1 row in set (0.00 sec)

### 3. What did you see instead (Required)
#Behavior in TiDB 
mysql> select date_t ,count(*) from rand group by date_t;
+------------+----------+
| date_t     | count(*) |
+------------+----------+
| 2024-06-03 |        1 |
| 2024-06-03 |        1 |
+------------+----------+
2 rows in set (0.00 sec)

### 4. What is your TiDB version? (Required)
v7.1.1

<!-- Paste the output of SELECT tidb_version() -->",https://github.com/pingcap/tidb/issues/53746,pingcap/tidb,2024-06-03 06:21:22+00:00,2024-06-21 08:49:21+00:00,2024-06-21 08:49:21+00:00,closed,"['type/bug', 'severity/major', 'affects-7.1', 'component/ddl', 'affects-7.5', 'affects-8.1', 'report/customer']",Incorrect Query Result
The limit subquery in the select position prevents Indexjoin plan,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

MySQL [chad]> show create table ta\G
*************************** 1. row ***************************
       Table: ta
Create Table: CREATE TABLE `ta` (
  `id` int(10) NOT NULL,
  `code` varchar(20) DEFAULT NULL,
  `name` varchar(20) DEFAULT NULL,
  `status` varchar(20) DEFAULT NULL,
  KEY `idx_ta_id` (`id`),
  KEY `idx_ta_code` (`code`),
  KEY `idx_ta_name` (`name`),
  PRIMARY KEY (`id`) /*T![clustered_index] NONCLUSTERED */
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin
1 row in set (0.00 sec)

MySQL [chad]> show create table tb\G
*************************** 1. row ***************************
       Table: tb
Create Table: CREATE TABLE `tb` (
  `id` int(10) NOT NULL,
  `code` varchar(20) DEFAULT NULL,
  `name` varchar(20) DEFAULT NULL,
  `status` varchar(20) DEFAULT NULL,
  KEY `idx_tb_id` (`id`),
  KEY `idx_tb_code` (`code`),
  KEY `idx_tb_name` (`name`),
  PRIMARY KEY (`id`) /*T![clustered_index] NONCLUSTERED */
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin
1 row in set (0.00 sec)


MySQL [chad]> explain select distinct a.code,(select b.code from tb b where a.id = b.id)
    ->   from ta a
    ->  where a.code = 'code10';
+--------------------------------------+---------+-----------+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
| id                                   | estRows | task      | access object                    | operator info                                                                                                               |
+--------------------------------------+---------+-----------+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
| HashAgg_11                           | 1.00    | root      |                                  | group by:chad.ta.code, chad.tb.code, funcs:firstrow(chad.ta.code)->chad.ta.code, funcs:firstrow(chad.tb.code)->chad.tb.code |
| └─IndexJoin_17                       | 1.00    | root      |                                  | left outer join, inner:IndexLookUp_16, outer key:chad.ta.id, inner key:chad.tb.id, equal cond:eq(chad.ta.id, chad.tb.id)    |
|   ├─IndexLookUp_51(Build)            | 1.00    | root      |                                  |                                                                                                                             |
|   │ ├─IndexRangeScan_49(Build)       | 1.00    | cop[tikv] | table:a, index:idx_ta_code(code) | range:[""code10"",""code10""], keep order:false                                                                                 |
|   │ └─TableRowIDScan_50(Probe)       | 1.00    | cop[tikv] | table:a                          | keep order:false                                                                                                            |
|   └─IndexLookUp_16(Probe)            | 1.00    | root      |                                  |                                                                                                                             |
|     ├─IndexRangeScan_14(Build)       | 1.00    | cop[tikv] | table:b, index:idx_tb_id(id)     | range: decided by [eq(chad.tb.id, chad.ta.id)], keep order:false                                                            |
|     └─TableRowIDScan_15(Probe)       | 1.00    | cop[tikv] | table:b                          | keep order:false                                                                                                            |
+--------------------------------------+---------+-----------+----------------------------------+------------------------------------------------------------------------------------------------------------------



### 2. What did you expect to see? (Required)
select distinct a.code,(select b.code from tb b where a.id = b.id limit 1)
  from ta a
 where a.code = 'code10';

> expect to use indexJoin Plan juse like step 1;


### 3. What did you see instead (Required)

select distinct a.code,(select b.code from tb b where a.id = b.id **_limit 1_**)
  from ta a
 where a.code = 'code10';

+--------------------------------------+---------+-----------+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
| id                                   | estRows | task      | access object                    | operator info                                                                                                               |
+--------------------------------------+---------+-----------+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
| HashAgg_14                           | 1.00    | root      |                                  | group by:chad.ta.code, chad.tb.code, funcs:firstrow(chad.ta.code)->chad.ta.code, funcs:firstrow(chad.tb.code)->chad.tb.code |
| └─Apply_16                           | 1.00    | root      |                                  | CARTESIAN left outer join                                                                                                   |
|   ├─IndexLookUp_22(Build)            | 1.00    | root      |                                  |                                                                                                                             |
|   │ ├─IndexRangeScan_20(Build)       | 1.00    | cop[tikv] | table:a, index:idx_ta_code(code) | range:[""code10"",""code10""], keep order:false                                                                                 |
|   │ └─TableRowIDScan_21(Probe)       | 1.00    | cop[tikv] | table:a                          | keep order:false                                                                                                            |
|   └─Projection_35(Probe)             | 1.00    | root      |                                  | chad.tb.code                                                                                                                |
|     └─IndexLookUp_34                 | 1.00    | root      |                                  | limit embedded(offset:0, count:1)                                                                                           |
|       ├─Limit_33(Build)              | 1.00    | cop[tikv] |                                  | offset:0, count:1                                                                                                           |
|       │ └─IndexRangeScan_29          | 1.00    | cop[tikv] | table:b, index:idx_tb_id(id)     | range: decided by [eq(chad.ta.id, chad.tb.id)], keep order:false                                                            |
|       └─TableRowIDScan_30(Probe)     | 1.00    | cop[tikv] | table:b                          | keep order:false                                                                                                            |
+--------------------------------------+---------+-----------+----------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
10 rows in set (0.00 sec)


### 4. What is your TiDB version? (Required)

+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| tidb_version()                                                                                                                                                                                                                                                                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Release Version: v6.5.3-20230628-0b5e28b
Edition: Enterprise
Git Commit Hash: 0b5e28ba481dba574a7fa2ebef8cc9d30440f24e
Git Branch: heads/refs/tags/v6.5.3-20230628-0b5e28b
UTC Build Time: 2023-06-28 09:56:04
GoVersion: go1.19.10
Race Enabled: false
TiKV Min Version: 6.2.0-alpha
Check Table Before Drop: false
Store: tikv |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)",https://github.com/pingcap/tidb/issues/53743,pingcap/tidb,2024-06-03 03:43:06+00:00,2024-11-01 10:04:48+00:00,,open,"['type/bug', 'sig/planner', 'severity/major', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1', 'affects-8.5']",Concurrency Issue
TiDB OOM when SyncLoad statistics in the manytables scenario,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
TiDB 16c 64GB
1. prepare 700k tables and 5000 rows for each table
2. analyze all tables
3. query from tables currently

TiDB OOM for the statistics cache and sync load runtime mem consume
![image](https://github.com/pingcap/tidb/assets/7677963/02ba22ce-7f4c-4229-add2-c759f6d92f6e)

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
master",https://github.com/pingcap/tidb/issues/53742,pingcap/tidb,2024-06-03 03:26:31+00:00,2024-06-13 04:43:31+00:00,2024-06-13 04:43:31+00:00,closed,"['type/bug', 'sig/planner', 'severity/major', 'feature/developing', 'affects-7.5', 'affects-8.1', 'impact/oom']",Memory Leak / Resource Exhaustion
Incorrect results when use default current_date  value in create table,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
##date:2024-06-03

create table t(a date default current_date);
insert into t values();
insert into values(date('2024-06-03 00:00:00.000000'));

select count(*) from t where a='2024-06-03';
select * from t where a like '2024-06-03';

### 2. What did you expect to see? (Required)
select count(*) from t where a='2024-06-03';
result:2
select * from t where a like '2024-06-03';
result:2

### 3. What did you see instead (Required)
select count(*) from t where a='2024-06-03';
result:1
select * from t where a like '2024-06-03';
result:2

### 4. What is your TiDB version? (Required)
v7.1.1",https://github.com/pingcap/tidb/issues/53741,pingcap/tidb,2024-06-03 03:12:13+00:00,2024-06-05 07:35:18+00:00,2024-06-05 07:35:08+00:00,closed,"['type/bug', 'sig/sql-infra', 'severity/critical', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1', 'impact/wrong-result']",Incorrect Query Result
runtime error: index out of range [3960] with length 3952 in `chunk.(*Column).GetDecimal`,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

```sql
create table t_ldpj7bp ( 
c_w_jr14qm2 int ,
c_t3nd927 int ,
c_ts int ,
c_s text ,
c_qchmg double ,
c_r int ,
c_olb3fsg6 text ,
c_zkbe tinyint ,
primary key(c_w_jr14qm2) NONCLUSTERED) shard_row_id_bits=8 pre_split_regions=5;

insert into t_ldpj7bp (c_w_jr14qm2, c_t3nd927, c_ts, c_s, c_qchmg, c_r, c_olb3fsg6, c_zkbe) values 
  (730552758, -682774206, 1698439632, 'lrvil359', 18446744073709551616.5, cast(cast(null as signed) as signed), 'oj1', (-1367510804 in (
    2123597870, 1485484027))), 
  (-1001332962, -1396443960, cast(cast(null as signed) as signed), 'e43lh', 15.54, -1568307927, 'i', (-1162033997 not in (
    -1850570375, -781179836, -1281662147, -431391092, cast(null as signed)))), 
  (-727295464, 1998529670, -1873237194, 'lps56o', 70.81, 1380690610, cast(null as char), ((NOT NOT(cast( (cast(cast(null as signed) as signed) && cast(2536017375093623800 as signed)) as unsigned)))) 
    and ((NOT NOT(cast( (cast(2051320819 as signed) <=> cast(-8632453786780487783 as signed)) as unsigned))))), 
  (2133408768, 736339957, -1486317339, 'f', 62.97, -1444096406, 'tj', (NOT NOT(cast( (cast(cast(null as char) as char) = cast(cast(null as char) as char)) as unsigned))));

SELECT DISTINCT
  cast(ref_4.c_w_jr14qm2 as signed) as c6,
  cast(ref_4.c_w_jr14qm2 as decimal) as c8
FROM
  t_ldpj7bp as ref_4;
```

### 2. What did you expect to see? (Required)
Expect no crashes
### 3. What did you see instead (Required)
```
""runtime error: index out of range [3960] with length 3952
github.com/pingcap/errors.AddStack
	/root/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/errors.go:178
github.com/pingcap/errors.Trace
	/root/go/pkg/mod/github.com/pingcap/errors@v0.11.5-0.20240318064555-6bd07397691f/juju_adaptor.go:15
github.com/pingcap/tidb/pkg/util.GetRecoverError
	/workspace/source/tidb/pkg/util/util.go:304
github.com/pingcap/tidb/pkg/executor/aggregate.recoveryHashAgg
	/workspace/source/tidb/pkg/executor/aggregate/agg_util.go:53
github.com/pingcap/tidb/pkg/executor/aggregate.(*HashAggPartialWorker).run.func1
	/workspace/source/tidb/pkg/executor/aggregate/agg_hash_partial_worker.go:194
runtime.gopanic
	/usr/local/go/src/runtime/panic.go:914
runtime.goPanicIndex
	/usr/local/go/src/runtime/panic.go:114
github.com/pingcap/tidb/pkg/util/chunk.(*Column).GetDecimal
	/workspace/source/tidb/pkg/util/chunk/column.go:583
github.com/pingcap/tidb/pkg/util/chunk.Row.GetMyDecimal
	/workspace/source/tidb/pkg/util/chunk/row.go:110
github.com/pingcap/tidb/pkg/expression.(*Column).EvalDecimal
	/workspace/source/tidb/pkg/expression/column.go:478
github.com/pingcap/tidb/pkg/executor/aggfuncs.(*firstRow4Decimal).UpdatePartialResult
	/workspace/source/tidb/pkg/executor/aggfuncs/func_first_row.go:601
github.com/pingcap/tidb/pkg/executor/aggregate.(*HashAggPartialWorker).updatePartialResult
	/workspace/source/tidb/pkg/executor/aggregate/agg_hash_partial_worker.go:275
github.com/pingcap/tidb/pkg/executor/aggregate.(*HashAggPartialWorker).fetchChunkAndProcess
	/workspace/source/tidb/pkg/executor/aggregate/agg_hash_partial_worker.go:108
github.com/pingcap/tidb/pkg/executor/aggregate.(*HashAggPartialWorker).run
	/workspace/source/tidb/pkg/executor/aggregate/agg_hash_partial_worker.go:208
runtime.goexit
	/usr/local/go/src/runtime/asm_amd64.s:1650""]




```
### 4. What is your TiDB version? (Required)

```
Release Version: v8.1.0
Edition: Community
Git Commit Hash: 945d07c5d5c7a1ae212f6013adfb187f2de24b23
Git Branch: HEAD
UTC Build Time: 2024-05-21 03:51:57
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv
```

We are the BASS team from the School of Cyber Science and Technology at Beihang University. Our main focus is on system software security, operating systems, and program analysis research, as well as the development of automated program testing frameworks for detecting software defects. Using our self-developed database vulnerability testing tool, we have identified the above-mentioned vulnerabilities in TiDB that may lead to database crashes.",https://github.com/pingcap/tidb/issues/53733,pingcap/tidb,2024-06-01 09:18:40+00:00,2024-06-28 08:28:57+00:00,2024-06-28 08:28:57+00:00,closed,"['type/bug', 'sig/execution', 'severity/major', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1', 'impact/panic']",Crash / Segmentation Fault
runtime error: index out of range [-1] in `core.(*LogicalProjection).TryToGetChildProp`,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

```sql
create table t_ot8lohr ( 
c_tausij int ,
c_q7_e5485m tinyint ,
c_gk06ao9l text ,
c_hymp tinyint ,
c_dbby9f_xj int unique ,
c_b1wzx9ayt3 int ,
primary key(c_b1wzx9ayt3, c_dbby9f_xj) CLUSTERED) pre_split_regions=5;

alter table t_ot8lohr add column c_fw text;

alter table t_ot8lohr add column c_s1_2 tinyint;

create table t_ldpj7bp ( 
c_w_jr14qm2 int ,
c_t3nd927 int ,
c_ts int ,
c_s text ,
c_qchmg double ,
c_r int ,
c_olb3fsg6 text ,
c_zkbe tinyint ,
primary key(c_w_jr14qm2) NONCLUSTERED) shard_row_id_bits=8 pre_split_regions=5;

create table t_d3zi ( 
c_kh2bh int unique ,
c_fug9i5u6s text not null ,
c_ar5p4u double unique ,
primary key(c_kh2bh) CLUSTERED) pre_split_regions=2;

WITH
cte_6 AS (
SELECT
  cast(nullif(
      ref_12.c_fw, 
      ref_12.c_gk06ao9l
      ) as char) as c0,
  ref_12.c_gk06ao9l as c1,
  cast(nullif(
      ref_12.c_s1_2, 
      (ref_12.c_gk06ao9l like 'zbq_0gfhg')
      ) as unsigned) as c2,
  ref_12.c_tausij as c3,
  ref_12.c_q7_e5485m as c4,
  ref_12.c_dbby9f_xj as c5,
  ref_12.c_fw as c6,
  case when (ref_12.c_fw like 'm0%0v_yy5') then 1627816122 else ref_12.c_b1wzx9ayt3 end
       as c7,
  ref_12.c_hymp as c8,
  (select c_kh2bh from t_d3zi order by c_kh2bh limit 1 offset 4)
       as c9,
  case when (ref_12.c_tausij between ref_12.c_dbby9f_xj and ref_12.c_b1wzx9ayt3) then ref_12.c_hymp else (ref_12.c_q7_e5485m in (
        select  
              0<>0 as c0
            from 
              t_d3zi as ref_13
            where 0<>0
          union
          (
          select  
              0<>0 as c0
            from 
              t_ot8lohr as ref_14
            where 1=1
          ))) end
       as c10,
  case when (((NOT NOT(cast( (cast(cast(null as char) as char) <> cast(cast(null as char) as char)) as unsigned)))) 
          or (((NOT NOT(cast( (cast(null as signed) = 0<>0) as unsigned)))) 
            and (1=1))) 
        or (1=1) then ref_12.c_b1wzx9ayt3 else case when (ref_12.c_tausij not in (
          select  
                510416017 as c0
              from 
                t_d3zi as ref_15
              where 0<>0
            union
            (
            select distinct 
                -1672700381 as c0
              from 
                t_d3zi as ref_16
              where 0<>0
            ))) then ref_12.c_tausij else ref_12.c_b1wzx9ayt3 end
         end
       as c11
FROM
  t_ot8lohr as ref_12
WHERE
  0<>0
ORDER BY
  c0, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11 ASC
LIMIT 106
),
cte_11 AS (
SELECT
  ref_32.c_fw as c10
FROM
  t_ot8lohr as ref_32
WHERE
  ((NOT NOT(cast( (cast(ref_32.c_s1_2 as signed) <> cast(8543206161972668374 as signed)) as unsigned)))) 
    or (((ref_32.c_dbby9f_xj in (
        select  
              -1355902245 as c0
            from 
              t_ldpj7bp as ref_33
            where (1=1) 
              or (0<>0)
          union
          (
          select  
              1726075521 as c0
            from 
              t_ldpj7bp as ref_34
            where (1=1) 
              and (1=1)
          )))) 
      and ((cast( (cast(0<>0 as unsigned) ^ cast(2959261798443851486 as signed)) as signed) >= ( 
        select  
            -4601281837643267233 as c0
          from 
            t_ldpj7bp as ref_35
          where (ref_32.c_fw like '%r_nn2zs')
          order by c0 desc
          limit 1))))
)
SELECT
  cume_dist() over win_vus2fher4 as c0
FROM
  cte_6 as ref_69
WHERE
  1=1
  window win_vus2fher4 as ( partition by ref_69.c5, (select c10 from cte_11 order by c10 limit 1 offset 5)
       order by ref_69.c0, ref_69.c1, ref_69.c2, ref_69.c3, ref_69.c4, ref_69.c5, ref_69.c6, ref_69.c7, ref_69.c8, ref_69.c9, ref_69.c10, ref_69.c11 asc)
ORDER BY
  c0 DESC
LIMIT 91;
```

### 2. What did you expect to see? (Required)
Expect no crashes
### 3. What did you see instead (Required)
```
""runtime error: index out of range [-1]""] [stack=""github.com/pingcap/tidb/pkg/server.(*clientConn).Run.func1
	/workspace/source/tidb/pkg/server/conn.go:1015
runtime.gopanic
	/usr/local/go/src/runtime/panic.go:914
github.com/pingcap/tidb/pkg/executor.(*Compiler).Compile.func1
	/workspace/source/tidb/pkg/executor/compiler.go:56
runtime.gopanic
	/usr/local/go/src/runtime/panic.go:914
runtime.goPanicIndex
	/usr/local/go/src/runtime/panic.go:114
github.com/pingcap/tidb/pkg/planner/core.(*LogicalProjection).TryToGetChildProp
	/workspace/source/tidb/pkg/planner/core/exhaust_physical_plans.go:2558
github.com/pingcap/tidb/pkg/planner/core.(*LogicalProjection).exhaustPhysicalPlans
	/workspace/source/tidb/pkg/planner/core/exhaust_physical_plans.go:2603
github.com/pingcap/tidb/pkg/planner/core.(*baseLogicalPlan).findBestTask
	/workspace/source/tidb/pkg/planner/core/find_best_task.go:580
github.com/pingcap/tidb/pkg/planner/core.(*baseLogicalPlan).iteratePhysicalPlan
	/workspace/source/tidb/pkg/planner/core/find_best_task.go:308
github.com/pingcap/tidb/pkg/planner/core.(*baseLogicalPlan).enumeratePhysicalPlans4Task
	/workspace/source/tidb/pkg/planner/core/find_best_task.go:234
github.com/pingcap/tidb/pkg/planner/core.(*baseLogicalPlan).findBestTask
	/workspace/source/tidb/pkg/planner/core/find_best_task.go:620
github.com/pingcap/tidb/pkg/planner/core.(*baseLogicalPlan).iteratePhysicalPlan
	/workspace/source/tidb/pkg/planner/core/find_best_task.go:308
github.com/pingcap/tidb/pkg/planner/core.(*baseLogicalPlan).enumeratePhysicalPlans4Task
	/workspace/source/tidb/pkg/planner/core/find_best_task.go:234
github.com/pingcap/tidb/pkg/planner/core.(*baseLogicalPlan).findBestTask
	/workspace/source/tidb/pkg/planner/core/find_best_task.go:620
github.com/pingcap/tidb/pkg/planner/core.(*baseLogicalPlan).iteratePhysicalPlan
	/workspace/source/tidb/pkg/planner/core/find_best_task.go:308
github.com/pingcap/tidb/pkg/planner/core.(*baseLogicalPlan).enumeratePhysicalPlans4Task
	/workspace/source/tidb/pkg/planner/core/find_best_task.go:234
github.com/pingcap/tidb/pkg/planner/core.(*baseLogicalPlan).findBestTask
	/workspace/source/tidb/pkg/planner/core/find_best_task.go:620
github.com/pingcap/tidb/pkg/planner/core.physicalOptimize
	/workspace/source/tidb/pkg/planner/core/optimizer.go:1214
github.com/pingcap/tidb/pkg/planner/core.doOptimize
	/workspace/source/tidb/pkg/planner/core/optimizer.go:298
github.com/pingcap/tidb/pkg/planner/core.DoOptimize
	/workspace/source/tidb/pkg/planner/core/optimizer.go:348
github.com/pingcap/tidb/pkg/planner.optimize
	/workspace/source/tidb/pkg/planner/optimize.go:502
github.com/pingcap/tidb/pkg/planner.Optimize
	/workspace/source/tidb/pkg/planner/optimize.go:333
github.com/pingcap/tidb/pkg/executor.(*Compiler).Compile
	/workspace/source/tidb/pkg/executor/compiler.go:104
github.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt
	/workspace/source/tidb/pkg/session/session.go:2086
github.com/pingcap/tidb/pkg/server.(*TiDBContext).ExecuteStmt
	/workspace/source/tidb/pkg/server/driver_tidb.go:294
github.com/pingcap/tidb/pkg/server.(*clientConn).handleStmt
	/workspace/source/tidb/pkg/server/conn.go:2016
github.com/pingcap/tidb/pkg/server.(*clientConn).handleQuery
	/workspace/source/tidb/pkg/server/conn.go:1769
github.com/pingcap/tidb/pkg/server.(*clientConn).dispatch
	/workspace/source/tidb/pkg/server/conn.go:1343
github.com/pingcap/tidb/pkg/server.(*clientConn).Run
	/workspace/source/tidb/pkg/server/conn.go:1113
github.com/pingcap/tidb/pkg/server.(*Server).onConn
	/workspace/source/tidb/pkg/server/server.go:739""]


```
### 4. What is your TiDB version? (Required)

```
Release Version: v8.1.0
Edition: Community
Git Commit Hash: 945d07c5d5c7a1ae212f6013adfb187f2de24b23
Git Branch: HEAD
UTC Build Time: 2024-05-21 03:51:57
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv
```

We are the BASS team from the School of Cyber Science and Technology at Beihang University. Our main focus is on system software security, operating systems, and program analysis research, as well as the development of automated program testing frameworks for detecting software defects. Using our self-developed database vulnerability testing tool, we have identified the above-mentioned vulnerabilities in TiDB that may lead to database crashes.",https://github.com/pingcap/tidb/issues/53732,pingcap/tidb,2024-06-01 09:17:12+00:00,2024-08-06 08:45:36+00:00,2024-08-06 08:45:36+00:00,closed,"['type/bug', 'sig/planner', 'severity/major', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'fuzz/randomtest', 'may-affects-8.1', 'impact/panic']",Crash / Segmentation Fault
runtime error: invalid memory address or nil pointer dereference in `expression.typeInferForNull`,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

```sql
create table t_ot8lohr ( 
c_tausij int ,
c_q7_e5485m tinyint ,
c_gk06ao9l text ,
c_hymp tinyint ,
c_dbby9f_xj int unique ,
c_b1wzx9ayt3 int ,
primary key(c_b1wzx9ayt3, c_dbby9f_xj) CLUSTERED) pre_split_regions=5;

create table t_d3zi ( 
c_kh2bh int unique ,
c_fug9i5u6s text not null ,
c_ar5p4u double unique ,
primary key(c_kh2bh) CLUSTERED) pre_split_regions=2;

WITH
cte_0 AS (
SELECT
  space(
      28) as c3
FROM
  t_d3zi as ref_0
WHERE
  (NOT NOT(cast( (cast(ref_0.c_kh2bh as signed) <= cast(truncate(
        cast(round(
          cast(ref_0.c_kh2bh as decimal)) as decimal), 
        cast((select count(c_fug9i5u6s) from t_d3zi)
           as char)) as decimal)) as unsigned)))
  window win__ as ( partition by locate(
      cast(ref_0.c_fug9i5u6s as char), 
      cast(ref_0.c_fug9i5u6s as char), 
      cast(case when (NOT NOT(cast( (cast(ref_0.c_kh2bh as decimal) && cast(ref_0.c_ar5p4u as double)) as unsigned))) then cast(ref_0.c_kh2bh as signed) else cast(ref_0.c_kh2bh as signed) end
         as signed)), ref_0.c_ar5p4u order by ref_0.c_kh2bh, ref_0.c_fug9i5u6s, ref_0.c_ar5p4u asc)
ORDER BY
  c3 ASC
LIMIT 53
),
cte_1 AS (
SELECT
  to_base64(
      cast(ref_3.c_fug9i5u6s as char)) as c0,
  ref_3.c_ar5p4u as c7,
  ref_3.c_fug9i5u6s as c9,
  ref_3.c_kh2bh as c10,
  trim(
      cast(cast(null as char) as char)) as c11
FROM
  t_d3zi as ref_3
WHERE
  0<>0
ORDER BY
  c0, c7, c9, c10, c11 ASC
LIMIT 42
)
SELECT
  cast( (cast(ref_4.c10 as signed) > cast((select count(c_q7_e5485m) from t_ot8lohr)
         as signed)) as unsigned) as c2
FROM
  cte_1 as ref_4
WHERE
  (case when (ref_4.c7 is not NULL) then ref_4.c11 else ref_4.c0 end
       = ( 
    select  
        case when 0<>0 then ref_4.c9 else ref_4.c0 end
           as c0
      from 
        cte_0 as ref_5
      where (ref_4.c7 = ( 
        select  
              34.38 as c0
            from 
              t_ot8lohr as ref_6
            where (NOT NOT(cast( (cast(-11252 as signed) && cast(cast(null as signed) as signed)) as unsigned)))
          union
          (
          select  
              18446744073709551615.4 as c0
            from 
              cte_1 as ref_7
            where (-203518267 is not NULL)
          )
          order by c0 limit 1))
      order by c0 asc
      limit 1));
```

### 2. What did you expect to see? (Required)
Expect no crashes
### 3. What did you see instead (Required)
```
""runtime error: invalid memory address or nil pointer dereference""] [stack=""github.com/pingcap/tidb/pkg/server.(*clientConn).Run.func1
	/workspace/source/tidb/pkg/server/conn.go:1015
runtime.gopanic
	/usr/local/go/src/runtime/panic.go:914
github.com/pingcap/tidb/pkg/executor.(*Compiler).Compile.func1
	/workspace/source/tidb/pkg/executor/compiler.go:56
runtime.gopanic
	/usr/local/go/src/runtime/panic.go:914
runtime.panicmem
	/usr/local/go/src/runtime/panic.go:261
runtime.sigpanic
	/usr/local/go/src/runtime/signal_unix.go:861
github.com/pingcap/tidb/pkg/expression.typeInferForNull
	/workspace/source/tidb/pkg/expression/scalar_function.go:165
github.com/pingcap/tidb/pkg/expression.newFunctionImpl
	/workspace/source/tidb/pkg/expression/scalar_function.go:248
github.com/pingcap/tidb/pkg/expression.NewFunction
	/workspace/source/tidb/pkg/expression/scalar_function.go:300
github.com/pingcap/tidb/pkg/expression.NewFunctionInternal
	/workspace/source/tidb/pkg/expression/scalar_function.go:320
github.com/pingcap/tidb/pkg/expression.evaluateExprWithNullInNullRejectCheck
	/workspace/source/tidb/pkg/expression/expression.go:944
github.com/pingcap/tidb/pkg/expression.EvaluateExprWithNull
	/workspace/source/tidb/pkg/expression/expression.go:870
github.com/pingcap/tidb/pkg/planner/core.isNullRejected
	/workspace/source/tidb/pkg/planner/core/rule_predicate_push_down.go:440
github.com/pingcap/tidb/pkg/planner/core.simplifyOuterJoin
	/workspace/source/tidb/pkg/planner/core/rule_predicate_push_down.go:408
github.com/pingcap/tidb/pkg/planner/core.(*LogicalJoin).PredicatePushDown
	/workspace/source/tidb/pkg/planner/core/rule_predicate_push_down.go:154
github.com/pingcap/tidb/pkg/planner/core.(*LogicalSelection).PredicatePushDown
	/workspace/source/tidb/pkg/planner/core/rule_predicate_push_down.go:108
github.com/pingcap/tidb/pkg/planner/core.(*baseLogicalPlan).PredicatePushDown
	/workspace/source/tidb/pkg/planner/core/rule_predicate_push_down.go:81
github.com/pingcap/tidb/pkg/planner/core.(*LogicalProjection).PredicatePushDown
	/workspace/source/tidb/pkg/planner/core/rule_predicate_push_down.go:526
github.com/pingcap/tidb/pkg/planner/core.(*ppdSolver).optimize
	/workspace/source/tidb/pkg/planner/core/rule_predicate_push_down.go:46
github.com/pingcap/tidb/pkg/planner/core.logicalOptimize
	/workspace/source/tidb/pkg/planner/core/optimizer.go:1148
github.com/pingcap/tidb/pkg/planner/core.doOptimize
	/workspace/source/tidb/pkg/planner/core/optimizer.go:286
github.com/pingcap/tidb/pkg/planner/core.DoOptimize
	/workspace/source/tidb/pkg/planner/core/optimizer.go:348
github.com/pingcap/tidb/pkg/planner.optimize
	/workspace/source/tidb/pkg/planner/optimize.go:502
github.com/pingcap/tidb/pkg/planner.Optimize
	/workspace/source/tidb/pkg/planner/optimize.go:333
github.com/pingcap/tidb/pkg/executor.(*Compiler).Compile
	/workspace/source/tidb/pkg/executor/compiler.go:104
github.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt
	/workspace/source/tidb/pkg/session/session.go:2086
github.com/pingcap/tidb/pkg/server.(*TiDBContext).ExecuteStmt
	/workspace/source/tidb/pkg/server/driver_tidb.go:294
github.com/pingcap/tidb/pkg/server.(*clientConn).handleStmt
	/workspace/source/tidb/pkg/server/conn.go:2016
github.com/pingcap/tidb/pkg/server.(*clientConn).handleQuery
	/workspace/source/tidb/pkg/server/conn.go:1769
github.com/pingcap/tidb/pkg/server.(*clientConn).dispatch
	/workspace/source/tidb/pkg/server/conn.go:1343
github.com/pingcap/tidb/pkg/server.(*clientConn).Run
	/workspace/source/tidb/pkg/server/conn.go:1113
github.com/pingcap/tidb/pkg/server.(*Server).onConn
	/workspace/source/tidb/pkg/server/server.go:739""]
```
### 4. What is your TiDB version? (Required)

```
Release Version: v8.1.0
Edition: Community
Git Commit Hash: 945d07c5d5c7a1ae212f6013adfb187f2de24b23
Git Branch: HEAD
UTC Build Time: 2024-05-21 03:51:57
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv
```

We are the BASS team from the School of Cyber Science and Technology at Beihang University. Our main focus is on system software security, operating systems, and program analysis research, as well as the development of automated program testing frameworks for detecting software defects. Using our self-developed database vulnerability testing tool, we have identified the above-mentioned vulnerabilities in TiDB that may lead to database crashes.",https://github.com/pingcap/tidb/issues/53731,pingcap/tidb,2024-06-01 09:14:41+00:00,2024-07-17 10:46:43+00:00,2024-07-17 10:46:43+00:00,closed,"['type/bug', 'sig/planner', 'severity/major', 'may-affects-5.4', 'may-affects-6.1', 'may-affects-6.5', 'may-affects-7.1', 'may-affects-7.5', 'may-affects-8.1', 'impact/panic']",Crash / Segmentation Fault
Unexpected eliminated conditions in the connection with utf8mb4 charset,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

create table t (id int primary key, name varchar(20));
insert into t values(1, 'a'), (2, 'a ');
select * from t where name='a' and length(name)=1;

### 2. What did you expect to see? (Required)

```
mysql> set names utf8;
Query OK, 0 rows affected (0.00 sec)

mysql>  select * from t where name='a' and length(name)=1;
+----+------+
| id | name |
+----+------+
|  1 | a    |
+----+------+
1 row in set (0.00 sec)
mysql> explain select * from t where name='a' and length(name)=1;
+-------------------------+---------+-----------+---------------+--------------------------------------------------+
| id                      | estRows | task      | access object | operator info                                    |
+-------------------------+---------+-----------+---------------+--------------------------------------------------+
| TableReader_7           | 0.00    | root      |               | data:Selection_6                                 |
| └─Selection_6           | 0.00    | cop[tikv] |               | eq(length(test.t.name), 1), eq(test.t.name, ""a"") |
|   └─TableFullScan_5     | 2.00    | cop[tikv] | table:t       | keep order:false, stats:pseudo                   |
+-------------------------+---------+-----------+---------------+--------------------------------------------------+
3 rows in set (0.00 sec)
```

### 3. What did you see instead (Required)


```
mysql> set names utf8mb4;
Query OK, 0 rows affected (0.00 sec)

mysql>  select * from t where name='a' and length(name)=1;
+----+------+
| id | name |
+----+------+
|  1 | a    |
|  2 | a    |
+----+------+
2 rows in set (0.00 sec)

mysql> explain select * from t where name='a' and length(name)=1;
+-------------------------+---------+-----------+---------------+--------------------------------+
| id                      | estRows | task      | access object | operator info                  |
+-------------------------+---------+-----------+---------------+--------------------------------+
| TableReader_7           | 0.00    | root      |               | data:Selection_6               |
| └─Selection_6           | 0.00    | cop[tikv] |               | eq(test.t.name, ""a"")           |
|   └─TableFullScan_5     | 2.00    | cop[tikv] | table:t       | keep order:false, stats:pseudo |
+-------------------------+---------+-----------+---------------+--------------------------------+
3 rows in set (0.00 sec)
```

### 4. What is your TiDB version? (Required)

v6.5.6",https://github.com/pingcap/tidb/issues/53730,pingcap/tidb,2024-05-31 15:56:38+00:00,2024-06-27 03:19:24+00:00,2024-06-27 03:19:24+00:00,closed,"['type/bug', 'sig/planner', 'severity/major', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1', 'impact/wrong-result']",Incorrect Query Result
batch client panic when close,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

```log
```
RunBrBackup: cmd start at 2024-05-30 14:49:31
cmd failed at 2024-05-30 14:58:32
stdout:
Detail BR log in /tmp/br.log.2024-05-30T06.49.31Z 
panic: close of closed channel

goroutine 2822 [running]:
[github.com/tikv/client-go/v2/internal/client.(*batchConn).Close(...)](http://github.com/tikv/client-go/v2/internal/client.(*batchConn).Close(...))
        /root/go/pkg/mod/[github.com/tikv/client-go/v2@v2.0.8-0.20240528025037-f41b068bf706/internal/client/client_batch.go:769](http://github.com/tikv/client-go/v2@v2.0.8-0.20240528025037-f41b068bf706/internal/client/client_batch.go:769)
[github.com/tikv/client-go/v2/internal/client.(*connArray).Close(0xc0004bb560)](http://github.com/tikv/client-go/v2/internal/client.(*connArray).Close(0xc0004bb560))
        /root/go/pkg/mod/[github.com/tikv/client-go/v2@v2.0.8-0.20240528025037-f41b068bf706/internal/client/client.go:330](http://github.com/tikv/client-go/v2@v2.0.8-0.20240528025037-f41b068bf706/internal/client/client.go:330) +0xf6
[github.com/tikv/client-go/v2/internal/client.(*RPCClient).CloseAddr](http://github.com/tikv/client-go/v2/internal/client.(*RPCClient).CloseAddr)(0xc0007e3680, {0xc000f7e7d0, 0x44})
        /root/go/pkg/mod/[github.com/tikv/client-go/v2@v2.0.8-0.20240528025037-f41b068bf706/internal/client/client.go:797](http://github.com/tikv/client-go/v2@v2.0.8-0.20240528025037-f41b068bf706/internal/client/client.go:797) +0x1e5
[github.com/tikv/client-go/v2/internal/client.(*RPCClient).recycleIdleConnArray(0xc0007e3680)](http://github.com/tikv/client-go/v2/internal/client.(*RPCClient).recycleIdleConnArray(0xc0007e3680))
        /root/go/pkg/mod/[github.com/tikv/client-go/v2@v2.0.8-0.20240528025037-f41b068bf706/internal/client/client_batch.go:835](http://github.com/tikv/client-go/v2@v2.0.8-0.20240528025037-f41b068bf706/internal/client/client_batch.go:835) +0x1f7
created by [github.com/tikv/client-go/v2/internal/client.(*RPCClient).sendRequest](http://github.com/tikv/client-go/v2/internal/client.(*RPCClient).sendRequest) in goroutine 2821
        /root/go/pkg/mod/[github.com/tikv/client-go/v2@v2.0.8-0.20240528025037-f41b068bf706/internal/client/client.go:587](http://github.com/tikv/client-go/v2@v2.0.8-0.20240528025037-f41b068bf706/internal/client/client.go:587) +0x34b
```
```

<!-- a step by step guide for reproducing the bug. -->

### 2. What did you expect to see? (Required)

### 3. What did you see instead (Required)

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->

release-7.5: 84e292668495cba54fc5a7a157b7e0519c4267e4",https://github.com/pingcap/tidb/issues/53727,pingcap/tidb,2024-05-31 14:44:45+00:00,2024-10-29 09:17:11+00:00,2024-10-29 09:17:11+00:00,closed,"['type/bug', 'sig/transaction', 'severity/major', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1', 'impact/panic']",Crash / Segmentation Fault
`select distinct` produces unexpected result,"### 1. Minimal reproduce step (Required)
```sql
create table t1 (c1 int primary key);
insert into t1 (c1) values (575932053), (-258025139);

SELECT DISTINCT
  cast(c1 as decimal) as c3,
  cast(c1 as signed) as c4
FROM t1;
```

### 2. What did you expect to see? (Required)
The two columns should be same, in MySQL:
```
mysql> SELECT DISTINCT 
    ->   cast(c1 as decimal) as c3,
    ->   cast(c1 as signed) as c4
    -> FROM t1;
+------------+------------+
| c3         | c4         |
+------------+------------+
| -258025139 | -258025139 |
|  575932053 |  575932053 |
+------------+------------+
2 rows in set (0.00 sec)
```
### 3. What did you see instead (Required)
But TiDB outputs strange number.
```
mysql> SELECT DISTINCT 
    ->   cast(c1 as decimal) as c3,
    ->   cast(c1 as signed) as c4
    -> FROM t1;
+------------+---------------------+
| c3         | c4                  |
+------------+---------------------+
| -258025139 | 1108209533567631369 |
|  575932053 |                   0 |
+------------+---------------------+
2 rows in set (0.01 sec)
```
After removing `distinct`, the result is correct:
```
mysql> SELECT
    ->   cast(c1 as decimal) as c3,
    ->   cast(c1 as signed) as c4
    -> FROM t1;
+------------+------------+
| c3         | c4         |
+------------+------------+
| -258025139 | -258025139 |
|  575932053 |  575932053 |
+------------+------------+
2 rows in set (0.00 sec)
```
### 4. What is your TiDB version? (Required)
```
Release Version: v8.1.0
Edition: Community
Git Commit Hash: 945d07c5d5c7a1ae212f6013adfb187f2de24b23
Git Branch: HEAD
UTC Build Time: 2024-05-21 03:51:57
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: tikv
```
topology:

distributed.yaml:
```
global:
  user: ""tidb""
  ssh_port: 22
  deploy_dir: ""/tidb-deploy""
  data_dir: ""/tidb-data""

pd_servers:
  - host: 10.0.2.31

tidb_servers:
  - host: 10.0.2.21

tikv_servers:
  - host: 10.0.2.11
  - host: 10.0.2.12
  - host: 10.0.2.13

monitoring_servers:
  - host: 10.0.2.8

grafana_servers:
  - host: 10.0.2.8

alertmanager_servers:
  - host: 10.0.2.8

tiflash_servers:
  - host: 10.0.2.32
```



### about us
We are the BASS team from the School of Cyber Science and Technology at Beihang University. Our main focus is on system software security, operating systems, and program analysis research, as well as the development of automated program testing frameworks for detecting software defects. Using our self-developed database vulnerability testing tool, we have identified the above-mentioned vulnerabilities in TiDB that may lead to database logic error.",https://github.com/pingcap/tidb/issues/53726,pingcap/tidb,2024-05-31 14:02:26+00:00,2024-06-24 06:00:22+00:00,2024-06-19 12:10:18+00:00,closed,"['type/bug', 'sig/planner', 'severity/critical', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'affects-8.1', 'impact/wrong-result']",Incorrect Query Result
"Unstable test TestTruncatePartitionWithGlobalIndex, related to InfoSchema v2","## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)

<!-- a step by step guide for reproducing the bug. -->
```sh
(cd pkg/ddl/tests/partition/ ; go test -v -run TestTruncatePartitionWithGlobalIndex -tags=intest -count 1000 -failfast)
```

### 2. What did you expect to see? (Required)
Success

### 3. What did you see instead (Required)
Failure, part of log:
```
[2024/05/31 09:42:20.260 +00:00] [INFO] [session.go:3959] [""CRUCIAL OPERATION""] [conn=1] [schemaVersion=64] [cur_db=test] [sql=""alter table test_global truncate partition p2;""] [user=]
[2024/05/31 09:42:20.273 +00:00] [INFO] [set.go:170] [""set global var""] [conn=3] [name=tidb_schema_cache_size] [val=1073741824]
[2024/05/31 09:42:20.307 +00:00] [INFO] [ddl_worker.go:261] [""add DDL jobs""] [category=ddl] [""batch count""=1] [jobs=""ID:111, Type:truncate partition, State:queueing, SchemaState:public, SchemaID:2, TableID:104, RowCount:0, ArgLen:2, start time: 2024-05-31 09:42:20.3 +0000 UTC, Err:<nil>, ErrCount:0, SnapshotVersion:0, LocalMode: false; ""] [table=true]
[2024/05/31 09:42:20.307 +00:00] [INFO] [ddl.go:1192] [""start DDL job""] [category=ddl] [job=""ID:111, Type:truncate partition, State:queueing, SchemaState:public, SchemaID:2, TableID:104, RowCount:0, ArgLen:2, start time: 2024-05-31 09:42:20.3 +0000 UTC, Err:<nil>, ErrCount:0, SnapshotVersion:0, LocalMode: false""] [query=""alter table test_global truncate partition p2;""]
[2024/05/31 09:42:20.310 +00:00] [INFO] [set.go:170] [""set global var""] [conn=4] [name=tidb_schema_cache_size] [val=1073741824]
[2024/05/31 09:42:20.330 +00:00] [INFO] [ddl_worker.go:1210] [""run DDL job""] [worker=""worker 6, tp general""] [category=ddl] [jobID=111] [conn=1] [category=ddl] [job=""ID:111, Type:truncate partition, State:queueing, SchemaState:public, SchemaID:2, TableID:104, RowCount:0, ArgLen:0, start time: 2024-05-31 09:42:20.3 +0000 UTC, Err:<nil>, ErrCount:0, SnapshotVersion:0, LocalMode: false""]
[2024/05/31 09:42:20.333 +00:00] [ERROR] [domain.go:300] [""failed to load schema diff""] [error=""builder's (v2=true) infoschema mismatch, return error to trigger full reload""] [errorVerbose=""builder's (v2=true) infoschema mismatch, return error to trigger full reload\ngithub.com/pingcap/tidb/pkg/infoschema.(*Builder).InitWithOldInfoSchema\n\tpkg/infoschema/builder.go:799\ngithub.com/pingcap/tidb/pkg/domain.(*Domain).tryLoadSchemaDiffs\n\tpkg/domain/domain.go:477\ngithub.com/pingcap/tidb/pkg/domain.(*Domain).loadInfoSchema\n\tpkg/domain/domain.go:283\ngithub.com/pingcap/tidb/pkg/domain.(*Domain).Reload\n\tpkg/domain/domain.go:624\ngithub.com/pingcap/tidb/pkg/domain.(*Domain).loadSchemaInLoop\n\tpkg/domain/domain.go:937\ngithub.com/pingcap/tidb/pkg/domain.(*Domain).Init.func2\n\tpkg/domain/domain.go:1305\ngithub.com/pingcap/tidb/pkg/util.(*WaitGroupEnhancedWrapper).Run.func1\n\tpkg/util/wait_group_wrapper.go:99\nruntime.goexit\n\tsrc/runtime/asm_amd64.s:1650""] [stack=""github.com/pingcap/tidb/pkg/domain.(*Domain).loadInfoSchema\n\tpkg/domain/domain.go:300\ngithub.com/pingcap/tidb/pkg/domain.(*Domain).Reload\n\tpkg/domain/domain.go:624\ngithub.com/pingcap/tidb/pkg/domain.(*Domain).loadSchemaInLoop\n\tpkg/domain/domain.go:937\ngithub.com/pingcap/tidb/pkg/domain.(*Domain).Init.func2\n\tpkg/domain/domain.go:1305\ngithub.com/pingcap/tidb/pkg/util.(*WaitGroupEnhancedWrapper).Run.func1\n\tpkg/util/wait_group_wrapper.go:99""]
[2024/05/31 09:42:20.354 +00:00] [INFO] [set.go:170] [""set global var""] [conn=6] [name=tidb_schema_cache_size] [val=1073741824]
    result.go:160: 
                Error Trace:    pkg/testkit/result.go:160
                                                        pkg/ddl/tests/partition/db_partition_test.go:1459
                Error:          Not equal: 
                                expected: true
                                actual  : false
                Test:           TestTruncatePartitionWithGlobalIndex
                Messages:       the result doesn't contain the exepected IndexRangeScan
                                Point_Get 1.00 root table:test_global, index:idx_b(b)
[2024/05/31 09:42:20.356 +00:00] [INFO] [schema_version.go:376] [""wait latest schema version encounter error""] [category=ddl] [ver=65] [jobID=111] [""take time""=23.340558ms] [error=""context canceled""] [errorVerbose=""context canceled\ngithub.com/pingcap/errors.AddStack\n\texternal/com_github_pingcap_errors/errors.go:178\ngithub.com/pingcap/errors.Trace\n\texternal/com_github_pingcap_errors/juju_adaptor.go:15\ngithub.com/pingcap/tidb/pkg/ddl.(*MockSchemaSyncer).OwnerCheckAllVersions\n\tpkg/ddl/mock.go:132\ngithub.com/pingcap/tidb/pkg/ddl.checkAllVersions\n\tpkg/ddl/schema_version.go:374\ngithub.com/pingcap/tidb/pkg/ddl.waitSchemaChanged\n\tpkg/ddl/ddl_worker.go:1438\ngithub.com/pingcap/tidb/pkg/ddl.(*jobScheduler).delivery2Worker.func1\n\tpkg/ddl/job_table.go:577\ngithub.com/pingcap/tidb/pkg/util.(*WaitGroupWrapper).Run.func1\n\tpkg/util/wait_group_wrapper.go:157\nruntime.goexit\n\tsrc/runtime/asm_amd64.s:1650""]
[2024/05/31 09:42:20.356 +00:00] [INFO] [ddl.go:1230] [""DoDDLJob will quit because context done""] [category=ddl]
[2024/05/31 09:42:20.356 +00:00] [ERROR] [ddl.go:66] [""active txn failed""] [error=""[kv:8024]invalid transaction""] [errorVerbose=""[kv:8024]invalid transaction\ngithub.com/pingcap/errors.AddStack\n\texternal/com_github_pingcap_errors/errors.go:178\ngithub.com/pingcap/tidb/pkg/session.(*txnManager).ActivateTxn\n\tpkg/session/txnmanager.go:251\ngithub.com/pingcap/tidb/pkg/session.(*session).Txn\n\tpkg/session/session.go:2463\ngithub.com/pingcap/tidb/pkg/executor.(*DDLExec).toErr\n\tpkg/executor/ddl.go:64\ngithub.com/pingcap/tidb/pkg/executor.(*DDLExec).Next\n\tpkg/executor/ddl.go:224\ngithub.com/pingcap/tidb/pkg/executor/internal/exec.Next\n\tpkg/executor/internal/exec/executor.go:410\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).next\n\tpkg/executor/adapter.go:1211\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).handleNoDelayExecutor\n\tpkg/executor/adapter.go:960\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).handleNoDelay\n\tpkg/executor/adapter.go:794\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).Exec\n\tpkg/executor/adapter.go:559\ngithub.com/pingcap/tidb/pkg/session.runStmt\n\tpkg/session/session.go:2285\ngithub.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt\n\tpkg/session/session.go:2146\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecWithContext\n\tpkg/testkit/testkit.go:383\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).MustExecWithContext\n\tpkg/testkit/testkit.go:155\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).MustExec\n\tpkg/testkit/testkit.go:150\npkg/ddl/tests/partition/partition_test.TestTruncatePartitionWithGlobalIndex.func2\n\tpkg/ddl/tests/partition/db_partition_test.go:1441\nruntime.goexit\n\tsrc/runtime/asm_amd64.s:1650""] [stack=""github.com/pingcap/tidb/pkg/executor.(*DDLExec).toErr\n\tpkg/executor/ddl.go:66\ngithub.com/pingcap/tidb/pkg/executor.(*DDLExec).Next\n\tpkg/executor/ddl.go:224\ngithub.com/pingcap/tidb/pkg/executor/internal/exec.Next\n\tpkg/executor/internal/exec/executor.go:410\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).next\n\tpkg/executor/adapter.go:1211\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).handleNoDelayExecutor\n\tpkg/executor/adapter.go:960\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).handleNoDelay\n\tpkg/executor/adapter.go:794\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).Exec\n\tpkg/executor/adapter.go:559\ngithub.com/pingcap/tidb/pkg/session.runStmt\n\tpkg/session/session.go:2285\ngithub.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt\n\tpkg/session/session.go:2146\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecWithContext\n\tpkg/testkit/testkit.go:383\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).MustExecWithContext\n\tpkg/testkit/testkit.go:155\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).MustExec\n\tpkg/testkit/testkit.go:150\npkg/ddl/tests/partition/partition_test.TestTruncatePartitionWithGlobalIndex.func2\n\tpkg/ddl/tests/partition/db_partition_test.go:1441""]
[2024/05/31 09:42:20.356 +00:00] [INFO] [tidb.go:269] [""rollbackTxn called due to ddl/autocommit failure""]
[2024/05/31 09:42:20.356 +00:00] [WARN] [session.go:2158] [""run statement failed""] [schemaVersion=64] [error=""context canceled""] [errorVerbose=""context canceled\ngithub.com/pingcap/errors.AddStack\n\texternal/com_github_pingcap_errors/errors.go:178\ngithub.com/pingcap/errors.Trace\n\texternal/com_github_pingcap_errors/juju_adaptor.go:15\ngithub.com/pingcap/tidb/pkg/ddl.(*ddl).callHookOnChanged\n\tpkg/ddl/ddl.go:1319\ngithub.com/pingcap/tidb/pkg/ddl.(*ddl).TruncateTablePartition\n\tpkg/ddl/ddl_api.go:5063\ngithub.com/pingcap/tidb/pkg/ddl.(*ddl).AlterTable\n\tpkg/ddl/ddl_api.go:3935\ngithub.com/pingcap/tidb/pkg/executor.(*DDLExec).executeAlterTable\n\tpkg/executor/ddl.go:388\ngithub.com/pingcap/tidb/pkg/executor.(*DDLExec).Next\n\tpkg/executor/ddl.go:152\ngithub.com/pingcap/tidb/pkg/executor/internal/exec.Next\n\tpkg/executor/internal/exec/executor.go:410\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).next\n\tpkg/executor/adapter.go:1211\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).handleNoDelayExecutor\n\tpkg/executor/adapter.go:960\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).handleNoDelay\n\tpkg/executor/adapter.go:794\ngithub.com/pingcap/tidb/pkg/executor.(*ExecStmt).Exec\n\tpkg/executor/adapter.go:559\ngithub.com/pingcap/tidb/pkg/session.runStmt\n\tpkg/session/session.go:2285\ngithub.com/pingcap/tidb/pkg/session.(*session).ExecuteStmt\n\tpkg/session/session.go:2146\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).ExecWithContext\n\tpkg/testkit/testkit.go:383\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).MustExecWithContext\n\tpkg/testkit/testkit.go:155\ngithub.com/pingcap/tidb/pkg/testkit.(*TestKit).MustExec\n\tpkg/testkit/testkit.go:150\npkg/ddl/tests/partition/partition_test.TestTruncatePartitionWithGlobalIndex.func2\n\tpkg/ddl/tests/partition/db_partition_test.go:1441\nruntime.goexit\n\tsrc/runtime/asm_amd64.s:1650""] [session=""{\n  \""currDBName\"": \""test\"",\n  \""id\"": 1,\n  \""status\"": 2,\n  \""strictMode\"": true,\n  \""user\"": null\n}""]
[2024/05/31 09:42:20.361 +00:00] [INFO] [mock.go:100] [""owner manager retire owner""] [category=ddl] [ID=01b812bb-c322-4671-9d18-5238dcf79a76] [ownerKey=/tidb/ddl/fg/owner]
[2024/05/31 09:42:20.362 +00:00] [INFO] [ddl_workerpool.go:82] [""closing workerPool""] [category=ddl]
[2024/05/31 09:42:20.362 +00:00] [INFO] [ddl_worker.go:188] [""DDL worker closed""] [worker=""worker 8, tp add index""] [category=ddl] [""take time""=2.187µs]
[2024/05/31 09:42:20.362 +00:00] [INFO] [ddl_worker.go:188] [""DDL worker closed""] [worker=""worker 7, tp add index""] [category=ddl] [""take time""=1.892µs]
[2024/05/31 09:42:20.362 +00:00] [INFO] [ddl_worker.go:188] [""DDL worker closed""] [worker=""worker 10, tp add index""] [category=ddl] [""take time""=1.347µs]
[2024/05/31 09:42:20.362 +00:00] [INFO] [ddl_worker.go:188] [""DDL worker closed""] [worker=""worker 9, tp add index""] [category=ddl] [""take time""=1.511µs]
[2024/05/31 09:42:20.362 +00:00] [INFO] [ddl_workerpool.go:82] [""closing workerPool""] [category=ddl]
[2024/05/31 09:42:20.362 +00:00] [INFO] [ddl_worker.go:188] [""DDL worker closed""] [worker=""worker 6, tp general""] [category=ddl] [""take time""=1.567µs]
[2024/05/31 09:42:20.362 +00:00] [INFO] [mock.go:111] [""owner manager is canceled""] [category=ddl] [ID=01b812bb-c322-4671-9d18-5238dcf79a76] [ownerKey=/tidb/ddl/fg/owner]
[2024/05/31 09:42:20.362 +00:00] [INFO] [ddl_workerpool.go:82] [""closing workerPool""] [category=ddl]
[2024/05/31 09:42:20.362 +00:00] [INFO] [delete_range.go:162] [""closing delRange""] [category=ddl]
[2024/05/31 09:42:20.367 +00:00] [INFO] [domain.go:324] [""full load InfoSchema success""] [currentSchemaVersion=64] [neededSchemaVersion=65] [""start time""=34.254434ms]
    testkit.go:157: 
                Error Trace:    pkg/testkit/testkit.go:157
                                                        pkg/testkit/testkit.go:150
                                                        pkg/ddl/tests/partition/db_partition_test.go:1441
                                                        src/runtime/asm_amd64.s:1650
                Error:          Received unexpected error:
                                context canceled
                                github.com/pingcap/errors.AddStack
                                        external/com_github_pingcap_errors/errors.go:178
                                github.com/pingcap/errors.Trace
                                        external/com_github_pingcap_errors/juju_adaptor.go:15
                                github.com/pingcap/tidb/pkg/ddl.(*ddl).callHookOnChanged
                                        pkg/ddl/ddl.go:1319
                                github.com/pingcap/tidb/pkg/ddl.(*ddl).TruncateTablePartition
                                        pkg/ddl/ddl_api.go:5063
                                github.com/pingcap/tidb/pkg/ddl.(*ddl).AlterTable
                                        pkg/ddl/ddl_api.go:3935
```

### 4. What is your TiDB version? (Required)

<!-- Paste the output of SELECT tidb_version() -->
current master:
```
tidb_version(): Release Version: v8.2.0-alpha-277-g90e1049b67
Edition: Community
Git Commit Hash: 90e1049b6768120b66b02cae68f0fab0d36320cd
Git Branch: master
UTC Build Time: 2024-05-31 11:07:48
GoVersion: go1.21.1
Race Enabled: false
Check Table Before Drop: false
Store: unistore
```",https://github.com/pingcap/tidb/issues/53725,pingcap/tidb,2024-05-31 11:11:11+00:00,2024-07-04 13:11:59+00:00,2024-07-04 13:11:59+00:00,closed,"['type/bug', 'component/test', 'sig/sql-infra', 'severity/major', 'feature/developing']",Performance Degradation
br restore failed with error “region 714153's leader's store id is 0” when pd rolling restart,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
1、br restore
2、pd rolling restart

### 2. What did you expect to see? (Required)
br restore success

### 3. What did you see instead (Required)
br restore failed
`error=""region 714153's leader's store id is 0: [BR:PD:ErrPDBatchScanRegion]batch scan region; region 714153's leader's store id is 0: [BR:PD:ErrPDBatchScanRegion]batch scan region; region 714153's leader's store id is 0: [BR:PD:ErrPDBatchScanRegion]batch scan region; region 714153's leader's store id is 0: [BR:PD:ErrPDBatchScanRegion]batch scan region""] [errorVerbose=""the following errors occurred:\n -  [BR:PD:ErrPDBatchScanRegion]batch scan region\n    region 714153's leader's store id is 0\n    github.com/pingcap/tidb/br/pkg/restore/split.CheckRegionConsistency\n    \t/workspace/source/tidb/br/pkg/restore/split/split.go:76\n    github.com/pingcap/tidb/br/pkg/restore/split.PaginateScanRegion.func1\n    \t/workspace/source/tidb/br/pkg/restore/split/split.go:147\n    github.com/pingcap/tidb/br/pkg/utils.WithRetry.func1\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:217\n    github.com/pingcap/tidb/br/pkg/utils.WithRetryV2[...]\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:235\n    github.com/pingcap/tidb/br/pkg/utils.WithRetry\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:216\n    github.com/pingcap/tidb/br/pkg/restore/split.PaginateScanRegion\n    \t/workspace/source/tidb/br/pkg/restore/split/split.go:117\n    github.com/pingcap/tidb/br/pkg/restore.(*FileImporter).ImportSSTFiles.func1\n    \t/workspace/source/tidb/br/pkg/restore/import.go:548\n    github.com/pingcap/tidb/br/pkg/utils.WithRetry.func1\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:217\n    github.com/pingcap/tidb/br/pkg/utils.WithRetryV2[...]\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:235\n    github.com/pingcap/tidb/br/pkg/utils.WithRetry\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:216\n    github.com/pingcap/tidb/br/pkg/restore.(*FileImporter).ImportSSTFiles\n    \t/workspace/source/tidb/br/pkg/restore/import.go:544\n    github.com/pingcap/tidb/br/pkg/restore.(*Client).RestoreSSTFiles.func2.1\n    \t/workspace/source/tidb/br/pkg/restore/client.go:1458\n    github.com/pingcap/tidb/br/pkg/restore.(*Client).RestoreSSTFiles.func2\n    \t/workspace/source/tidb/br/pkg/restore/client.go:1459\n    github.com/pingcap/tidb/br/pkg/utils.(*WorkerPool).ApplyOnErrorGroup.func1\n    \t/workspace/source/tidb/br/pkg/utils/worker.go:76\n    golang.org/x/sync/errgroup.(*Group).Go.func1\n    \t/root/go/pkg/mod/golang.org/x/sync@v0.3.0/errgroup/errgroup.go:75\n    runtime.goexit\n    \t/usr/local/go/src/runtime/asm_amd64.s:1650\n -  [BR:PD:ErrPDBatchScanRegion]batch scan region\n    region 714153's leader's store id is 0\n    github.com/pingcap/tidb/br/pkg/restore/split.CheckRegionConsistency\n    \t/workspace/source/tidb/br/pkg/restore/split/split.go:76\n    github.com/pingcap/tidb/br/pkg/restore/split.PaginateScanRegion.func1\n    \t/workspace/source/tidb/br/pkg/restore/split/split.go:147\n    github.com/pingcap/tidb/br/pkg/utils.WithRetry.func1\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:217\n    github.com/pingcap/tidb/br/pkg/utils.WithRetryV2[...]\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:235\n    github.com/pingcap/tidb/br/pkg/utils.WithRetry\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:216\n    github.com/pingcap/tidb/br/pkg/restore/split.PaginateScanRegion\n    \t/workspace/source/tidb/br/pkg/restore/split/split.go:117\n    github.com/pingcap/tidb/br/pkg/restore.(*FileImporter).ImportSSTFiles.func1\n    \t/workspace/source/tidb/br/pkg/restore/import.go:548\n    github.com/pingcap/tidb/br/pkg/utils.WithRetry.func1\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:217\n    github.com/pingcap/tidb/br/pkg/utils.WithRetryV2[...]\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:235\n    github.com/pingcap/tidb/br/pkg/utils.WithRetry\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:216\n    github.com/pingcap/tidb/br/pkg/restore.(*FileImporter).ImportSSTFiles\n    \t/workspace/source/tidb/br/pkg/restore/import.go:544\n    github.com/pingcap/tidb/br/pkg/restore.(*Client).RestoreSSTFiles.func2.1\n    \t/workspace/source/tidb/br/pkg/restore/client.go:1458\n    github.com/pingcap/tidb/br/pkg/restore.(*Client).RestoreSSTFiles.func2\n    \t/workspace/source/tidb/br/pkg/restore/client.go:1459\n    github.com/pingcap/tidb/br/pkg/utils.(*WorkerPool).ApplyOnErrorGroup.func1\n    \t/workspace/source/tidb/br/pkg/utils/worker.go:76\n    golang.org/x/sync/errgroup.(*Group).Go.func1\n    \t/root/go/pkg/mod/golang.org/x/sync@v0.3.0/errgroup/errgroup.go:75\n    runtime.goexit\n    \t/usr/local/go/src/runtime/asm_amd64.s:1650\n -  [BR:PD:ErrPDBatchScanRegion]batch scan region\n    region 714153's leader's store id is 0\n    github.com/pingcap/tidb/br/pkg/restore/split.CheckRegionConsistency\n    \t/workspace/source/tidb/br/pkg/restore/split/split.go:76\n    github.com/pingcap/tidb/br/pkg/restore/split.PaginateScanRegion.func1\n    \t/workspace/source/tidb/br/pkg/restore/split/split.go:147\n    github.com/pingcap/tidb/br/pkg/utils.WithRetry.func1\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:217\n    github.com/pingcap/tidb/br/pkg/utils.WithRetryV2[...]\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:235\n    github.com/pingcap/tidb/br/pkg/utils.WithRetry\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:216\n    github.com/pingcap/tidb/br/pkg/restore/split.PaginateScanRegion\n    \t/workspace/source/tidb/br/pkg/restore/split/split.go:117\n    github.com/pingcap/tidb/br/pkg/restore.(*FileImporter).ImportSSTFiles.func1\n    \t/workspace/source/tidb/br/pkg/restore/import.go:548\n    github.com/pingcap/tidb/br/pkg/utils.WithRetry.func1\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:217\n    github.com/pingcap/tidb/br/pkg/utils.WithRetryV2[...]\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:235\n    github.com/pingcap/tidb/br/pkg/utils.WithRetry\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:216\n    github.com/pingcap/tidb/br/pkg/restore.(*FileImporter).ImportSSTFiles\n    \t/workspace/source/tidb/br/pkg/restore/import.go:544\n    github.com/pingcap/tidb/br/pkg/restore.(*Client).RestoreSSTFiles.func2.1\n    \t/workspace/source/tidb/br/pkg/restore/client.go:1458\n    github.com/pingcap/tidb/br/pkg/restore.(*Client).RestoreSSTFiles.func2\n    \t/workspace/source/tidb/br/pkg/restore/client.go:1459\n    github.com/pingcap/tidb/br/pkg/utils.(*WorkerPool).ApplyOnErrorGroup.func1\n    \t/workspace/source/tidb/br/pkg/utils/worker.go:76\n    golang.org/x/sync/errgroup.(*Group).Go.func1\n    \t/root/go/pkg/mod/golang.org/x/sync@v0.3.0/errgroup/errgroup.go:75\n    runtime.goexit\n    \t/usr/local/go/src/runtime/asm_amd64.s:1650\n -  [BR:PD:ErrPDBatchScanRegion]batch scan region\n    region 714153's leader's store id is 0\n    github.com/pingcap/tidb/br/pkg/restore/split.CheckRegionConsistency\n    \t/workspace/source/tidb/br/pkg/restore/split/split.go:76\n    github.com/pingcap/tidb/br/pkg/restore/split.PaginateScanRegion.func1\n    \t/workspace/source/tidb/br/pkg/restore/split/split.go:147\n    github.com/pingcap/tidb/br/pkg/utils.WithRetry.func1\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:217\n    github.com/pingcap/tidb/br/pkg/utils.WithRetryV2[...]\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:235\n    github.com/pingcap/tidb/br/pkg/utils.WithRetry\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:216\n    github.com/pingcap/tidb/br/pkg/restore/split.PaginateScanRegion\n    \t/workspace/source/tidb/br/pkg/restore/split/split.go:117\n    github.com/pingcap/tidb/br/pkg/restore.(*FileImporter).ImportSSTFiles.func1\n    \t/workspace/source/tidb/br/pkg/restore/import.go:548\n    github.com/pingcap/tidb/br/pkg/utils.WithRetry.func1\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:217\n    github.com/pingcap/tidb/br/pkg/utils.WithRetryV2[...]\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:235\n    github.com/pingcap/tidb/br/pkg/utils.WithRetry\n    \t/workspace/source/tidb/br/pkg/utils/retry.go:216\n    github.com/pingcap/tidb/br/pkg/restore.(*FileImporter).ImportSSTFiles\n    \t/workspace/source/tidb/br/pkg/restore/import.go:544\n    github.com/pingcap/tidb/br/pkg/restore.(*Client).RestoreSSTFiles.func2.1\n    \t/workspace/source/tidb/br/pkg/restore/client.go:1458\n    github.com/pingcap/tidb/br/pkg/restore.(*Client).RestoreSSTFiles.func2\n    \t/workspace/source/tidb/br/pkg/restore/client.go:1459\n    github.com/pingcap/tidb/br/pkg/utils.(*WorkerPool).ApplyOnErrorGroup.func1\n    \t/workspace/source/tidb/br/pkg/utils/worker.go:76\n    golang.org/x/sync/errgroup.(*Group).Go.func1\n    \t/root/go/pkg/mod/golang.org/x/sync@v0.3.0/errgroup/errgroup.go:75\n    runtime.goexit\n    \t/usr/local/go/src/runtime/asm_amd64.s:1650""]
Error: region 714153's leader's store id is 0: [BR:PD:ErrPDBatchScanRegion]batch scan region; region 714153's leader's store id is 0: [BR:PD:ErrPDBatchScanRegion]batch scan region; region 714153's leader's store id is 0: [BR:PD:ErrPDBatchScanRegion]batch scan region; region 714153's leader's store id is 0: [BR:PD:ErrPDBatchScanRegion]batch scan region`

### 4. What is your TiDB version? (Required)
tidb version:
./tidb-server -V
Release Version: v7.5.2
Edition: Community
Git Commit Hash: https://github.com/pingcap/tidb/commit/39ea2b30d32ab8cf486f30ca318cf2e4bd99eaef
Git Branch: HEAD
UTC Build Time: 2024-05-29 15:07:12
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: unistore
2024-05-30T14:14:32.686+0800",https://github.com/pingcap/tidb/issues/53724,pingcap/tidb,2024-05-31 10:51:30+00:00,2024-07-08 07:41:31+00:00,2024-07-08 07:41:31+00:00,closed,"['type/bug', 'severity/major', 'component/br', 'affects-6.5', 'affects-7.1', 'affects-7.5']",Data Corruption
br panic when inject pd io delay during br restore,"## Bug Report

Please answer these questions before submitting your issue. Thanks!

### 1. Minimal reproduce step (Required)
1、br restore
2、inject pd io delay 1s

### 2. What did you expect to see? (Required)
br restore success

### 3. What did you see instead (Required)
br failed with panic
`panic: runtime error: invalid memory address or nil pointer dereference
[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x280a3e5]
goroutine 9160 [running]:
github.com/tikv/pd/client.(*client).ScanRegions(0xc00082a000, {0x68a7ea8, 0xc00feaed20}, {0xc00fcb1f60, 0x1b, 0x1b}, {0xc00fcb1f80, 0x1b, 0x1b}, 0x80)
	/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20240528122050-634e05a87ee0/client.go:1086 +0x625
github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).ScanRegions(0x100000001?, {0x68a7ea8?, 0xc00feaed20?}, {0xc00fcb1f60?, 0x0?, 0x1a3185c5000?}, {0xc00fcb1f80?, 0x0?, 0x0?}, 0x80)
	/workspace/source/tidb/br/pkg/restore/split/client.go:523 +0x57
github.com/pingcap/tidb/br/pkg/restore/split.PaginateScanRegion.func1()
	/workspace/source/tidb/br/pkg/restore/split/split.go:122 +0x186
github.com/pingcap/tidb/br/pkg/utils.WithRetry.func1({0x0?, 0x0?})
	/workspace/source/tidb/br/pkg/utils/retry.go:217 +0x13
github.com/pingcap/tidb/br/pkg/utils.WithRetryV2[...]({0x68a7ea8?, 0xc00feaed20}, {0x6884188, 0xc00fcb1fa0}, 0xc00213aba0)
	/workspace/source/tidb/br/pkg/utils/retry.go:235 +0x98
github.com/pingcap/tidb/br/pkg/utils.WithRetry({0x68a7ea8?, 0xc00feaed20?}, 0x0?, {0x6884188?, 0xc00fcb1fa0?})
	/workspace/source/tidb/br/pkg/utils/retry.go:216 +0x50
github.com/pingcap/tidb/br/pkg/restore/split.PaginateScanRegion({0x68a7ea8?, 0xc00feaed20?}, {0x68cfe00?, 0xc002131100}, {0xc00fcb1f60, 0x1b, 0x1b}, {0xc00fcb1f80, 0x1b, 0x1b}, ...)
	/workspace/source/tidb/br/pkg/restore/split/split.go:117 +0x2ab
github.com/pingcap/tidb/br/pkg/restore.(*FileImporter).ImportSSTFiles.func1()
	/workspace/source/tidb/br/pkg/restore/import.go:548 +0x179
github.com/pingcap/tidb/br/pkg/utils.WithRetry.func1({0x57034a0?, 0xc00fead1d0?})
	/workspace/source/tidb/br/pkg/utils/retry.go:217 +0x13
github.com/pingcap/tidb/br/pkg/utils.WithRetryV2[...]({0x68a7e38?, 0xc00a08e0a0}, {0x687da68, 0xc00fce5b40}, 0xc00213ba38)
	/workspace/source/tidb/br/pkg/utils/retry.go:235 +0x98
github.com/pingcap/tidb/br/pkg/utils.WithRetry({0x68a7e38?, 0xc00a08e0a0?}, 0x1?, {0x687da68?, 0xc00fce5b40?})
	/workspace/source/tidb/br/pkg/utils/retry.go:216 +0x50
github.com/pingcap/tidb/br/pkg/restore.(*FileImporter).ImportSSTFiles(0xc001f44020, {0x68a7e38?, 0xc00a08e0a0}, {0xc008fcf9e0?, 0x1, 0xc4}, 0xc004b56910, 0xc000ea4bb0, 0x0)
	/workspace/source/tidb/br/pkg/restore/import.go:544 +0x445
github.com/pingcap/tidb/br/pkg/restore.(*Client).RestoreSSTFiles.func2.1(0xc009aecef0, {0x68a7cb0?, 0xc004e44fc0}, 0xc001f44000, {0x68a7e38, 0xc00a08e0a0}, 0x0?, {0xc008fcf9e0, 0x1, 0xc4})
	/workspace/source/tidb/br/pkg/restore/client.go:1458 +0x17c
github.com/pingcap/tidb/br/pkg/restore.(*Client).RestoreSSTFiles.func2()
	/workspace/source/tidb/br/pkg/restore/client.go:1459 +0x1bd
github.com/pingcap/tidb/br/pkg/utils.(*WorkerPool).ApplyOnErrorGroup.func1()
	/workspace/source/tidb/br/pkg/utils/worker.go:76 +0x6c
golang.org/x/sync/errgroup.(*Group).Go.func1()
	/root/go/pkg/mod/golang.org/x/sync@v0.3.0/errgroup/errgroup.go:75 +0x56
created by golang.org/x/sync/errgroup.(*Group).Go in goroutine 2632
	/root/go/pkg/mod/golang.org/x/sync@v0.3.0/errgroup/errgroup.go:72 +0x96
panic: runtime error: invalid memory address or nil pointer dereference
[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x280a3e5]
goroutine 9323 [running]:
github.com/tikv/pd/client.(*client).ScanRegions(0xc00082a000, {0x68a7ea8, 0xc00f38aa10}, {0xc00f3f42a0, 0x1b, 0x1b}, {0xc00f3f42c0, 0x1b, 0x1b}, 0x80)
	/root/go/pkg/mod/github.com/tikv/pd/client@v0.0.0-20240528122050-634e05a87ee0/client.go:1086 +0x625
github.com/pingcap/tidb/br/pkg/restore/split.(*pdClient).ScanRegions(0x0?, {0x68a7ea8?, 0xc00f38aa10?}, {0xc00f3f42a0?, 0x0?, 0x0?}, {0xc00f3f42c0?, 0x0?, 0x0?}, 0x80)
	/workspace/source/tidb/br/pkg/restore/split/client.go:523 +0x57
github.com/pingcap/tidb/br/pkg/restore/split.PaginateScanRegion.func1()
	/workspace/source/tidb/br/pkg/restore/split/split.go:122 +0x186
github.com/pingcap/tidb/br/pkg/utils.WithRetry.func1({0x0?, 0x0?})
	/workspace/source/tidb/br/pkg/utils/retry.go:217 +0x13
github.com/pingcap/tidb/br/pkg/utils.WithRetryV2[...]({0x68a7ea8?, 0xc00f38aa10}, {0x6884188, 0xc00f3f42e0}, 0xc006524ba0)
	/workspace/source/tidb/br/pkg/utils/retry.go:235 +0x98
github.com/pingcap/tidb/br/pkg/utils.WithRetry({0x68a7ea8?, 0xc00f38aa10?}, 0x0?, {0x6884188?, 0xc00f3f42e0?})
	/workspace/source/tidb/br/pkg/utils/retry.go:216 +0x50
github.com/pingcap/tidb/br/pkg/restore/split.PaginateScanRegion({0x68a7ea8?, 0xc00f38aa10?}, {0x68cfe00?, 0xc002131100}, {0xc00f3f42a0, 0x1b, 0x1b}, {0xc00f3f42c0, 0x1b, 0x1b}, ...)
	/workspace/source/tidb/br/pkg/restore/split/split.go:117 +0x2ab
github.com/pingcap/tidb/br/pkg/restore.(*FileImporter).ImportSSTFiles.func1()
	/workspace/source/tidb/br/pkg/restore/import.go:548 +0x179
github.com/pingcap/tidb/br/pkg/utils.WithRetry.func1({0x1e2554f?, 0x7f629c662e60?})
	/workspace/source/tidb/br/pkg/utils/retry.go:217 +0x13
github.com/pingcap/tidb/br/pkg/utils.WithRetryV2[...]({0x68a7e38?, 0xc009f7a0f0}, {0x687da68, 0xc00f3ecfe0}, 0xc006525a38)
	/workspace/source/tidb/br/pkg/utils/retry.go:235 +0x98
github.com/pingcap/tidb/br/pkg/utils.WithRetry({0x68a7e38?, 0xc009f7a0f0?}, 0x1?, {0x687da68?, 0xc00f3ecfe0?})
	/workspace/source/tidb/br/pkg/utils/retry.go:216 +0x50
github.com/pingcap/tidb/br/pkg/restore.(*FileImporter).ImportSSTFiles(0xc001f44020, {0x68a7e38?, 0xc009f7a0f0}, {0xc006f970d0?, 0x1, 0xe6}, 0xc004b56c30, 0xc000ea4bb0, 0x0)
	/workspace/source/tidb/br/pkg/restore/import.go:544 +0x445
github.com/pingcap/tidb/br/pkg/restore.(*Client).RestoreSSTFiles.func2.1(0xc00f8beef0, {0x68a7cb0?, 0xc004e44fc0}, 0xc001f44000, {0x68a7e38, 0xc009f7a0f0}, 0x0?, {0xc006f970d0, 0x1, 0xe6})
	/workspace/source/tidb/br/pkg/restore/client.go:1458 +0x17c
github.com/pingcap/tidb/br/pkg/restore.(*Client).RestoreSSTFiles.func2()
	/workspace/source/tidb/br/pkg/restore/client.go:1459 +0x1bd
github.com/pingcap/tidb/br/pkg/utils.(*WorkerPool).ApplyOnErrorGroup.func1()
	/workspace/source/tidb/br/pkg/utils/worker.go:76 +0x6c
golang.org/x/sync/errgroup.(*Group).Go.func1()
	/root/go/pkg/mod/golang.org/x/sync@v0.3.0/errgroup/errgroup.go:75 +0x56
created by golang.org/x/sync/errgroup.(*Group).Go in goroutine 5700
	/root/go/pkg/mod/golang.org/x/sync@v0.3.0/errgroup/errgroup.go:72 +0x96`

### 4. What is your TiDB version? (Required)
tidb version:
./tidb-server -V
Release Version: v7.5.2
Edition: Community
Git Commit Hash: https://github.com/pingcap/tidb/commit/39ea2b30d32ab8cf486f30ca318cf2e4bd99eaef
Git Branch: HEAD
UTC Build Time: 2024-05-29 15:07:12
GoVersion: go1.21.10
Race Enabled: false
Check Table Before Drop: false
Store: unistore
2024-05-30T14:14:32.686+0800",https://github.com/pingcap/tidb/issues/53723,pingcap/tidb,2024-05-31 10:45:47+00:00,2024-07-29 09:32:13+00:00,2024-07-29 09:28:24+00:00,closed,"['type/bug', 'severity/major', 'component/br', 'affects-6.5', 'affects-7.1', 'affects-7.5', 'impact/panic']",Crash / Segmentation Fault
